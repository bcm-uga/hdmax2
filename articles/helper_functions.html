<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="hdmax2">
<title>hdmax2 helper functions • hdmax2</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="hdmax2 helper functions">
<meta property="og:description" content="hdmax2">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">hdmax2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/hdmax2_multivariate.html">hdmax2 application for multivariate exposome</a>
    <a class="dropdown-item" href="../articles/hdmax2_univariate.html">hdmax2 application for univariate exposome</a>
    <a class="dropdown-item" href="../articles/helper_functions.html">hdmax2 helper functions</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>hdmax2 helper functions</h1>
                        <h4 data-toc-skip class="author">Florence
Pittion, Magali Richard, Olivier Francois</h4>
            
            <h4 data-toc-skip class="date">January, 2024</h4>
      
      
      <div class="d-none name"><code>helper_functions.Rmd</code></div>
    </div>

    
    
<hr>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>hdmax2</code> package is designed to accept exposure <span class="math inline">\(X\)</span> consisting of univariate data, which
can be continuous, binary, or categorical, as well as multivariate
exposomes. Binary variables are converted to 0s and 1s and treated as
univariate variables.</p>
<p>In this vignette, we provide a series of helper function to process
the data.</p>
<p>To install the latest version of <code>hdmax2</code>, use the github
repository</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#devtools::install_github("bcm-uga/hdmax2")</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="how-to-analyse-agregated-methylated-regions">How to analyse agregated methylated regions ?<a class="anchor" aria-label="anchor" href="#how-to-analyse-agregated-methylated-regions"></a>
</h2>
<p>We simulated 500 samples and 1000 potential DNA methylation
mediators, with various a binary exposure (smoking status of mothers)
and continuous outcomes (birth weight).</p>
<div class="section level3">
<h3 id="identifying-aggregated-mediator-regions-amr">Identifying aggregated mediator regions (AMR)<a class="anchor" aria-label="anchor" href="#identifying-aggregated-mediator-regions-amr"></a>
</h3>
<p>Identify Aggregated Methylated regions (AMR) with AMR_search function
which uses from the P-values from <em>max-squared</em> test compute in
<code>run_AS</code> function and using a adapted comb-p method (comb-p
is a tool that manipulates BED files of possibly irregularly spaced
P-values and calculates auto-correlation, combines adjacent P-values,
performs false discovery adjustment, finds regions of enrichment and
assigns significance to those regions). AMR identification could be
useful in Epigenomic Wide Association Studies when single CpG mediation
is unsuccessful, or could be complementary analysis.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">=</span> <span class="fu">hdmax2</span><span class="fu">::</span><span class="va"><a href="../reference/helper_ex.html">helper_ex</a></span></span>
<span></span>
<span><span class="co">#Artificial reduction of dataset size to pass the github action check when building hdmax2 website</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">methylation</span> <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">methylation</span><span class="op">[</span> , <span class="fl">800</span><span class="op">:</span><span class="fl">1000</span><span class="op">]</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">annotation</span> <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">[</span><span class="fl">800</span><span class="op">:</span><span class="fl">1000</span>, <span class="op">]</span></span>
<span></span>
<span></span>
<span><span class="va">pc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">methylation</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">(</span><span class="va">pc</span><span class="op">$</span><span class="va">sdev</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pc</span><span class="op">$</span><span class="va">sdev</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">'Principal Component'</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Explained variance"</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">16</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="helper_functions_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># choosen number of dimension</span></span>
<span><span class="va">K</span><span class="op">=</span><span class="fl">5</span></span>
<span></span>
<span><span class="co">## run hdmax2 step1</span></span>
<span><span class="va">hdmax2_step1</span> <span class="op">=</span> <span class="fu">hdmax2</span><span class="fu">::</span><span class="fu"><a href="../reference/run_AS.html">run_AS</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">exposure</span>,</span>
<span>                              Y <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">phenotype</span>,</span>
<span>                              M <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">methylation</span>, </span>
<span>                              K <span class="op">=</span> <span class="va">K</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "The exposure argument is a vector."</span></span>
<span><span class="co">#&gt; [1] "The outcome argument is a vector."</span></span>
<span><span class="co">#&gt; [1] "The outcome argument is numeric"</span></span>
<span><span class="co">#&gt; [1] "Potential mediators matrix is actually a matrix"</span></span>
<span><span class="co">#&gt; [1] "provided K = 5"</span></span>
<span><span class="co">#&gt; [1] "K value has been transformed as integer"</span></span>
<span><span class="co">#&gt; [1] "The input exposome is continuous or binary"</span></span>
<span><span class="co">#&gt; [1] "The outcome vector is numeric and DON'T contains only 0s and 1s, it is assimilated as continous variable."</span></span>
<span><span class="co">#&gt; [1] "Running first regression with univariate explanatory variable."</span></span>
<span><span class="co">#&gt; [1] "Running second regression."</span></span>
<span><span class="co">#&gt; [1] "Running max-squared test."</span></span>
<span><span class="co">#&gt; [1] "Not generating max2 pvalues for each explanatory variable."</span></span>
<span></span>
<span><span class="co">##Detecting AMR</span></span>
<span><span class="va">chr</span> <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="va">chr</span></span>
<span><span class="va">start</span> <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="va">start</span></span>
<span><span class="va">end</span> <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="va">end</span></span>
<span><span class="va">pval</span> <span class="op">=</span> <span class="va">hdmax2_step1</span><span class="op">$</span><span class="va">max2_pvalues</span></span>
<span><span class="va">cpg</span> <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="va">cpg</span></span>
<span><span class="va">seed</span> <span class="op">=</span> <span class="fl">0.6</span> <span class="co">#Careful to change this parameter when working with real data</span></span>
<span><span class="va">res.amr_search</span> <span class="op">=</span> <span class="fu">hdmax2</span><span class="fu">::</span><span class="fu"><a href="../reference/AMR_search.html">AMR_search</a></span><span class="op">(</span>chr <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="va">chr</span>,</span>
<span>                                    start <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="va">start</span>,</span>
<span>                                    end <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="va">end</span>,</span>
<span>                                    pval <span class="op">=</span> <span class="va">hdmax2_step1</span><span class="op">$</span><span class="va">max2_pvalues</span>,</span>
<span>                                    cpg <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="va">cpg</span>,</span>
<span>                                    seed <span class="op">=</span> <span class="va">seed</span>, </span>
<span>                                    nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res.amr_search</span><span class="op">$</span><span class="va">res</span></span>
<span><span class="co">#&gt;   chr   start     end           p        fdr</span></span>
<span><span class="co">#&gt; 2   1 1326166 1326221 0.005626678 0.01688003</span></span>
<span><span class="co">#&gt; 1   1 1310734 1310988 0.019799860 0.02138751</span></span>
<span><span class="co">#&gt; 3   1 1406862 1407016 0.021387509 0.02138751</span></span>
<span></span>
<span><span class="va">res.arm_build</span> <span class="op">=</span> <span class="fu">hdmax2</span><span class="fu">::</span><span class="fu"><a href="../reference/AMR_build.html">AMR_build</a></span><span class="op">(</span><span class="va">res.amr_search</span>, </span>
<span>                                  methylation <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">methylation</span>, </span>
<span>                                  nb_cpg <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#List of DMR selected</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res.arm_build</span><span class="op">$</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="co">#&gt;    DMR chr   start     end          p        fdr nb</span></span>
<span><span class="co">#&gt; 1 DMR1   1 1310734 1310988 0.01979986 0.02138751  2</span></span>
<span><span class="co">#&gt; 2 DMR2   1 1406862 1407016 0.02138751 0.02138751  2</span></span>
<span></span>
<span><span class="co">##CpG in the DMR</span></span>
<span><span class="va">res.arm_build</span><span class="op">$</span><span class="va">CpG_for_each_AMR</span></span>
<span><span class="co">#&gt; $DMR1</span></span>
<span><span class="co">#&gt; [1] "cg11518257" "cg15617543"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $DMR2</span></span>
<span><span class="co">#&gt; [1] "cg10228629" "cg06377929"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="quantifying-indirect-effects">Quantifying indirect effects<a class="anchor" aria-label="anchor" href="#quantifying-indirect-effects"></a>
</h3>
<p>Like with single mediators analysis <em>esimate_effect</em> function
could be use to estimate different effects of AMR. Also
<code>plot_hdmax2</code> can be applied to step2 results.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## run hdmax2 step2</span></span>
<span></span>
<span><span class="va">object</span> <span class="op">=</span> <span class="va">hdmax2_step1</span></span>
<span><span class="va">mediators_top10</span> <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">methylation</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">hdmax2_step1</span><span class="op">$</span><span class="va">max2_pvalues</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">res.arm_build</span><span class="op">$</span><span class="va">AMR_mean</span><span class="op">)</span></span>
<span><span class="va">boots</span> <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="va">sims</span> <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="co">## selected mediators effects estimation</span></span>
<span></span>
<span><span class="va">hdmax2_step2</span> <span class="op">=</span> <span class="fu">hdmax2</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate_effect.html">estimate_effect</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">hdmax2_step1</span>,</span>
<span>                                       m <span class="op">=</span> <span class="va">m</span>,</span>
<span>                                       boots <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Estimating indirect effect for univariate exposome."</span></span>
<span><span class="co">#&gt; [1] "The input exposome is continuous or binary"</span></span>
<span><span class="co">#&gt; [1] "Generate regression 1 for continuous or binary exposure and mediator 1"</span></span>
<span><span class="co">#&gt; [1] "Generate regression 2 for continuous outcome and mediator 1"</span></span>
<span><span class="co">#&gt; [1] "Generate regression 1 for continuous or binary exposure and mediator 2"</span></span>
<span><span class="co">#&gt; [1] "Generate regression 2 for continuous outcome and mediator 2"</span></span>
<span><span class="co">#&gt; [1] "Computing ODE and OTE for continuous outcome."</span></span>
<span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu">hdmax2</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_hdmax2.html">plot_hdmax2</a></span><span class="op">(</span><span class="va">hdmax2_step2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "hdmax2 plot for univariate exposome"</span></span></code></pre></div>
<p><img src="helper_functions_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; TableGrob (2 x 2) "arrange": 4 grobs</span></span>
<span><span class="co">#&gt;   z     cells    name           grob</span></span>
<span><span class="co">#&gt; 1 1 (1-1,1-1) arrange gtable[layout]</span></span>
<span><span class="co">#&gt; 2 2 (1-1,2-2) arrange gtable[layout]</span></span>
<span><span class="co">#&gt; 3 3 (2-2,1-1) arrange gtable[layout]</span></span>
<span><span class="co">#&gt; 4 4 (2-2,2-2) arrange gtable[layout]</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="how-to-select-potential-mediators-using-q-values-and-fdr-control">How to select potential mediators using q-values and FDR control
?<a class="anchor" aria-label="anchor" href="#how-to-select-potential-mediators-using-q-values-and-fdr-control"></a>
</h2>
<p>Several methods can be use to select potential mediators from step1
results of our method, in our main use cases we simply select top 10
mediators to simplify the narrative. Among available methods to select
mediators from mediation test pvalues, we can use FDR control (False
Discovery Rate).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">data</span> <span class="op">=</span> <span class="fu">hdmax2</span><span class="fu">::</span><span class="va"><a href="../reference/simu_data.html">simu_data</a></span></span>
<span><span class="co">## run hdmax2 step1</span></span>
<span><span class="va">hdmax2_step1</span> <span class="op">=</span> <span class="fu">hdmax2</span><span class="fu">::</span><span class="fu"><a href="../reference/run_AS.html">run_AS</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">X_continuous</span>,</span>
<span>                 Y <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">Y_continuous</span>,</span>
<span>                 M <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">M</span>, </span>
<span>                 K <span class="op">=</span> <span class="va">K</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "The exposure argument is a vector."</span></span>
<span><span class="co">#&gt; [1] "The outcome argument is a vector."</span></span>
<span><span class="co">#&gt; [1] "The outcome argument is numeric"</span></span>
<span><span class="co">#&gt; [1] "Potential mediators matrix is actually a matrix"</span></span>
<span><span class="co">#&gt; [1] "provided K = 5"</span></span>
<span><span class="co">#&gt; [1] "K value has been transformed as integer"</span></span>
<span><span class="co">#&gt; [1] "The input exposome is continuous or binary"</span></span>
<span><span class="co">#&gt; [1] "The outcome vector is numeric and DON'T contains only 0s and 1s, it is assimilated as continous variable."</span></span>
<span><span class="co">#&gt; [1] "Running first regression with univariate explanatory variable."</span></span>
<span><span class="co">#&gt; [1] "Running second regression."</span></span>
<span><span class="co">#&gt; [1] "Running max-squared test."</span></span>
<span><span class="co">#&gt; [1] "Not generating max2 pvalues for each explanatory variable."</span></span>
<span></span>
<span><span class="co">## Select candidate mediator  </span></span>
<span><span class="va">qval</span> <span class="op">&lt;-</span> <span class="fu">fdrtool</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fdrtool/man/fdrtool.html" class="external-link">fdrtool</a></span><span class="op">(</span><span class="va">hdmax2_step1</span><span class="op">$</span><span class="va">max2_pvalues</span>, statistic <span class="op">=</span> <span class="st">"pvalue"</span>, plot <span class="op">=</span> <span class="cn">F</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">$</span><span class="va">qval</span></span>
<span><span class="va">candidate_mediator</span> <span class="op">&lt;-</span> <span class="va">qval</span><span class="op">[</span><span class="va">qval</span><span class="op">&lt;=</span> <span class="fl">0.8</span><span class="op">]</span> <span class="co"># In this example, we will consider FDR levels &lt;80%.</span></span>
<span><span class="va">candidate_mediator</span></span>
<span><span class="co">#&gt; cg00019196 cg00024247 cg00035636 cg00044871 cg00054572 cg00055462 cg00071026 </span></span>
<span><span class="co">#&gt;  0.7637137  0.7637137  0.7974308  0.7637137  0.7637137  0.7772144  0.7637137 </span></span>
<span><span class="co">#&gt; cg00071658 cg00094319 cg00098070 cg00108349 cg00133204 cg00165067 cg00181327 </span></span>
<span><span class="co">#&gt;  0.7637137  0.7848042  0.7637137  0.7921075  0.7993508  0.7939973  0.7637137 </span></span>
<span><span class="co">#&gt; cg00187692 cg00208734 cg00221494 cg00242786 cg00245856 cg00252121 cg00274440 </span></span>
<span><span class="co">#&gt;  0.7637137  0.7637137  0.7637137  0.7637137  0.7984185  0.7637137  0.7637137 </span></span>
<span><span class="co">#&gt; cg00278131 cg00348891 cg00390259 cg00448720 cg00458564 cg00476054 cg00557354 </span></span>
<span><span class="co">#&gt;  0.7637137  0.7637137  0.7637137  0.7743671  0.7637137  0.7637137  0.7637137 </span></span>
<span><span class="co">#&gt; cg00587941 cg00615217 cg00627998 cg00636982 cg00644416 cg00644922 cg00663972 </span></span>
<span><span class="co">#&gt;  0.7637137  0.7637137  0.7637137  0.7637137  0.7637137  0.7637137  0.7950435 </span></span>
<span><span class="co">#&gt; cg00674995 cg00682015 cg00697358 cg00717219 cg00722493 cg00732810 cg00781839 </span></span>
<span><span class="co">#&gt;  0.7637137  0.7637137  0.7637137  0.7637137  0.7820714  0.7637137  0.7637137 </span></span>
<span><span class="co">#&gt; cg00792968 cg00823993 cg00825130 cg00841725 cg00880018 cg00894344 cg00898013 </span></span>
<span><span class="co">#&gt;  0.7637137  0.7637137  0.7637137  0.7942501  0.7637137  0.7637137  0.7637137 </span></span>
<span><span class="co">#&gt; cg00944193 cg00968267 cg00986957 cg00994984 cg01010012 </span></span>
<span><span class="co">#&gt;  0.7637137  0.7637137  0.7679389  0.7758579  0.7965575</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="how-to-transform-a-categorial-variable-in-ordered-factor">How to transform a categorial variable in ordered factor ?<a class="anchor" aria-label="anchor" href="#how-to-transform-a-categorial-variable-in-ordered-factor"></a>
</h2>
<p>When categorial variables are used in our models, we must go through
design matrices, the <code>run_AS</code> and
<code>estimate_effect</code> functions can transform character vector
when order doesn’t matter for categories. Otherwise here’s a simply way
to transform character vector in factor and order categories as you
want.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simu_data</span> <span class="op">=</span> <span class="fu">hdmax2</span><span class="fu">::</span><span class="va"><a href="../reference/simu_data.html">simu_data</a></span></span>
<span></span>
<span><span class="co"># inverse alphabetical order for example</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="va">simu_data</span><span class="op">$</span><span class="va">X_categorial</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">X</span>, ordered <span class="op">=</span> <span class="cn">TRUE</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"D"</span>,<span class="st">"C"</span>,<span class="st">"B"</span>,<span class="st">"A"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.3.3 (2024-02-29)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.4 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] ggplot2_3.5.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] tidyselect_1.2.1        dplyr_1.1.4             farver_2.1.1           </span></span>
<span><span class="co">#&gt;  [4] Biostrings_2.70.3       fastmap_1.1.1           digest_0.6.35          </span></span>
<span><span class="co">#&gt;  [7] rpart_4.1.23            lifecycle_1.0.4         cluster_2.1.6          </span></span>
<span><span class="co">#&gt; [10] magrittr_2.0.3          compiler_4.3.3          rlang_1.1.3            </span></span>
<span><span class="co">#&gt; [13] Hmisc_5.1-2             sass_0.4.9              tools_4.3.3            </span></span>
<span><span class="co">#&gt; [16] utf8_1.2.4              yaml_2.3.8              data.table_1.15.2      </span></span>
<span><span class="co">#&gt; [19] knitr_1.45              labeling_0.4.3          htmlwidgets_1.6.4      </span></span>
<span><span class="co">#&gt; [22] mediation_4.5.0         foreign_0.8-86          withr_3.0.0            </span></span>
<span><span class="co">#&gt; [25] purrr_1.0.2             BiocGenerics_0.48.1     desc_1.4.3             </span></span>
<span><span class="co">#&gt; [28] nnet_7.3-19             grid_4.3.3              stats4_4.3.3           </span></span>
<span><span class="co">#&gt; [31] fansi_1.0.6             colorspace_2.1-0        scales_1.3.0           </span></span>
<span><span class="co">#&gt; [34] MASS_7.3-60.0.1         cli_3.6.2               mvtnorm_1.2-4          </span></span>
<span><span class="co">#&gt; [37] rmarkdown_2.26          crayon_1.5.2            ragg_1.3.0             </span></span>
<span><span class="co">#&gt; [40] generics_0.1.3          rstudioapi_0.15.0       minqa_1.2.6            </span></span>
<span><span class="co">#&gt; [43] cachem_1.0.8            stringr_1.5.1           zlibbioc_1.48.2        </span></span>
<span><span class="co">#&gt; [46] splines_4.3.3           parallel_4.3.3          XVector_0.42.0         </span></span>
<span><span class="co">#&gt; [49] base64enc_0.1-3         vctrs_0.6.5             boot_1.3-29            </span></span>
<span><span class="co">#&gt; [52] Matrix_1.6-5            sandwich_3.1-0          jsonlite_1.8.8         </span></span>
<span><span class="co">#&gt; [55] IRanges_2.36.0          S4Vectors_0.40.2        Formula_1.2-5          </span></span>
<span><span class="co">#&gt; [58] htmlTable_2.4.2         systemfonts_1.0.6       jquerylib_0.1.4        </span></span>
<span><span class="co">#&gt; [61] glue_1.7.0              pkgdown_2.0.7           nloptr_2.0.3           </span></span>
<span><span class="co">#&gt; [64] stringi_1.8.3           gtable_0.3.4            GenomeInfoDb_1.38.7    </span></span>
<span><span class="co">#&gt; [67] hdmax2_2.0.0.9000       lme4_1.1-35.1           munsell_0.5.0          </span></span>
<span><span class="co">#&gt; [70] tibble_3.2.1            pillar_1.9.0            htmltools_0.5.7        </span></span>
<span><span class="co">#&gt; [73] GenomeInfoDbData_1.2.11 R6_2.5.1                textshaping_0.3.7      </span></span>
<span><span class="co">#&gt; [76] evaluate_0.23           lpSolve_5.6.20          lattice_0.22-5         </span></span>
<span><span class="co">#&gt; [79] highr_0.10              backports_1.4.1         memoise_2.0.1          </span></span>
<span><span class="co">#&gt; [82] bslib_0.6.1             fdrtool_1.2.17          Rcpp_1.0.12            </span></span>
<span><span class="co">#&gt; [85] gridExtra_2.3           nlme_3.1-164            checkmate_2.3.1        </span></span>
<span><span class="co">#&gt; [88] xfun_0.42               fs_1.6.3                zoo_1.8-12             </span></span>
<span><span class="co">#&gt; [91] prettydoc_0.4.1         pkgconfig_2.0.3</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Florence Pittion, Magali Richard, Olivier Francois, Basile Jumentier.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
