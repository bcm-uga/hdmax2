[{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_multivariate.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"hdmax2 application for multivariate exposome","text":"hdmax2 package designed accept exposure \\(X\\) consisting univariate data, can continuous, binary, well multivariate exposomes (includes categorical variables). vignette, treat multivariate example, categorial explanatory variables install latest version hdmax2, use github repository","code":"#devtools::install_github(\"bcm-uga/hdmax2\")"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_multivariate.html","id":"simulated-dataset","dir":"Articles","previous_headings":"","what":"Simulated dataset","title":"hdmax2 application for multivariate exposome","text":"simulated 100 samples 500 potential mediators, various type exposures (continuous, binary categorial) outcomes(continuous binary).","code":"simu_data = hdmax2::simu_data  ## Exposures X_matrix = simu_data$X_categorial X_matrix = droplevels(X_matrix) X_matrix = mltools::one_hot(data.table::as.data.table(X_matrix)) X_matrix = as.matrix(X_matrix)  ## Outcomes Y_matrix = as.matrix(simu_data$Y_continuous)  ## High dimension mediators M_matrix = as.matrix(simu_data$M)  ## Covariates age = as.matrix(simu_data$age) gender = as.matrix(simu_data$gender)  ## Number of Latent factor estimation  pc <- prcomp(M_matrix) plot(pc$sdev[1:10],      xlab = 'Principal Component',      ylab = \"Explained variance\") K=8 #pca conclusion : it is better to select too many factors that too few"},{"path":[]},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_multivariate.html","id":"step-1-run-association-studies","dir":"Articles","previous_headings":"First use case categorial exposure and continuous outcome","what":"STEP 1: Run association studies","title":"hdmax2 application for multivariate exposome","text":"run_AS function applied estimate effects exposure \\(X\\) matrix \\(M\\) potential mediators, effect potential mediators outcome \\(Y\\). Covariables can included.","code":"X_type= \"multivariate\" detailed = TRUE Y_type = \"continuous\" detailed = TRUE covar = cbind(age, gender)  hdmax2_step1 = hdmax2::run_AS(X_matrix = X_matrix ,                               Y_matrix = Y_matrix,                               M_matrix = M_matrix,                               K = K,                               X_type = X_type, # indicates the type of Exposure                               Y_type = Y_type,  # indicates the type of Outcome                               detailed = detailed,  # indicates the exposure is multivariate                               covar = covar) #> [1] \"All exposome columns are in numeric format.\" #> [1] \"Running first regression with multivariate explatory variables.\" #> [1] \"Generating detailed pvalues for each explanatory variable.\" #> [1] \"Running second regression.\" #> [1] \"Running max-squared test.\" #> [1] \"Generating max2 pvalues for each explanatory variable.\"  #  # # max2 test results head(hdmax2_step1$max2_pvalues) #> cg00005740 cg00006787 cg00007032 cg00008612 cg00009871 cg00009922  #>  0.9248846  0.9648048  0.1779910  0.1504423  0.8090650  0.2755099"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_multivariate.html","id":"selection-of-a-subset-of-mediators","dir":"Articles","previous_headings":"First use case categorial exposure and continuous outcome","what":"Selection of a subset of mediators","title":"hdmax2 application for multivariate exposome","text":"example, consider 10 first selected mediators.","code":"## Selecting top 10 mediators mediators_top10 = M_matrix[,names(sort(hdmax2_step1$max2_pvalues)[1:10])] head(mediators_top10) #>      cg00897799 cg00502576 cg00894344 cg00513564 cg00014667 cg00888561 #> [1,]  0.8750781  0.8844783  0.7622600  0.7201085  0.7992167 0.09309668 #> [2,]  0.8886705  0.8652441  0.8463778  0.7281696  0.8012565 0.10766164 #> [3,]  0.8661710  0.8910252  0.8287131  0.6729922  0.7892398 0.07369961 #> [4,]  0.9447288  0.8925080  0.8582649  0.6729783  0.8031898 0.09310408 #> [5,]  0.8864371  0.8895356  0.8189183  0.7004180  0.8005460 0.09569806 #> [6,]  0.8775554  0.9168653  0.7999206  0.7261984  0.8190546 0.06168537 #>      cg00902815 cg00410419 cg00252332 cg00026603 #> [1,]  0.7656570 0.10374263  0.1905747  0.8165730 #> [2,]  0.7792483 0.11881329  0.1788090  0.8082611 #> [3,]  0.8183813 0.10789966  0.1635732  0.8564870 #> [4,]  0.7682291 0.11699374  0.1962591  0.8137468 #> [5,]  0.7522033 0.12040911  0.1938904  0.8141816 #> [6,]  0.7834045 0.08577636  0.1427216  0.8258677"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_multivariate.html","id":"step-2-estimation-of-the-indirect-effect","dir":"Articles","previous_headings":"First use case categorial exposure and continuous outcome","what":"STEP 2 : estimation of the indirect effect","title":"hdmax2 application for multivariate exposome","text":"function estimate_effect estimate individual indirect effect mediators.","code":"object = hdmax2_step1 m = mediators_top10 hdmax2_step2 = hdmax2::estimate_effect(object = hdmax2_step1,                                        m = mediators_top10,                                        is.categorial = TRUE) #> [1] \"Estimating indirect effect for multivariate exposome.\" #> [1] \"A model is run to estimate indirect effect of the following explanatory variable: X_matrix_A\" #> [1] \"One mode of the categorical variable is arbitrarily removed to avoid collinearity.\" #> [1] \"Computing ODE and OTE for continuous outcome.\" #> [1] \"A model is run to estimate indirect effect of the following explanatory variable: X_matrix_B\" #> [1] \"One mode of the categorical variable is arbitrarily removed to avoid collinearity.\" #> [1] \"Computing ODE and OTE for continuous outcome.\" #> [1] \"A model is run to estimate indirect effect of the following explanatory variable: X_matrix_C\" #> [1] \"One mode of the categorical variable is arbitrarily removed to avoid collinearity.\" #> [1] \"Computing ODE and OTE for continuous outcome.\" #> [1] \"A model is run to estimate indirect effect of the following explanatory variable: X_matrix_D\" #> [1] \"One mode of the categorical variable is arbitrarily removed to avoid collinearity.\" #> [1] \"Computing ODE and OTE for continuous outcome.\""},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_multivariate.html","id":"plot","dir":"Articles","previous_headings":"First use case categorial exposure and continuous outcome","what":"Plot","title":"hdmax2 application for multivariate exposome","text":"propose set plots include: Forest plot mediators ACME Forest plot mediators PM Comparison ODE, OIE OTE Mediators effect size representation","code":"library(ggplot2) hdmax2::plot_hdmax2(hdmax2_step2, N_med = 10) #> [1] \"hdmax2 plot for multivariate exposome\" #> $X_matrix_A #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] #>  #> $X_matrix_B #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] #>  #> $X_matrix_C #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] #>  #> $X_matrix_D #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout]"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_multivariate.html","id":"second-use-case-multivariate-exposure-and-continuous-outcome","dir":"Articles","previous_headings":"","what":"Second use case multivariate exposure and continuous outcome","title":"hdmax2 application for multivariate exposome","text":"","code":"## Exposures X_matrix = simu_data$X_multi_2expo X_matrix = as.matrix(X_matrix)"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_multivariate.html","id":"step-1-run-association-studies-1","dir":"Articles","previous_headings":"Second use case multivariate exposure and continuous outcome","what":"STEP 1: Run association studies","title":"hdmax2 application for multivariate exposome","text":"run_AS function applied estimate effects exposure \\(X\\) matrix \\(M\\) potential mediators, effect potential mediators outcome \\(Y\\). Covariables can included.","code":"X_type= \"multivariate\" detailed = TRUE Y_type = \"continuous\" detailed = TRUE covar = cbind(age, gender)  hdmax2_step1 = hdmax2::run_AS(X_matrix = X_matrix ,                               Y_matrix = Y_matrix,                               M_matrix = M_matrix,                               K = K,                               X_type = X_type, # indicates the type of Exposure                               Y_type = Y_type,  # indicates the type of Outcome                               detailed = detailed,  # indicates the exposure is multivariate                               covar = covar) #> [1] \"All exposome columns are in numeric format.\" #> [1] \"Running first regression with multivariate explatory variables.\" #> [1] \"Generating detailed pvalues for each explanatory variable.\" #> [1] \"Running second regression.\" #> [1] \"Running max-squared test.\" #> [1] \"Generating max2 pvalues for each explanatory variable.\"  #  # # max2 test results head(hdmax2_step1$max2_pvalues) #>   cg00005740   cg00006787   cg00007032   cg00008612   cg00009871   cg00009922  #> 9.102823e-01 2.920146e-01 7.225012e-01 2.385119e-02 3.516762e-06 9.695216e-01"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_multivariate.html","id":"selection-of-a-subset-of-mediators-1","dir":"Articles","previous_headings":"Second use case multivariate exposure and continuous outcome","what":"Selection of a subset of mediators","title":"hdmax2 application for multivariate exposome","text":"example, consider 10 first selected mediators.","code":"## Selecting top 10 mediators mediators_top10 = M_matrix[,names(sort(hdmax2_step1$max2_pvalues)[1:10])] head(mediators_top10) #>      cg00812096 cg00009871 cg00502469 cg00692833 cg00667948 cg00472029 #> [1,]  0.8347121  0.8363436  0.8927800  0.8948539  0.8712137  0.5820960 #> [2,]  0.8458379  0.8205799  0.5682206  0.8575876  0.8896628  0.6472582 #> [3,]  0.8588473  0.8140062  0.5051385  0.8711505  0.8557260  0.5829765 #> [4,]  0.8839990  0.8291785  0.9149238  0.8780743  0.8603549  0.6182133 #> [5,]  0.8692853  0.8553199  0.9022252  0.9130964  0.8654133  0.6101397 #> [6,]  0.9016656  0.8714318  0.6100352  0.9251308  0.8822586  0.6321066 #>      cg00418880 cg00094319 cg00823993 cg00295794 #> [1,] 0.08166078  0.8263436  0.8934795 0.12546133 #> [2,] 0.07109538  0.8151969  0.9026914 0.13343816 #> [3,] 0.05141945  0.7761152  0.8829338 0.08125871 #> [4,] 0.08230808  0.8164996  0.8706615 0.09549562 #> [5,] 0.08376966  0.7862542  0.8955807 0.09815897 #> [6,] 0.02454763  0.8553498  0.8895120 0.08643299"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_multivariate.html","id":"step-2-estimation-of-the-indirect-effect-1","dir":"Articles","previous_headings":"Second use case multivariate exposure and continuous outcome","what":"STEP 2 : estimation of the indirect effect","title":"hdmax2 application for multivariate exposome","text":"function estimate_effect estimate individual indirect effect mediators.","code":"object = hdmax2_step1 m = mediators_top10 hdmax2_step2 = hdmax2::estimate_effect(object = hdmax2_step1,                                        m = mediators_top10,                                        is.categorial = FALSE) #> [1] \"Estimating indirect effect for multivariate exposome.\" #> [1] \"A model is run to estimate indirect effect of the following explanatory variable: X_continuous\" #> [1] \"Computing ODE and OTE for continuous outcome.\" #> [1] \"A model is run to estimate indirect effect of the following explanatory variable: X_continuous_2\" #> [1] \"Computing ODE and OTE for continuous outcome.\""},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_multivariate.html","id":"plot-1","dir":"Articles","previous_headings":"Second use case multivariate exposure and continuous outcome","what":"Plot","title":"hdmax2 application for multivariate exposome","text":"propose set plots include: Forest plot mediators ACME Forest plot mediators PM Comparison ODE, OIE OTE Mediators effect size representation","code":"library(ggplot2) hdmax2::plot_hdmax2(hdmax2_step2, N_med = 10) #> [1] \"hdmax2 plot for multivariate exposome\" #> $X_continuous #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] #>  #> $X_continuous_2 #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] sessionInfo() #> R version 4.3.3 (2024-02-29) #> Platform: x86_64-pc-linux-gnu (64-bit) #> Running under: Ubuntu 22.04.4 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] ggplot2_3.5.0 #>  #> loaded via a namespace (and not attached): #>  [1] gtable_0.3.4      xfun_0.42         bslib_0.6.1       htmlwidgets_1.6.4 #>  [5] lattice_0.22-5    vctrs_0.6.5       tools_4.3.3       generics_0.1.3    #>  [9] sandwich_3.1-0    tibble_3.2.1      fansi_1.0.6       highr_0.10        #> [13] cluster_2.1.6     pkgconfig_2.0.3   Matrix_1.6-5      data.table_1.15.2 #> [17] checkmate_2.3.1   desc_1.4.3        lifecycle_1.0.4   farver_2.1.1      #> [21] compiler_4.3.3    stringr_1.5.1     hdmax2_0.0.0.9000 textshaping_0.3.7 #> [25] prettydoc_0.4.1   munsell_0.5.0     mediation_4.5.0   htmltools_0.5.7   #> [29] sass_0.4.8        yaml_2.3.8        htmlTable_2.4.2   Formula_1.2-5     #> [33] nloptr_2.0.3      pillar_1.9.0      pkgdown_2.0.7     jquerylib_0.1.4   #> [37] MASS_7.3-60.0.1   cachem_1.0.8      mltools_0.3.5     Hmisc_5.1-1       #> [41] rpart_4.1.23      boot_1.3-29       nlme_3.1-164      tidyselect_1.2.0  #> [45] digest_0.6.34     mvtnorm_1.2-4     stringi_1.8.3     dplyr_1.1.4       #> [49] purrr_1.0.2       labeling_0.4.3    splines_4.3.3     fastmap_1.1.1     #> [53] grid_4.3.3        colorspace_2.1-0  cli_3.6.2         magrittr_2.0.3    #> [57] base64enc_0.1-3   utf8_1.2.4        withr_3.0.0       foreign_0.8-86    #> [61] scales_1.3.0      backports_1.4.1   rmarkdown_2.25    nnet_7.3-19       #> [65] lme4_1.1-35.1     gridExtra_2.3     zoo_1.8-12        ragg_1.2.7        #> [69] lpSolve_5.6.20    memoise_2.0.1     evaluate_0.23     knitr_1.45        #> [73] rlang_1.1.3       Rcpp_1.0.12       glue_1.7.0        rstudioapi_0.15.0 #> [77] minqa_1.2.6       jsonlite_1.8.8    R6_2.5.1          systemfonts_1.0.5 #> [81] fs_1.6.3"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_univariate.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"hdmax2 application for univariate exposome","text":"{} package designed accept exposure \\(X\\) consisting univariate data, can continuous, binary, well multivariate exposomes (includes categorical variables). vignette, treat univariate example. install latest version hdmax2, use github repository","code":"#devtools::install_github(\"bcm-uga/hdmax2\")"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_univariate.html","id":"simulated-dataset","dir":"Articles","previous_headings":"","what":"Simulated dataset","title":"hdmax2 application for univariate exposome","text":"simulated 100 samples 500 potential mediators, various type exposures (continuous binary) outcomes(continuous binary).","code":"simu_data = hdmax2::simu_data  ## Exposures X_matrix = as.matrix(simu_data$X_binary)  ## Outcomes Y_matrix = as.matrix(simu_data$Y_continuous)  ## High dimension mediators M_matrix = as.matrix(simu_data$M)  ## Covariates age = as.matrix(simu_data$age) gender = as.matrix(simu_data$gender)  ## Number of Latent factore estimation pc <- prcomp(M_matrix) plot(pc$sdev[1:10],      xlab = 'Principal Component',      ylab = \"Explained variance\") K=8 #pca conclusion : it is better to select too many factors that too few"},{"path":[]},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_univariate.html","id":"step-1-run-association-studies","dir":"Articles","previous_headings":"First use case binary exposure and continuous outcome","what":"STEP 1: Run association studies","title":"hdmax2 application for univariate exposome","text":"run_AS function applied estimate effects exposuire \\(X\\) matrix \\(M\\) potential mediators, effect potential mediators outcome \\(Y\\). Covariables can included.","code":"X_matrix = as.matrix(as.numeric(X_matrix))  K = K  X_type= \"univariate\"  Y_type = \"continuous\"  covar = cbind(age, gender)  hdmax2_step1 = hdmax2::run_AS(X_matrix = X_matrix ,                 Y_matrix = Y_matrix,                  M_matrix = M_matrix,                   K = K,                  X_type = X_type, # indicates the type of Exposure                  Y_type = Y_type,  # indicates the type of Outcome                  covar = covar) #> [1] \"All exposome columns are in numeric format.\" #> [1] \"Running first regression with univariate explanorty variable.\" #> [1] \"Running second regression.\" #> [1] \"Running max-squared test.\" #> [1] \"Not generating max2 pvalues for each explanatory variable.\""},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_univariate.html","id":"selection-of-a-subset-of-mediators","dir":"Articles","previous_headings":"First use case binary exposure and continuous outcome","what":"Selection of a subset of mediators","title":"hdmax2 application for univariate exposome","text":"example, consider 10 first selected mediators.","code":"## Selecting top 10 mediators ## top 10 selecting mediators mediators_top10 = M_matrix[,names(sort(hdmax2_step1$max2_pvalues)[1:10])] head(mediators_top10) #>      cg00381829 cg00025981 cg00401429 cg00302983 cg00520188  cg00671161 #> [1,]  0.8600816 0.05260918  0.7951180  0.2145703  0.6668338 0.009053900 #> [2,]  0.8951136 0.04054604  0.9063903  0.1763164  0.5652531 0.010239081 #> [3,]  0.8925196 0.05176339  0.8334925  0.1255733  0.6743901 0.009787643 #> [4,]  0.9029140 0.05689405  0.8725825  0.1737595  0.6778167 0.008753840 #> [5,]  0.8902038 0.05310491  0.8400158  0.1952682  0.6794481 0.010138064 #> [6,]  0.8936008 0.02300723  0.8880954  0.1265641  0.6829760 0.011262872 #>      cg00373763 cg00044871 cg00282249 cg00222125 #> [1,]  0.7179983  0.4832424 0.09811770 0.08658997 #> [2,]  0.7129662  0.3968750 0.06418645 0.12729608 #> [3,]  0.7030927  0.3472444 0.10099521 0.12445265 #> [4,]  0.7402126  0.4251088 0.09845608 0.13715962 #> [5,]  0.7365306  0.3687532 0.10586420 0.19267448 #> [6,]  0.7475968  0.4133830 0.10627839 0.21518240"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_univariate.html","id":"step-2","dir":"Articles","previous_headings":"First use case binary exposure and continuous outcome","what":"STEP 2","title":"hdmax2 application for univariate exposome","text":"function estimate_effect estimate individual indirect effect mediators.","code":"object = hdmax2_step1 m = mediators_top10  hdmax2_step2 = hdmax2::estimate_effect(object = object,                                     m = m) #> [1] \"Estimating indirect effect for univariate exposome.\" #> [1] \"Generate regression 2 for continuous outcome and mediator 1\" #> [1] \"Generate regression 2 for continuous outcome and mediator 2\" #> [1] \"Generate regression 2 for continuous outcome and mediator 3\" #> [1] \"Generate regression 2 for continuous outcome and mediator 4\" #> [1] \"Generate regression 2 for continuous outcome and mediator 5\" #> [1] \"Generate regression 2 for continuous outcome and mediator 6\" #> [1] \"Generate regression 2 for continuous outcome and mediator 7\" #> [1] \"Generate regression 2 for continuous outcome and mediator 8\" #> [1] \"Generate regression 2 for continuous outcome and mediator 9\" #> [1] \"Generate regression 2 for continuous outcome and mediator 10\" #> [1] \"Computing ODE and OTE for continuous outcome.\""},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_univariate.html","id":"plot","dir":"Articles","previous_headings":"First use case binary exposure and continuous outcome","what":"Plot","title":"hdmax2 application for univariate exposome","text":"propose set plots include: Forest plot mediators ACME Forest plot mediators PM Comparison ODE, OIE OTE Mediators effect size representation","code":"library(ggplot2) hdmax2::plot_hdmax2(hdmax2_step2, N_med = 10) #> [1] \"hdmax2 plot for univariate exposome\" #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] sessionInfo() #> R version 4.3.3 (2024-02-29) #> Platform: x86_64-pc-linux-gnu (64-bit) #> Running under: Ubuntu 22.04.4 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] ggplot2_3.5.0 #>  #> loaded via a namespace (and not attached): #>  [1] gtable_0.3.4      xfun_0.42         bslib_0.6.1       htmlwidgets_1.6.4 #>  [5] lattice_0.22-5    vctrs_0.6.5       tools_4.3.3       generics_0.1.3    #>  [9] sandwich_3.1-0    tibble_3.2.1      fansi_1.0.6       highr_0.10        #> [13] cluster_2.1.6     pkgconfig_2.0.3   Matrix_1.6-5      data.table_1.15.2 #> [17] checkmate_2.3.1   desc_1.4.3        lifecycle_1.0.4   farver_2.1.1      #> [21] compiler_4.3.3    stringr_1.5.1     hdmax2_0.0.0.9000 textshaping_0.3.7 #> [25] prettydoc_0.4.1   munsell_0.5.0     mediation_4.5.0   htmltools_0.5.7   #> [29] sass_0.4.8        yaml_2.3.8        htmlTable_2.4.2   Formula_1.2-5     #> [33] nloptr_2.0.3      pillar_1.9.0      pkgdown_2.0.7     jquerylib_0.1.4   #> [37] MASS_7.3-60.0.1   cachem_1.0.8      Hmisc_5.1-1       rpart_4.1.23      #> [41] boot_1.3-29       nlme_3.1-164      tidyselect_1.2.0  digest_0.6.34     #> [45] mvtnorm_1.2-4     stringi_1.8.3     dplyr_1.1.4       purrr_1.0.2       #> [49] labeling_0.4.3    splines_4.3.3     fastmap_1.1.1     grid_4.3.3        #> [53] colorspace_2.1-0  cli_3.6.2         magrittr_2.0.3    base64enc_0.1-3   #> [57] utf8_1.2.4        withr_3.0.0       foreign_0.8-86    scales_1.3.0      #> [61] backports_1.4.1   rmarkdown_2.25    nnet_7.3-19       lme4_1.1-35.1     #> [65] gridExtra_2.3     zoo_1.8-12        ragg_1.2.7        lpSolve_5.6.20    #> [69] memoise_2.0.1     evaluate_0.23     knitr_1.45        rlang_1.1.3       #> [73] Rcpp_1.0.12       glue_1.7.0        rstudioapi_0.15.0 minqa_1.2.6       #> [77] jsonlite_1.8.8    R6_2.5.1          systemfonts_1.0.5 fs_1.6.3"},{"path":"https://bcm-uga.github.io/hdmax2/articles/helper_functions.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"hdmax2 helper functions","text":"{} package designed accept exposure \\(X\\) consisting univariate data, can continuous, binary, categorical, well multivariate exposomes. Binary variables converted 0s 1s treated univariate variables. vignette, provide series helper function process data. install latest version hdmax2, use github repository","code":"#devtools::install_github(\"bcm-uga/hdmax2\")"},{"path":"https://bcm-uga.github.io/hdmax2/articles/helper_functions.html","id":"how-to-analyse-agregated-methylated-regions","dir":"Articles","previous_headings":"","what":"How to analyse agregated methylated regions ?","title":"hdmax2 helper functions","text":"simulated 500 samples 1000 potential DNA methylation mediators, various binary exposure (smoking status mothers) continuous outcomes (birth weight).","code":""},{"path":"https://bcm-uga.github.io/hdmax2/articles/helper_functions.html","id":"identifying-aggregated-mediator-regions-amr","dir":"Articles","previous_headings":"How to analyse agregated methylated regions ?","what":"Identifying aggregated mediator regions (AMR)","title":"hdmax2 helper functions","text":"Identify Aggregated Methylated regions (AMR) AMR_search function uses P-values function max2 using adapted comb-p method (comb-p tool manipulates BED files possibly irregularly spaced P-values calculates auto-correlation, combines adjacent P-values, performs false discovery adjustment, finds regions enrichment assigns significance regions).","code":"data = hdmax2::helper_ex  #Artificial reduction of dataset size to pass the github action check when building hdmax2 website data$methylation = data$methylation[ , 800:1000] data$annotation = data$annotation[800:1000, ]   pc <- prcomp(data$methylation) plot(pc$sdev[1:15]^2,      xlab = 'Principal Component',      ylab = \"Explained variance\",      col = c(rep(1, 3), 2, rep(1, 16))) # choosen number of dimension K=5  ## run hdmax2 step1 hdmax2_step1 = hdmax2::run_AS(X_matrix = as.matrix(data$exposure),                               Y_matrix = as.matrix(data$phenotype),                               M_matrix = as.matrix(data$methylation),                                K = K,                               X_type = \"univariate\",                               Y_type = \"continuous\") #> [1] \"All exposome columns are in numeric format.\" #> [1] \"Running first regression with univariate explanorty variable.\" #> [1] \"Running second regression.\" #> [1] \"Running max-squared test.\" #> [1] \"Not generating max2 pvalues for each explanatory variable.\"  ##Detecting AMR chr = data$annotation$chr start = data$annotation$start end = data$annotation$end pval = hdmax2_step1$max2_pvalues cpg = data$annotation$cpg  res.amr_search = hdmax2::AMR_search(chr = data$annotation$chr,                                     start = data$annotation$start,                                     end = data$annotation$end,                                     pval = hdmax2_step1$max2_pvalues,                                     cpg = data$annotation$cpg,                                     seed = 0.6, #Careful to change this parameter when working with real data                                     nCores = 2)  res.amr_search$res #>   chr   start     end           p        fdr #> 2   1 1326166 1326221 0.005626678 0.01688003 #> 1   1 1310734 1310988 0.019799860 0.02138751 #> 3   1 1406862 1407016 0.021387509 0.02138751  res.arm_build = hdmax2::AMR_build(res.amr_search,                                    methylation = data$methylation,                                    nb_cpg = 2)  #List of DMR selected head(res.arm_build$res) #>    DMR chr   start     end          p        fdr nb #> 1 DMR1   1 1310734 1310988 0.01979986 0.02138751  2 #> 2 DMR2   1 1406862 1407016 0.02138751 0.02138751  2  ##CpG in the DMR res.arm_build$CpG_for_each_AMR #> $DMR1 #> [1] \"cg11518257\" \"cg15617543\" #>  #> $DMR2 #> [1] \"cg10228629\" \"cg06377929\""},{"path":"https://bcm-uga.github.io/hdmax2/articles/helper_functions.html","id":"quantifying-indirect-effects","dir":"Articles","previous_headings":"How to analyse agregated methylated regions ?","what":"Quantifying indirect effects","title":"hdmax2 helper functions","text":"Like single mediators analysis esimate_effect function use estimate different effects AMR.","code":"## run hdmax2 step2  object = hdmax2_step1 mediators_top10 = data$methylation[,names(sort(hdmax2_step1$max2_pvalues)[1:10])] m = as.matrix(res.arm_build$AMR_mean) boots = 100 sims = 100 ## selected mediators effects estimation  hdmax2_step2 = hdmax2::estimate_effect(object = hdmax2_step1,                                        m = m,                                        boots = 100,                                        sims = 100) #> [1] \"Estimating indirect effect for univariate exposome.\" #> [1] \"Generate regression 2 for continuous outcome and mediator 1\" #> [1] \"Generate regression 2 for continuous outcome and mediator 2\" #> [1] \"Computing ODE and OTE for continuous outcome.\"   hdmax2::plot_hdmax2(hdmax2_step2, N_med = 2) #> [1] \"hdmax2 plot for univariate exposome\" #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout]"},{"path":"https://bcm-uga.github.io/hdmax2/articles/helper_functions.html","id":"how-to-select-potential-mediators-using-qvalues-and-fdr-control","dir":"Articles","previous_headings":"","what":"How to select potential mediators using q=values and FDR control ?","title":"hdmax2 helper functions","text":"Several methods can use select potential mediators step1 results methods, main use case simply select top 10 mediators can use multiple test adapted threshold like FDR control (False Discovery Rate)","code":"data = hdmax2::simu_data ## run hdmax2 step1 hdmax2_step1 = hdmax2::run_AS(X_matrix = as.matrix(data$X_continuous),                  Y_matrix = as.matrix(data$Y_continuous),                  M_matrix = as.matrix(data$M),                   K = K,                  X_type = \"univariate\",                  Y_type = \"continuous\") #> [1] \"All exposome columns are in numeric format.\" #> [1] \"Running first regression with univariate explanorty variable.\" #> [1] \"Running second regression.\" #> [1] \"Running max-squared test.\" #> [1] \"Not generating max2 pvalues for each explanatory variable.\"  ## Select candidate mediator   qval <- fdrtool::fdrtool(hdmax2_step1$max2_pvalues, statistic = \"pvalue\", plot = F, verbose = F)$qval candidate_mediator <- qval[qval<= 0.8] # In this example, we will consider FDR levels <80%. candidate_mediator #> cg00019196 cg00024247 cg00035636 cg00044871 cg00054572 cg00055462 cg00071026  #>  0.7637137  0.7637137  0.7974308  0.7637137  0.7637137  0.7772144  0.7637137  #> cg00071658 cg00094319 cg00098070 cg00108349 cg00133204 cg00165067 cg00181327  #>  0.7637137  0.7848042  0.7637137  0.7921075  0.7993508  0.7939973  0.7637137  #> cg00187692 cg00208734 cg00221494 cg00242786 cg00245856 cg00252121 cg00274440  #>  0.7637137  0.7637137  0.7637137  0.7637137  0.7984185  0.7637137  0.7637137  #> cg00278131 cg00348891 cg00390259 cg00448720 cg00458564 cg00476054 cg00557354  #>  0.7637137  0.7637137  0.7637137  0.7743671  0.7637137  0.7637137  0.7637137  #> cg00587941 cg00615217 cg00627998 cg00636982 cg00644416 cg00644922 cg00663972  #>  0.7637137  0.7637137  0.7637137  0.7637137  0.7637137  0.7637137  0.7950435  #> cg00674995 cg00682015 cg00697358 cg00717219 cg00722493 cg00732810 cg00781839  #>  0.7637137  0.7637137  0.7637137  0.7637137  0.7820714  0.7637137  0.7637137  #> cg00792968 cg00823993 cg00825130 cg00841725 cg00880018 cg00894344 cg00898013  #>  0.7637137  0.7637137  0.7637137  0.7942501  0.7637137  0.7637137  0.7637137  #> cg00944193 cg00968267 cg00986957 cg00994984 cg01010012  #>  0.7637137  0.7637137  0.7679389  0.7758579  0.7965575"},{"path":"https://bcm-uga.github.io/hdmax2/articles/helper_functions.html","id":"how-to-transform-a-categorial-variable-using-one-hot-encoding","dir":"Articles","previous_headings":"","what":"How to transform a categorial variable using one-hot encoding ?","title":"hdmax2 helper functions","text":"categorial variables used models, must go design matrices, , one-hot encoding function needed.","code":"simu_data = hdmax2::simu_data  X_matrix = simu_data$X_categorial X_matrix = droplevels(X_matrix) X_matrix = mltools::one_hot(data.table::as.data.table(X_matrix)) X_matrix = as.matrix(X_matrix) sessionInfo() #> R version 4.3.3 (2024-02-29) #> Platform: x86_64-pc-linux-gnu (64-bit) #> Running under: Ubuntu 22.04.4 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> loaded via a namespace (and not attached): #>  [1] tidyselect_1.2.0        farver_2.1.1            dplyr_1.1.4             #>  [4] Biostrings_2.70.2       bitops_1.0-7            fastmap_1.1.1           #>  [7] RCurl_1.98-1.14         digest_0.6.34           rpart_4.1.23            #> [10] lifecycle_1.0.4         cluster_2.1.6           magrittr_2.0.3          #> [13] compiler_4.3.3          rlang_1.1.3             Hmisc_5.1-1             #> [16] sass_0.4.8              tools_4.3.3             utf8_1.2.4              #> [19] yaml_2.3.8              data.table_1.15.2       knitr_1.45              #> [22] labeling_0.4.3          htmlwidgets_1.6.4       mediation_4.5.0         #> [25] mltools_0.3.5           foreign_0.8-86          withr_3.0.0             #> [28] purrr_1.0.2             BiocGenerics_0.48.1     desc_1.4.3              #> [31] nnet_7.3-19             grid_4.3.3              stats4_4.3.3            #> [34] fansi_1.0.6             colorspace_2.1-0        ggplot2_3.5.0           #> [37] scales_1.3.0            MASS_7.3-60.0.1         cli_3.6.2               #> [40] mvtnorm_1.2-4           rmarkdown_2.25          crayon_1.5.2            #> [43] ragg_1.2.7              generics_0.1.3          rstudioapi_0.15.0       #> [46] minqa_1.2.6             cachem_1.0.8            stringr_1.5.1           #> [49] zlibbioc_1.48.0         splines_4.3.3           parallel_4.3.3          #> [52] XVector_0.42.0          base64enc_0.1-3         vctrs_0.6.5             #> [55] boot_1.3-29             Matrix_1.6-5            sandwich_3.1-0          #> [58] jsonlite_1.8.8          IRanges_2.36.0          S4Vectors_0.40.2        #> [61] Formula_1.2-5           htmlTable_2.4.2         systemfonts_1.0.5       #> [64] jquerylib_0.1.4         glue_1.7.0              pkgdown_2.0.7           #> [67] nloptr_2.0.3            stringi_1.8.3           gtable_0.3.4            #> [70] GenomeInfoDb_1.38.7     hdmax2_0.0.0.9000       lme4_1.1-35.1           #> [73] munsell_0.5.0           tibble_3.2.1            pillar_1.9.0            #> [76] htmltools_0.5.7         GenomeInfoDbData_1.2.11 R6_2.5.1                #> [79] textshaping_0.3.7       evaluate_0.23           lpSolve_5.6.20          #> [82] lattice_0.22-5          highr_0.10              backports_1.4.1         #> [85] memoise_2.0.1           bslib_0.6.1             fdrtool_1.2.17          #> [88] Rcpp_1.0.12             gridExtra_2.3           nlme_3.1-164            #> [91] checkmate_2.3.1         xfun_0.42               fs_1.6.3                #> [94] zoo_1.8-12              prettydoc_0.4.1         pkgconfig_2.0.3"},{"path":"https://bcm-uga.github.io/hdmax2/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Florence Pittion. Author, maintainer. Magali Richard. Author, thesis advisor. Olivier François. Author, thesis advisor.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Pittion F, Richard M, François O (2024). hdmax2: R package hdmax2 performs high dimension mediation analysis. R package version 0.0.0.9000, https://bcm-uga.github.io/hdmax2/.","code":"@Manual{,   title = {hdmax2: R package hdmax2 performs high dimension mediation analysis},   author = {Florence Pittion and Magali Richard and Olivier François},   year = {2024},   note = {R package version 0.0.0.9000},   url = {https://bcm-uga.github.io/hdmax2/}, }"},{"path":"https://bcm-uga.github.io/hdmax2/index.html","id":"hdmax2","dir":"","previous_headings":"","what":"R package hdmax2 performs high dimension mediation analysis","title":"R package hdmax2 performs high dimension mediation analysis","text":"R package {hdmax2} performs high dimension mediation analysis. package allows users estimate indirect effects mediators, calculate overall indirect effect mediators, facilitates execution high-dimensional mediation analysis. HDMAX2 method includes unobserved confounding factors latent factor mixed model approach. supports use exposures various types consideration continuous binary outcomes.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"R package hdmax2 performs high dimension mediation analysis","text":"","code":"conda create --name hdmax2    conda activate hdmax2 conda install -c conda-forge r-base conda install conda-forge::r-devtools conda install conda-forge::r-rcppeigen conda install conda-forge::r-lme4  R > install.packages(\"ggplot2\") > install.packages(\"prettydoc\") > install.packages(\"fdrtool\") > install.packages(\"mediation\") > devtools::install_github(\"bcm-uga/LEA\")  > devtools::install_github(\"bcm-uga/hdmax2\")"},{"path":"https://bcm-uga.github.io/hdmax2/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"R package hdmax2 performs high dimension mediation analysis","text":"","code":"# load data simu_data = hdmax2::simu_data X_matrix = as.matrix(simu_data$X_continuous) Y_matrix = as.matrix(simu_data$Y_continuous) M_matrix = as.matrix(simu_data$M)  # Run step 1 hdmax2_step1 = hdmax2::run_AS(X_matrix = X_matrix ,                 Y_matrix = Y_matrix,                  M_matrix = M_matrix)  # Select mediators mediators_top10 = M_matrix[,names(sort(hdmax2_step1$max2_pvalues)[1:10])] head(mediators_top10)  # Run step 2 hdmax2_step2 = hdmax2::estimate_effect(object =hdmax2_step1,                                     m = mediators_top10)  # Plot results library(ggplot2) hdmax2::plot_hdmax2(hdmax2_step2, N_med = 10)"},{"path":"https://bcm-uga.github.io/hdmax2/index.html","id":"bug-report--help","dir":"","previous_headings":"","what":"Bug report / Help","title":"R package hdmax2 performs high dimension mediation analysis","text":"Please open issue find bug.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"R package hdmax2 performs high dimension mediation analysis","text":"Jumentier B, CC Barrot, M Estavoyer, J Tost, B Heude, çO Fran, J Lepeule (2023). High-Dimensional Medi- 220 ation Analysis: New Method Applied Maternal Smoking, Placental DNA Methylation, Birth - 221 comes. Environmental Health Perspectives 131 (). Publisher: Environmental Health Perspectives, 047011. 222 https://doi.org/10.1289/EHP11559.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_build.html","id":null,"dir":"Reference","previous_headings":"","what":"Build AMR vector — AMR_build","title":"Build AMR vector — AMR_build","text":"Build AMR result function AMR_search","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_build.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build AMR vector — AMR_build","text":"","code":"AMR_build(res, methylation, nb_cpg = 2)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_build.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build AMR vector — AMR_build","text":"res result object function AMR_search methylation matrix methylation profile. nb_cpg threshold minimal number CpG AMR","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_build.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build AMR vector — AMR_build","text":"set build AMRs. res, selected AMR CpG_for_each_AMR, list markers present AMR. AMR_acp, first components PCA DMR AMR_mean, mean value CpG AMR","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_build.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Build AMR vector — AMR_build","text":"use series pValues (one pValue per CpGs) obtained mEWAS regression method combination pValue max2. determine potential AMRs used combp method present ENmix package (Xu et al. 2016). method uses Fisher method combine pValues also base pair distance (bP) CpGs (1000 bP maximum nb_cpg CpGs AMR). information AMR summarized mean (row) CpG.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_build.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Build AMR vector — AMR_build","text":"Basile Jumentier","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_search.html","id":null,"dir":"Reference","previous_headings":"","what":"Identifying aggregated mediator regions (AMR) — AMR_search","title":"Identifying aggregated mediator regions (AMR) — AMR_search","text":"Identify aggregated methylated regions (AMR) P-values function max2 using modified comb-p method. Compute P-value FDR AMR detected.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_search.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identifying aggregated mediator regions (AMR) — AMR_search","text":"","code":"AMR_search(chr, start, end, pval, cpg, ...)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_search.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identifying aggregated mediator regions (AMR) — AMR_search","text":"chr chromosomes start chromosomal position markers (start) end chromosomal position markers (end) pval P-values markers, max2 function cpg name markers ... see help combp ENmix package","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_search.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identifying aggregated mediator regions (AMR) — AMR_search","text":"res, table selected AMRs. AMR include chromosomic position, P-value, FDR data, matrix cpg, annotation provided P-values","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_search.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Identifying aggregated mediator regions (AMR) — AMR_search","text":"function uses modified comb-p method identify aggregated methylated regions (AMRs).","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_search.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Identifying aggregated mediator regions (AMR) — AMR_search","text":"Basile Jumentier","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/combp2.html","id":null,"dir":"Reference","previous_headings":"","what":"Run mediation analysis for a set of markers\nFunction adapt from the combp function() of the ENmix package — combp2","title":"Run mediation analysis for a set of markers\nFunction adapt from the combp function() of the ENmix package — combp2","text":"Run mediation analysis set markers Function adapt combp function() ENmix package","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/combp2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run mediation analysis for a set of markers\nFunction adapt from the combp function() of the ENmix package — combp2","text":"","code":"combp2(data, dist.cutoff = 1000, bin.size = 310, seed = 0.01, nCores = 10)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/combp2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run mediation analysis for a set of markers\nFunction adapt from the combp function() of the ENmix package — combp2","text":"data data frame bed format file colname name \"V1\",\"V2\", \"V3\",\"V4\",\"V5\",V1 indicate chromosome (1,2,3,...,X,Y), V2 chromosome position, V4 P value V5 name CpGs. dist.cutoff Maximum distance base pair combine adjacent DMRs. bin.size bin size autocorrelation calculation. seed FDR significance threshold initial selection DMR region. nCores Number computer cores used calculation","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/combp2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run mediation analysis for a set of markers\nFunction adapt from the combp function() of the ENmix package — combp2","text":"Results DMRs analysis. result.fdr, table selected AMRs. AMR include chromosomic position, P-value, FDR","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/combp2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run mediation analysis for a set of markers\nFunction adapt from the combp function() of the ENmix package — combp2","text":"input data frame column name V1-V5, indicating chromosome, start position,end position, pValues probe names. function use modified comb-p method identify differentially methylated regions.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/combp2.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Run mediation analysis for a set of markers\nFunction adapt from the combp function() of the ENmix package — combp2","text":"Basile Jumentier","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/estimate_effect.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate effects for a set of mediation markers\nV2 this version allow to integrate covariates in mediation function — estimate_effect","title":"Estimate effects for a set of mediation markers\nV2 this version allow to integrate covariates in mediation function — estimate_effect","text":"Estimate various quantities causal mediation analysis set markers, including average causal mediation effects (indirect effect), average direct effects, proportions mediated, total effect.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/estimate_effect.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate effects for a set of mediation markers\nV2 this version allow to integrate covariates in mediation function — estimate_effect","text":"","code":"estimate_effect(object, m, boots = 100, sims = 3, is.categorial = FALSE)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/estimate_effect.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate effects for a set of mediation markers\nV2 this version allow to integrate covariates in mediation function — estimate_effect","text":"object results hdmax2 step 2 m response variable matrix n rows p columns corresponding mediators selected step1. Response variables must encoded numeric. NAs allowed. boots number bootstrap sims number Monte Carlo draws nonparametric bootstrap quasi-Bayesian approximation. 10000 recommended. .categorial logical variable, true, one mode categorical variable arbitrarily removed avoid collinearity. Caution: X mixture categorical variables variables, must remove mode categorical variable beforehand, indicate parameter FALSE.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/estimate_effect.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate effects for a set of mediation markers\nV2 this version allow to integrate covariates in mediation function — estimate_effect","text":"hdmax2_step2 object ACME, estimation average causal mediation effect (indirect effect) ADE, estimation average direct effect PM, estimation proportion mediated TE, estimation total effect Regressions: xm, regression X M , regression M Y Overall effect oie, overall indirect effect oie_med , oie median oie_sd , oie standard deviation ote, overall total effect ode, overall direct effect","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/estimate_effect.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate effects for a set of mediation markers\nV2 this version allow to integrate covariates in mediation function — estimate_effect","text":"use mediate function mediation package set markers Q-value lower FDR threshold. estimates indirect effects tests significance.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/estimate_effect.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Estimate effects for a set of mediation markers\nV2 this version allow to integrate covariates in mediation function — estimate_effect","text":"Florence Pittion","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/estimate_effect.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate effects for a set of mediation markers\nV2 this version allow to integrate covariates in mediation function — estimate_effect","text":"","code":"# Load example dataset simu_data = hdmax2::simu_data # Run {hdmax2} step 1 hdmax2_step1 = hdmax2::run_AS(   X_matrix = as.matrix(simu_data$X_continuous) ,   Y_matrix =  as.matrix(simu_data$Y_continuous),   M_matrix =  as.matrix(simu_data$M) ) #> [1] \"All exposome columns are in numeric format.\" #> [1] \"Running first regression with univariate explanorty variable.\" #> [1] \"Running second regression.\" #> [1] \"Running max-squared test.\" #> [1] \"Not generating max2 pvalues for each explanatory variable.\" # Select mediators mediators_subset = names(sort(hdmax2_step1$max2_pvalues)[1:10]) mediators_top10 = simu_data$M[, mediators_subset] # Run {hdmax2} step 2 hdmax2_step2 = hdmax2::estimate_effect(    object = hdmax2_step1,     m = mediators_top10) #> [1] \"Estimating indirect effect for univariate exposome.\" #> [1] \"Generate regression 2 for continuous outcome and mediator 1\" #> [1] \"Generate regression 2 for continuous outcome and mediator 2\" #> [1] \"Generate regression 2 for continuous outcome and mediator 3\" #> [1] \"Generate regression 2 for continuous outcome and mediator 4\" #> [1] \"Generate regression 2 for continuous outcome and mediator 5\" #> [1] \"Generate regression 2 for continuous outcome and mediator 6\" #> [1] \"Generate regression 2 for continuous outcome and mediator 7\" #> [1] \"Generate regression 2 for continuous outcome and mediator 8\" #> [1] \"Generate regression 2 for continuous outcome and mediator 9\" #> [1] \"Generate regression 2 for continuous outcome and mediator 10\" #> [1] \"Computing ODE and OTE for continuous outcome.\""},{"path":"https://bcm-uga.github.io/hdmax2/reference/helper_ex.html","id":null,"dir":"Reference","previous_headings":"","what":"Dataset for helper function example — helper_ex","title":"Dataset for helper function example — helper_ex","text":"Dataset helper function example","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/helper_ex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dataset for helper function example — helper_ex","text":"","code":"helper_ex"},{"path":"https://bcm-uga.github.io/hdmax2/reference/helper_ex.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Dataset for helper function example — helper_ex","text":"list 5 objects methylationmethylation matrix, 500 individuals 10000 probes exposureExposure 500 individuals phenotypeOuctome 500 individuals annotationAnnotation 1000 probes covariablesCovariables 500 individuals : sex, bmi, age, treatment","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med.html","id":null,"dir":"Reference","previous_headings":"","what":"lfmm2 adapted function for hdmax2 from LEA::lfmm2 — lfmm2_med","title":"lfmm2 adapted function for hdmax2 from LEA::lfmm2 — lfmm2_med","text":"lfmm2 adapted function hdmax2 LEA::lfmm2","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"lfmm2 adapted function for hdmax2 from LEA::lfmm2 — lfmm2_med","text":"","code":"lfmm2_med(input, env, K, lambda = 1e-05, effect.sizes = FALSE)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"lfmm2 adapted function for hdmax2 from LEA::lfmm2 — lfmm2_med","text":"input response variable matrix n rows p columns env explanatory variable matrix n rows d columns. K latent factor number lambda ridge penalization parameter effect.sizes true false obtain effect sizes","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"lfmm2 adapted function for hdmax2 from LEA::lfmm2 — lfmm2_med","text":"object following attributes","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"lfmm2 adapted function for hdmax2 from LEA::lfmm2 — lfmm2_med","text":"Florence Pittion","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"lfmm2 adapted function for hdmax2 from LEA::lfmm2 — lfmm2_med","text":"","code":"data(simu_data) mod.lfmm1 = lfmm2_med(input = simu_data$M,  env = simu_data$X_binary,  K = 5, effect.sizes = FALSE)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med_test.html","id":null,"dir":"Reference","previous_headings":"","what":"lfmm2_test adapted function for hdmax2 from LEA::lfmm2.test — lfmm2_med_test","title":"lfmm2_test adapted function for hdmax2 from LEA::lfmm2.test — lfmm2_med_test","text":"lfmm2_test adapted function hdmax2 LEA::lfmm2.test","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"lfmm2_test adapted function for hdmax2 from LEA::lfmm2.test — lfmm2_med_test","text":"","code":"lfmm2_med_test(   object,   input,   env,   covar,   full = FALSE,   genomic.control = TRUE,   linear = TRUE,   family = binomial(link = \"logit\") )"},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"lfmm2_test adapted function for hdmax2 from LEA::lfmm2.test — lfmm2_med_test","text":"object lfmm2Class object input response variable matrix n rows p columns env explanatory variable matrix n rows d columns. covar covariables full compute partial regression FALSE/TRUE genomic.control correct pvalue genomic inflation factor linear true false (else logistic) family logistic reg","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"lfmm2_test adapted function for hdmax2 from LEA::lfmm2.test — lfmm2_med_test","text":"object following attributes","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med_test.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"lfmm2_test adapted function for hdmax2 from LEA::lfmm2.test — lfmm2_med_test","text":"Florence Pittion","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med_test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"lfmm2_test adapted function for hdmax2 from LEA::lfmm2.test — lfmm2_med_test","text":"","code":"data(simu_data)  mod.lfmm1 = lfmm2_med(input = simu_data$M,  env = simu_data$X_binary,  K = 5, effect.sizes = FALSE)  res_reg1 = lfmm2_med_test(mod.lfmm1,  input = simu_data$M,  env = simu_data$X_binary, covar = cbind(simu_data$age, simu_data$gender), genomic.control = TRUE)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_hdmax2.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary plot for HDMAX2\nThis function draw a summary plot of hdmax2 — plot_hdmax2","title":"Summary plot for HDMAX2\nThis function draw a summary plot of hdmax2 — plot_hdmax2","text":"Summary plot HDMAX2 function draw summary plot hdmax2","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_hdmax2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary plot for HDMAX2\nThis function draw a summary plot of hdmax2 — plot_hdmax2","text":"","code":"plot_hdmax2(object, N_med = 10)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_hdmax2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary plot for HDMAX2\nThis function draw a summary plot of hdmax2 — plot_hdmax2","text":"object results hdmax2 step 2 N_med number selected mediators","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_hdmax2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary plot for HDMAX2\nThis function draw a summary plot of hdmax2 — plot_hdmax2","text":"Summary plot ACME, PM, OIE, effects interpretation","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_hdmax2.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Summary plot for HDMAX2\nThis function draw a summary plot of hdmax2 — plot_hdmax2","text":"Florence Pittion, Magali Richard","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_hdmax2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary plot for HDMAX2\nThis function draw a summary plot of hdmax2 — plot_hdmax2","text":"","code":"# Load example dataset simu_data = hdmax2::simu_data # Run {hdmax2} step 1 hdmax2_step1 = hdmax2::run_AS(   X_matrix = as.matrix(simu_data$X_continuous) ,   Y_matrix =  as.matrix(simu_data$Y_continuous),   M_matrix =  as.matrix(simu_data$M) ) #> [1] \"All exposome columns are in numeric format.\" #> [1] \"Running first regression with univariate explanorty variable.\" #> [1] \"Running second regression.\" #> [1] \"Running max-squared test.\" #> [1] \"Not generating max2 pvalues for each explanatory variable.\" # Select mediators mediators_subset = names(sort(hdmax2_step1$max2_pvalues)[1:10]) mediators_top10 = simu_data$M[, mediators_subset] # Run {hdmax2} step 2 hdmax2_step2 = hdmax2::estimate_effect(    object = hdmax2_step1,     m = mediators_top10) #> [1] \"Estimating indirect effect for univariate exposome.\" #> [1] \"Generate regression 2 for continuous outcome and mediator 1\" #> [1] \"Generate regression 2 for continuous outcome and mediator 2\" #> [1] \"Generate regression 2 for continuous outcome and mediator 3\" #> [1] \"Generate regression 2 for continuous outcome and mediator 4\" #> [1] \"Generate regression 2 for continuous outcome and mediator 5\" #> [1] \"Generate regression 2 for continuous outcome and mediator 6\" #> [1] \"Generate regression 2 for continuous outcome and mediator 7\" #> [1] \"Generate regression 2 for continuous outcome and mediator 8\" #> [1] \"Generate regression 2 for continuous outcome and mediator 9\" #> [1] \"Generate regression 2 for continuous outcome and mediator 10\" #> [1] \"Computing ODE and OTE for continuous outcome.\" hdmax2::plot_hdmax2(hdmax2_step2, N_med = 10) #> [1] \"hdmax2 plot for univariate exposome\"  #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout]"},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_multivariate.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary plot for multivariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_multivariate","title":"Summary plot for multivariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_multivariate","text":"Summary plot multivariate exposure variables function draw summary plot hdmax2","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_multivariate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary plot for multivariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_multivariate","text":"","code":"plot_multivariate(object, N_med = 10)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_multivariate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary plot for multivariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_multivariate","text":"object results hdmax2 step 2 N_med number selected mediators","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_multivariate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary plot for multivariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_multivariate","text":"Summary plot ACME, PM, OIE, effects interpretation","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_multivariate.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Summary plot for multivariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_multivariate","text":"Florence Pittion, Magali Richard","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_multivariate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary plot for multivariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_multivariate","text":"","code":"# Load example dataset simu_data = hdmax2::simu_data X_matrix = simu_data$X_categorial     X_matrix = droplevels(X_matrix)   X_matrix = mltools::one_hot(data.table::as.data.table(X_matrix))    X_matrix = as.matrix(X_matrix) Y_matrix = simu_data$Y_continuous  M_matrix = simu_data$M  X_type= \"multivariate\"  Y_type = \"continuous\" # Run {hdmax2} step 1 hdmax2_step1 = hdmax2::run_AS(   X_matrix = X_matrix ,   Y_matrix =  Y_matrix,   M_matrix =  M_matrix,    X_type = X_type,   Y_type = Y_type, ) #> [1] \"All exposome columns are in numeric format.\" #> [1] \"Running first regression with multivariate explatory variables.\" #> [1] \"Running second regression.\" #> [1] \"Running max-squared test.\" #> [1] \"Not generating max2 pvalues for each explanatory variable.\" # Select mediators mediators_subset = names(sort(hdmax2_step1$max2_pvalues)[1:10]) mediators_top10 = simu_data$M[, mediators_subset] # Run {hdmax2} step 2 hdmax2_step2 = hdmax2::estimate_effect(    object = hdmax2_step1,     m = mediators_top10,    is.categorial = TRUE) #> [1] \"Estimating indirect effect for multivariate exposome.\" #> [1] \"A model is run to estimate indirect effect of the following explanatory variable: X_matrix_A\" #> [1] \"One mode of the categorical variable is arbitrarily removed to avoid collinearity.\" #> [1] \"Computing ODE and OTE for continuous outcome.\" #> [1] \"A model is run to estimate indirect effect of the following explanatory variable: X_matrix_B\" #> [1] \"One mode of the categorical variable is arbitrarily removed to avoid collinearity.\" #> [1] \"Computing ODE and OTE for continuous outcome.\" #> [1] \"A model is run to estimate indirect effect of the following explanatory variable: X_matrix_C\" #> [1] \"One mode of the categorical variable is arbitrarily removed to avoid collinearity.\" #> [1] \"Computing ODE and OTE for continuous outcome.\" #> [1] \"A model is run to estimate indirect effect of the following explanatory variable: X_matrix_D\" #> [1] \"One mode of the categorical variable is arbitrarily removed to avoid collinearity.\" #> [1] \"Computing ODE and OTE for continuous outcome.\" hdmax2::plot_multivariate(hdmax2_step2, N_med = 10)     #> $X_matrix_A #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] #>  #> $X_matrix_B #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] #>  #> $X_matrix_C #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] #>  #> $X_matrix_D #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] #>"},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary plot for univariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_univariate","title":"Summary plot for univariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_univariate","text":"Summary plot univariate exposure variables function draw summary plot hdmax2","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary plot for univariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_univariate","text":"","code":"plot_univariate(object, N_med = 10)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary plot for univariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_univariate","text":"object results hdmax2 step 2 N_med number selected mediators","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary plot for univariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_univariate","text":"Summary plot ACME, PM, OIE, effects interpretation","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Summary plot for univariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_univariate","text":"Florence Pittion, Magali Richard","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary plot for univariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_univariate","text":"","code":"# Load example dataset simu_data = hdmax2::simu_data # Run {hdmax2} step 1 hdmax2_step1 = hdmax2::run_AS(   X_matrix = as.matrix(simu_data$X_continuous) ,   Y_matrix =  as.matrix(simu_data$Y_continuous),   M_matrix =  as.matrix(simu_data$M) ) #> [1] \"All exposome columns are in numeric format.\" #> [1] \"Running first regression with univariate explanorty variable.\" #> [1] \"Running second regression.\" #> [1] \"Running max-squared test.\" #> [1] \"Not generating max2 pvalues for each explanatory variable.\" # Select mediators mediators_subset = names(sort(hdmax2_step1$max2_pvalues)[1:10]) mediators_top10 = simu_data$M[, mediators_subset] # Run {hdmax2} step 2 hdmax2_step2 = hdmax2::estimate_effect(    object = hdmax2_step1,     m = mediators_top10) #> [1] \"Estimating indirect effect for univariate exposome.\" #> [1] \"Generate regression 2 for continuous outcome and mediator 1\" #> [1] \"Generate regression 2 for continuous outcome and mediator 2\" #> [1] \"Generate regression 2 for continuous outcome and mediator 3\" #> [1] \"Generate regression 2 for continuous outcome and mediator 4\" #> [1] \"Generate regression 2 for continuous outcome and mediator 5\" #> [1] \"Generate regression 2 for continuous outcome and mediator 6\" #> [1] \"Generate regression 2 for continuous outcome and mediator 7\" #> [1] \"Generate regression 2 for continuous outcome and mediator 8\" #> [1] \"Generate regression 2 for continuous outcome and mediator 9\" #> [1] \"Generate regression 2 for continuous outcome and mediator 10\" #> [1] \"Computing ODE and OTE for continuous outcome.\" hdmax2::plot_univariate(hdmax2_step2, N_med = 10)  #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout]"},{"path":"https://bcm-uga.github.io/hdmax2/reference/run_AS.html","id":null,"dir":"Reference","previous_headings":"","what":"Association Study with both exposure and outcome — run_AS","title":"Association Study with both exposure and outcome — run_AS","text":"function uses lfmm (latent factor mixed models) estimate effects exposures outcomes response matrix. applied estimate effects exposure $X$ matrix $M$ potential mediators, effect marker outcome $Y$. uses covariables matrix $conf$ $K$ latent factors. Test possible markers determine potential mediators exposure-outcome association. compute squared maximum two series P-values $max2$ test computes squared maximum two series P-values association studie. rejects null-hypothesis either effect X M, effect M Y null.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/run_AS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Association Study with both exposure and outcome — run_AS","text":"","code":"run_AS(   X_matrix,   Y_matrix,   M_matrix,   K = 5,   X_type = \"univariate\",   Y_type = \"continuous\",   covar = NULL,   detailed = FALSE,   diagnostic.plot = FALSE,   genomic.control = TRUE,   effect.sizes = FALSE )"},{"path":"https://bcm-uga.github.io/hdmax2/reference/run_AS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Association Study with both exposure and outcome — run_AS","text":"X_matrix Exposure. explanatory variable matrix n rows d columns. column corresponds distinct explanatory variable (Exposure). columns numeric format. Y_matrix Outcome. explanatory variable matrix n rows 1 columns. M_matrix response variable matrix n rows p columns. Response variables must encoded numeric. NAs allowed. K integer number latent factors regression model. X_type Type exposition, can either \"univariate\" (continuous binary variables), \"multivariate\". Categorial variables must one-hot encoded multivariate variables. See helper_functions example. Y_type type outcome, , can either \"binary\" \"continuous\" covar set covariable, must numeric. NAs allowed detailed logical indicate p-values must estimated explanatory variables (detailed = TRUE) addition pvalue global model (detailed = FALSE, default) diagnostic.plot TRUE histogram p-values together estimate eta0 null line plotted. Useful visually check fit estimated proportion null p-values. genomic.control correct pvalue genomic inflation factor effect.sizes effect sizes lfmm needed","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/run_AS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Association Study with both exposure and outcome — run_AS","text":"object following attributes first association study (mod1): pValue, estimation effects X Y matrix M. U, scores matrix K latent factors computed first regression zscore, score matrix exposure X outcome Y. fscore, score matrix exposure X outcome Y. adj_rsquared gif, Genomic inflation factor X Y, expressing deviation distribution observed test statistic compared distribution expected test statistic second association study (mod2): pValue, zscore, fscore,  adj_rsquared, gif results max2 test: pval, results max2 test input element: exposition , outcome, matrix  (element type) covar","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/run_AS.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Association Study with both exposure and outcome — run_AS","text":"response variable matrix Y explanatory variable centered. argument, missing values must imputed: NA allowed. K (number latent factors) can estimated eigenvalues PCA. Possibility calibrating scores pValues GIF (Genomic Inflation Factor). See LEA package information. Max2 test P-value computed markers following formula $$pV = max(pVal1, pVal2)^2$$","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/run_AS.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Association Study with both exposure and outcome — run_AS","text":"Florence Pittion","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/run_AS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Association Study with both exposure and outcome — run_AS","text":"","code":"# Load example dataset simu_data = hdmax2::simu_data # Run {hdmax2} step 1 hdmax2_step1 = run_AS(X_matrix = as.matrix(simu_data$X_continuous) ,                       Y_matrix =  as.matrix(simu_data$Y_continuous),                       M_matrix =  as.matrix(simu_data$M)) #> [1] \"All exposome columns are in numeric format.\" #> [1] \"Running first regression with univariate explanorty variable.\" #> [1] \"Running second regression.\" #> [1] \"Running max-squared test.\" #> [1] \"Not generating max2 pvalues for each explanatory variable.\" # Print max2 test results head(hdmax2_step1$max2_pvalues) #> cg00005740 cg00006787 cg00007032 cg00008612 cg00009871 cg00009922  #>  0.2614245  0.4061289  0.1119728  0.9231155  0.7612041  0.8804220"},{"path":"https://bcm-uga.github.io/hdmax2/reference/simu_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Dataset for example — simu_data","title":"Dataset for example — simu_data","text":"Dataset example","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/simu_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dataset for example — simu_data","text":"","code":"simu_data"},{"path":"https://bcm-uga.github.io/hdmax2/reference/simu_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Dataset for example — simu_data","text":"list  objects M methylation matrix, 100 samples 500 potential mediators X_continuous Continuous Exposure 100 samples X_binary Binary Exposure 100 samples X_categorial Categorial Exposure 100 samples Y_continuous Continuous Outcome 100 samples Y_binary Binary Outcome 100 samples age age covariable gender gender covariable","code":""}]
