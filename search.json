[{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_tutorial.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"hdmax2 application","text":"statistical association observed external exposure (XX) individual outcome (YY), one intermediate variables (M) (gene expression epigenetic changes) may mediate effect. Identifying assessing mediating role variables effect XX YY crucial deciphering underlying causal mechanisms epidemiological clinical research. process, known mediation analysis, involves studying mediator variables define causal structure XX YY. mediated effect, termed indirect effect, equal effect XX YY mediated (M), distinguish direct effect XX YY unexplained (M). R package hdmax2 dedicated high-dimensional mediation analyses. mediation analyses, necessary data includes one () exposure variable(s), matrix potential mediators, outcome variable. term “high dimensional” refers large quantity potential mediators among seek identify actual mediators. fundamental concept behind HDMAX2 methods use latent factor mixed regression model estimating unobserved latent factors conducting high-dimensional association analysis. HDMAX2 also implements novel procedure known max-squared test assess statistical significance potential mediators. Finally, HDMAX2 enables calculation overall indirect effect single model includes mediators simultaneously. approach therefore takes account correlations mediators. hdmax2 program enriched numerous features, including ability manage various types variables exposure (continuous, binary, categorical, multivariate), well capability incorporate binary outcomes. package enables users : investigate associations variables XX, (M), YY, compute mediated effect potential mediator, assess overall indirect effect total model, visualize results. package hdmax2 designed accept : One several Exposure variables XX consisting univariate data, can continuous, binary categorical well multivariate exposure. define nn number samples within tested cohort. Therefore, exposure outcome variable consists nn measurements. R language, categorical variables encoded factor objects. function .factor() can used encode categorical variables. functions levels() ordered() can used define order modalities categorical variables. convention, hdmax2 uses first modality reference calculate effects associated modalities variable, encoded default statistical regression models R. Continuous intermediary variables, denoted M, represented matrix encompassing potential mediators, methylome transcriptome molecular features. matrix M entered separated input, without missing values. intermediary variable matrix M dimension n×pn \\times p, pp total number intermediate variables. outcome variable, denoted YY, corresponds vector dimension nn, supports continuous binary formats. Continuous binary variables must encoded numeric format. Optional covariates, ZZ, can included observed adjustment factors model. Please refer helper function section insight interpret additional set covariates. KK, number latent factors estimated. install latest version hdmax2, use github repository","code":"#devtools::install_github(\"bcm-uga/hdmax2\")"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_tutorial.html","id":"method-example-simulation-multivariate-exposure-and-continuous-outcome","dir":"Articles","previous_headings":"","what":"METHOD Example (simulation) : multivariate exposure and continuous outcome","title":"hdmax2 application","text":"example use two variables exposure (continuous binary), continuous outcome two adjustment factors (age gender). simulated data 100 samples 1000 potential mediators. matrix potential mediators extract real methylation data (TCGA PDAC samples). define KK number estimated latent factors performing PCA potential mediators matrix. scree plot criterion looks “elbow” curve selects components just line flattens , KK chosen procedure.","code":"simu_data = hdmax2::simu_data ## Number of Latent factore estimation pc <- prcomp(simu_data$M1) plot((pc$sdev^2/sum(pc$sdev^2))[1:10],      type = \"b\",      xlab = 'Principal Component',      ylab = \"Explained variance\") K=4 #pca conclusion : it is better to select too many factors than too few"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_tutorial.html","id":"step-1-run-association-studies","dir":"Articles","previous_headings":"METHOD Example (simulation) : multivariate exposure and continuous outcome","what":"STEP 1: Run association studies","title":"hdmax2 application","text":"run_AS function applied: First estimate latent factors lfmmlfmm algorithms. identify significant effects exposure XX potential mediators M matrix, significant effect potential mediators outcome YY. eventually compute mediation test: max-squared test. run_AS function takes inputs: XX exposure: can vector, factor nn (samples) elements data frame nn rows 1 column univariate xx columns different exposure variables multivariate. YY outcome: can vector matrix nn rows 1 column. M potential mediators: must matrix nn rows pp columns (potential mediators). KK number latent factors defined earlier: must integer. Adjustment factors covar can included: must numeric (data frame matrix) nn rows. run_AS function provides object containing: Results two association studies (PP-values, fscores zscores),  Latent factors estimation matrix UU (pp rows KK columns) first regression, run_AS function’s inputs, max-squared test PP-values results.","code":"## multivariate Exposures (continuous + binary) X = data.frame(X1 = simu_data$X_continuous, X2 = simu_data$X_binary) covar = cbind(simu_data$age, simu_data$gender) covar = as.data.frame(covar)  hdmax2_step1 = hdmax2::run_AS(exposure = X ,                               outcome = simu_data$Y_continuous,                               M = simu_data$M2,                               K = K,                               covar = covar) head(hdmax2_step1$AS_1$pval) #>    cg00005740    cg00006787    cg00007032    cg00008612    cg00009871  #> 6.385434e-110  7.557479e-86 3.515170e-127  5.140365e-98 8.322935e-110  #>    cg00009922  #>  7.946406e-11  data_hdmax2_step1 <- data.frame(pvalues = hdmax2_step1$max2_pvalues)   hist(data_hdmax2_step1$pvalues,        breaks = 30,                      main = \"Max2 test pvalues distribution\",       xlab = \"pvalues\",                 col = \"gray\",                     border = \"black\") head(hdmax2_step1$AS_1$U) #>            [,1]       [,2]       [,3]       [,4] #> [1,] -12.585133 -1.1510431  0.3444928  0.1350501 #> [2,]   3.406759  0.5755978 -0.7455638 -0.5796212 #> [3,]   7.942628  1.7442171 -1.0279125 -0.5658921 #> [4,]   2.884806  0.8904630 -0.3638173 -0.5666794 #> [5,]  -9.200969 -0.9469759  0.3270254  0.1069010 #> [6,]  14.865324  1.9505182 -1.3129179 -0.9547634 head(hdmax2_step1$max2_pvalues) #>   cg00005740   cg00006787   cg00007032   cg00008612   cg00009871   cg00009922  #> 4.278131e-07 1.406700e-02 5.550730e-15 2.400616e-14 1.015465e-08 2.632524e-01"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_tutorial.html","id":"selection-of-a-subset-of-mediators","dir":"Articles","previous_headings":"METHOD Example (simulation) : multivariate exposure and continuous outcome","what":"Selection of a subset of mediators","title":"hdmax2 application","text":"max-squared PP-values used selection mediators user’s chosen method. Numerous selection methods available, FDR control. Also context methylation data, ’s feasible identify aggregated mediator regions (AMR) based paired PP-values frome mediation test. Refer helper_functions vignette assistance FDR control AMR researching procedure. example, opted top ten significant PP-values max-squared test.","code":"## Selecting top 10 mediators mediators_top10 = simu_data$M2[,names(sort(hdmax2_step1$max2_pvalues)[1:10])] head(mediators_top10) #>            cg00025981 cg00075768 cg00019093 cg00066729 cg00031759 cg00084432 #> GSM1051525   1.685693   2.218030   1.557068   2.430756   1.691808   3.780360 #> GSM1051526   6.161752   5.784076   5.691395   5.489877   6.089739   8.069034 #> GSM1051527   7.679215   6.889730   7.079877   6.397163   7.563050   9.386660 #> GSM1051528   6.431278   5.836811   5.913431   5.450084   6.318493   8.108019 #> GSM1051529   2.266971   2.807172   2.098831   3.032556   2.256564   4.550265 #> GSM1051530   7.782111   7.576316   7.183111   7.398095   7.658832  10.399671 #>            cg00076854 cg00007032 cg00008612 cg00022633 #> GSM1051525   1.966973   1.431224   2.318326   1.459519 #> GSM1051526   4.500903   5.076067   6.277443   5.195897 #> GSM1051527   5.262907   6.293432   7.585078   6.470071 #> GSM1051528   4.485116   5.290542   6.481324   5.401831 #> GSM1051529   2.456586   1.900969   2.779885   1.940046 #> GSM1051530   5.998859   6.406738   7.633106   6.566717"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_tutorial.html","id":"step-2","dir":"Articles","previous_headings":"METHOD Example (simulation) : multivariate exposure and continuous outcome","what":"STEP 2","title":"hdmax2 application","text":"function estimate_effect estimate individual indirect effect mediators, also overall effects selected mediators. function estimate_effect takes inputs, step 1 object selected mediators matrix MSM^S chosen selection method apply max-squared test PP-values. function estimate_effect use mediation::mediate function obtain several effects estimation uncertainty: ACME Average Causal Mediation Effect: corresponding indirect effect PM Proportion Mediate: corresponding proportion total effect mediated mediator TE total effect: equal sum direct indirect effect ADE Average Direct Effect: represents unmediated effect. step also compute Overall effects : OIE (Indirect effect): corresponding sum indirect effect associated mediators. ODE (Direct Effect): corresponding effect exposure variables outcome variable. OTE (Total Effect): corresponding effect exposure variables outcome variable mediators MSM^S included model. addition, function estimate_effect estimates intermediary effect sizes aja_j bjb_j standard deviations.","code":"hdmax2_step2 = hdmax2::estimate_effect(object = hdmax2_step1,                                        m = mediators_top10) # For first exposure variable head(hdmax2_step2$effects$X1$ACME) #>           est      CI_2.5    CI_97.5  pval       feat #> 1 -0.04783063 -0.18239064 0.08993008 0.468 cg00025981 #> 2  0.11377784  0.06132205 0.16606836 0.000 cg00075768 #> 3 -0.09091496 -0.22959483 0.03816226 0.154 cg00019093 #> 4  0.07128853  0.04720660 0.09268712 0.000 cg00066729 #> 5 -0.01037554 -0.11182775 0.08895316 0.882 cg00031759 #> 6  0.05529412  0.02696207 0.08384472 0.000 cg00084432  # For second exposure variable head(hdmax2_step2$effects$X2$ACME) #>           est      CI_2.5    CI_97.5  pval       feat #> 1 -0.05246611 -0.18006356 0.07323746 0.432 cg00025981 #> 2  0.11759145  0.05839779 0.17625076 0.000 cg00075768 #> 3 -0.08826527 -0.21823566 0.02683452 0.164 cg00019093 #> 4  0.07230110  0.04880869 0.09546717 0.000 cg00066729 #> 5 -0.01075235 -0.11440219 0.09968247 0.854 cg00031759 #> 6  0.05621570  0.02630775 0.08511224 0.000 cg00084432 # For first exposure variable head(hdmax2_step2$effects$X1$PM) #>           est      CI_2.5     CI_97.5  pval       feat #> 1  0.07793461 -0.14768424  0.30034760 0.468 cg00025981 #> 2 -0.18706776 -0.27319809 -0.10068413 0.000 cg00075768 #> 3  0.14686163 -0.06269033  0.37856293 0.154 cg00019093 #> 4 -0.11709747 -0.15242776 -0.07750990 0.000 cg00066729 #> 5  0.01346451 -0.14562168  0.18337909 0.882 cg00031759 #> 6 -0.09018552 -0.13777651 -0.04434364 0.000 cg00084432 head(hdmax2_step2$effects$X2$PM) #>           est      CI_2.5     CI_97.5  pval       feat #> 1  0.08691151 -0.12080763  0.29644228 0.432 cg00025981 #> 2 -0.19477614 -0.29052451 -0.09616481 0.000 cg00075768 #> 3  0.13953217 -0.04426333  0.35891488 0.164 cg00019093 #> 4 -0.11924912 -0.15757274 -0.08046365 0.000 cg00066729 #> 5  0.01682250 -0.16406513  0.18895125 0.854 cg00031759 #> 6 -0.09207909 -0.14035110 -0.04339033 0.000 cg00084432 # For first exposure variable head(hdmax2_step2$effects$X1$TE) #>          est     CI_2.5    CI_97.5 pval       feat #> 1 -0.6079588 -0.6106614 -0.6053151    0 cg00025981 #> 2 -0.6078334 -0.6103544 -0.6050415    0 cg00075768 #> 3 -0.6079978 -0.6106669 -0.6054574    0 cg00019093 #> 4 -0.6080833 -0.6107622 -0.6053750    0 cg00066729 #> 5 -0.6079325 -0.6106565 -0.6052642    0 cg00031759 #> 6 -0.6078076 -0.6104230 -0.6052371    0 cg00084432 head(hdmax2_step2$effects$X2$TE) #>          est     CI_2.5    CI_97.5 pval       feat #> 1 -0.6070015 -0.6090468 -0.6049175    0 cg00025981 #> 2 -0.6067137 -0.6088539 -0.6045375    0 cg00075768 #> 3 -0.6070108 -0.6091154 -0.6049133    0 cg00019093 #> 4 -0.6068201 -0.6089097 -0.6048201    0 cg00066729 #> 5 -0.6069953 -0.6090666 -0.6049249    0 cg00031759 #> 6 -0.6068186 -0.6089037 -0.6045198    0 cg00084432 # For first exposure variable head(hdmax2_step2$effects$X1$ADE) #>          est     CI_2.5    CI_97.5 pval       feat #> 1 -0.5601282 -0.6990500 -0.4254862    0 cg00025981 #> 2 -0.7216112 -0.7749001 -0.6703574    0 cg00075768 #> 3 -0.5170829 -0.6449217 -0.3785875    0 cg00019093 #> 4 -0.6793718 -0.7008739 -0.6552783    0 cg00066729 #> 5 -0.5975570 -0.6973984 -0.4960193    0 cg00031759 #> 6 -0.6631018 -0.6921840 -0.6346139    0 cg00084432 head(hdmax2_step2$effects$X2$ADE) #>          est     CI_2.5    CI_97.5 pval       feat #> 1 -0.5545354 -0.6808834 -0.4268651    0 cg00025981 #> 2 -0.7243052 -0.7838235 -0.6649691    0 cg00075768 #> 3 -0.5187455 -0.6330178 -0.3898110    0 cg00019093 #> 4 -0.6791212 -0.7021317 -0.6556569    0 cg00066729 #> 5 -0.5962429 -0.7068583 -0.4910823    0 cg00031759 #> 6 -0.6630343 -0.6919211 -0.6327212    0 cg00084432 # Estimate OIE for first exposure variable head(hdmax2_step2$effects$X1$oie) #> [1] -0.2958142 -0.1508090 -0.3900808 -0.1246276 -0.2151548 -0.1401295 # OIE median for first exposure variable hdmax2_step2$effects$X1$oie_med #> [1] -0.1933182 # OIE standard deviation for first exposure variable hdmax2_step2$effects$X1$oie_sd #> [1] 0.08165734 hdmax2_step2$effects$X1$ode #>      Estimate    Std. Error       t value      Pr(>|t|)  #> -4.138240e-01  8.050834e-02 -5.140138e+00  1.794390e-06 hdmax2_step2$effects$X1$ote #>       Estimate     Std. Error        t value       Pr(>|t|)  #>  -6.080365e-01   1.337064e-03  -4.547549e+02  1.856535e-157 head(hdmax2_step2$effects$X1$xm) #>    Estimate   Std.Error   t.Value        pValue       feat #> 1 4.2259065 0.009426571 448.29732 5.704808e-154 cg00025981 #> 2 1.9188493 0.009315837 205.97713 2.872086e-123 cg00075768 #> 3 3.8615528 0.009380363 411.66348 1.329727e-150 cg00019093 #> 4 0.7093047 0.007568283  93.72068  2.624847e-92 cg00066729 #> 5 4.1366585 0.012411325 333.29708 2.910289e-142 cg00031759 #> 6 1.7521157 0.017207734 101.82141  1.490810e-95 cg00084432 head(hdmax2_step2$effects$X1$my) #>       Estimate   Std.Error    t.Value       pValue       feat #> 1 -0.012063552 0.016128696 -0.7479558 4.563945e-01 cg00025981 #> 2  0.059815480 0.015016868  3.9832193 1.358342e-04 cg00075768 #> 3 -0.023244544 0.016497605 -1.4089648 1.622166e-01 cg00019093 #> 4  0.100847132 0.016982709  5.9382241 5.061150e-08 cg00066729 #> 5 -0.002496094 0.012440722 -0.2006390 8.414237e-01 cg00031759 #> 6  0.031741873 0.008358622  3.7975008 2.619181e-04 cg00084432"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_tutorial.html","id":"vizualisation-of-results","dir":"Articles","previous_headings":"METHOD Example (simulation) : multivariate exposure and continuous outcome","what":"Vizualisation of results","title":"hdmax2 application","text":"propose set plots including: Mediators ACME Forest plot Mediators PM Forest plot Comparison ODE, OIE OTE Mediators effect size representation  Estimates indirect effect (ACME) B proportions mediated effect (PM) top 10 mediators. effect estimate represented dot 95% CI bar. Symbols correspond significance cut 5% (square p-value ≥0.05\\geq 0.05, circle p-value <0.05< 0.05). Colors correspond sign effect (green estimated effect ≤0\\leq 0 , red estimated effect >0> 0). C Effect sizes Overall Direct Effect (ODE), Overall Indirect Effect (OIE) Overall Total Effect (OTE). Error bars correspond standard deviation (ODE OTE) confidence interval (OIE). D Indirect effect sizes selected mediators. Black corresponds ACME, violet effect exposure XX mediator M, blue corresponds effect mediator M outcome YY. plot_hdmax2 function possible produce 4-plots set individual plot plot_type argument.","code":"hdmax2::plot_hdmax2(hdmax2_step2, plot_type= \"all_plot\") #> [1] \"hdmax2 plot for multivariate exposome\" #> $X1 #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] #>  #> $X2 #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout]"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_tutorial.html","id":"method-use-case-breast-cancer","dir":"Articles","previous_headings":"","what":"METHOD Use Case : Breast cancer","title":"hdmax2 application","text":"tcga_brca downloaded processed Cancer Genome Atlas TCGA-BRCA dataset (. 2019 version data.) list 4 matrices : X (exposure), M (potential mediators), Y (outcome) CF (confounding factor)) : X : exposure variable, matrix 904 rows (patients) 1 column (-status : positive = 1 negative = 0) M : potential mediators, matrix 19959 rows (beta-values CpG probes) 904 columns (patients) Y : outcome variable, matrix 904 rows (patients) 1 column (risk-score, continuous variable) CF : confounding factor, matrix 904 rows (patients) 1 column (age)","code":"if (!(file.exists(\"tcga_brca.RData\"))) {   print(\"Downloading TCGA BRCA dataset from zenodo 10.5281/zenodo.14716548\")   zen4R::download_zenodo( doi = \"10.5281/zenodo.14716548\",                          files = \"tcga_brca.RData\",                         timeout = 3600) }   #> [1] \"Downloading TCGA BRCA dataset from zenodo 10.5281/zenodo.14716548\" #> ℹ Successfully fetched list of published records - page 1 #> ✔ Successfully fetched list of published records! #> ✔ Successfully fetched record for DOI '10.5281/zenodo.14716548'! #> ℹ Download in sequential mode #> [zen4R][INFO] ZenodoRecord - Download in sequential mode #> ℹ Will download 1 file from record '14716548' (doi: '10.5281/zenodo.14716548') - total size: 130 MiB #> [zen4R][INFO] ZenodoRecord - Will download 1 file from record '14716548' (doi: '10.5281/zenodo.14716548') - total size: 130 MiB #> ℹ Downloading file 'tcga_brca.RData' - size: 130 MiB #> [zen4R][INFO] Downloading file 'tcga_brca.RData' - size: 130 MiB #> ℹ File downloaded at '/home/runner/work/hdmax2/hdmax2/vignettes'. #> [zen4R][INFO] File downloaded at '/home/runner/work/hdmax2/hdmax2/vignettes'. #> ℹ Verifying file integrity... #> [zen4R][INFO] ZenodoRecord - Verifying file integrity... #> ℹ File 'tcga_brca.RData': integrity verified (md5sum: 46120c3ce6bdc062b58f7ce6127279be) #> [zen4R][INFO] File 'tcga_brca.RData': integrity verified (md5sum: 46120c3ce6bdc062b58f7ce6127279be) #> ✔ End of download #> [zen4R][INFO] ZenodoRecord - End of download load(\"tcga_brca.RData\") ## Number of Latent factore estimation pc <- prcomp(tcga_brca$M) plot((pc$sdev^2/sum(pc$sdev^2))[1:10],      type = \"b\",      xlab = 'Principal Component',      ylab = \"Explained variance\") K = 2 #The screeplot indicates around 2 main components in the data."},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_tutorial.html","id":"step-1-run-association-studies-1","dir":"Articles","previous_headings":"METHOD Use Case : Breast cancer","what":"STEP 1: Run association studies","title":"hdmax2 application","text":"run_AS function applied estimate effects exposure XX matrix MM potential mediators, effect potential mediators outcome YY .also add age known counfouding factor CFCF. max-squared test PP-values results.","code":"hdmax2_step1 = hdmax2::run_AS(exposure = data.frame(tcga_brca$X),                               outcome = as.vector(tcga_brca$Y),                               M = t(tcga_brca$M),                                K = K,                               covar = tcga_brca$CF) head(hdmax2_step1$max2_pvalues) #>  cg00000292  cg00002426  cg00003994  cg00005847  cg00007981  cg00008493  #> 0.477052667 0.604344920 0.680642120 0.008929247 0.616438894 0.270660079  data_hdmax2_step1 <- data.frame(pvalues = hdmax2_step1$max2_pvalues)  hist(data_hdmax2_step1$pvalues,        breaks = 200,                      main = \"Max2 test pvalues distribution\",       xlab = \"pvalues\",                 col = \"gray\",                     border = \"black\")"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_tutorial.html","id":"selection-of-a-subset-of-mediators-1","dir":"Articles","previous_headings":"METHOD Use Case : Breast cancer","what":"Selection of a subset of mediators","title":"hdmax2 application","text":"selected top 10 mediators.","code":"## Selecting top 10 mediators top10_max2 = sort(hdmax2_step1$max2_pvalues)[1:10] top10_max2 #>   cg11911951   cg26530341   cg00138126   cg11203041   cg03070194   cg01804429  #> 1.156282e-08 5.207120e-08 7.359065e-07 7.819724e-07 5.101811e-06 5.404395e-06  #>   cg15852891   cg13760253   cg03684977   cg00400263  #> 6.103286e-06 1.420400e-05 1.948391e-05 3.468113e-05 mediators_top10 = (t(tcga_brca$M))[,names(sort(hdmax2_step1$max2_pvalues)[1:10])]"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_tutorial.html","id":"step-2-1","dir":"Articles","previous_headings":"METHOD Use Case : Breast cancer","what":"STEP 2","title":"hdmax2 application","text":"function estimate_effect estimate individual indirect effect mediators, also overall effects selected mediators. function estimate_effect takes inputs, step 1 object selected mediators matrix MSM^S chosen selection method apply max-squared test PP-values. function estimate_effect use mediation::mediate function obtain several effects estimation uncertainty: ACME Average Causal Mediation Effect: corresponding indirect effect PM Proportion Mediate: corresponding proportion total effect mediated mediator TE total effect: equal sum direct indirect effect ADE Average Direct Effect: represents unmediated effect step also compute Overall effects : OIE (Indirect effect): corresponding sum indirect effect associated mediators. ODE (Direct Effect): corresponding effect exposure variables outcome variable. OTE (Total Effect): corresponding effect exposure variables outcome variable mediators MSM^S included model.","code":"hdmax2_step2 = hdmax2::estimate_effect(object = hdmax2_step1,                                        m = mediators_top10) head(hdmax2_step2$effects$her2_status$ACME) #>         est    CI_2.5   CI_97.5 pval       feat #> 1 0.2750809 0.1968126 0.3615663    0 cg11911951 #> 2 0.2259850 0.1524411 0.3099751    0 cg26530341 #> 3 0.1848608 0.1139673 0.2658696    0 cg00138126 #> 4 0.2144972 0.1351034 0.2995901    0 cg11203041 #> 5 0.1980238 0.1309337 0.2675874    0 cg03070194 #> 6 0.1636311 0.1024570 0.2357561    0 cg01804429 head(hdmax2_step2$effects$her2_status$PM) #>         est    CI_2.5  CI_97.5  pval       feat #> 1 1.1961722 0.5718761 5.105798 0.022 cg11911951 #> 2 0.9927498 0.4544900 5.142820 0.022 cg26530341 #> 3 0.7781168 0.3486823 3.351704 0.026 cg00138126 #> 4 0.9159539 0.4104087 4.137287 0.044 cg11203041 #> 5 0.8250070 0.3559160 4.707978 0.028 cg03070194 #> 6 0.6851772 0.3085806 3.840348 0.028 cg01804429 head(hdmax2_step2$effects$her2_status$TE) #>         est     CI_2.5   CI_97.5  pval       feat #> 1 0.2302655 0.03610002 0.4438003 0.022 cg11911951 #> 2 0.2280879 0.02379602 0.4384591 0.022 cg26530341 #> 3 0.2337782 0.02964313 0.4541612 0.026 cg00138126 #> 4 0.2259368 0.00763584 0.4241522 0.044 cg11203041 #> 5 0.2352299 0.02244767 0.4312680 0.028 cg03070194 #> 6 0.2302028 0.02166679 0.4276299 0.028 cg01804429 head(hdmax2_step2$effects$her2_status$ADE) #>           est     CI_2.5   CI_97.5  pval       feat #> 1 -0.04481544 -0.2348090 0.1616212 0.644 cg11911951 #> 2  0.00210287 -0.1966008 0.2157063 0.990 cg26530341 #> 3  0.04891740 -0.1465223 0.2600251 0.660 cg00138126 #> 4  0.01143965 -0.1909620 0.1971772 0.880 cg11203041 #> 5  0.03720611 -0.1798778 0.2428894 0.704 cg03070194 #> 6  0.06657173 -0.1558689 0.2715023 0.544 cg01804429 hdmax2_step2$effects$her2_status$oie_med # OIE median for first exposure variable #> [1] 0.5827419 hdmax2_step2$effects$her2_status$ode #>      Estimate    Std. Error       t value      Pr(>|t|)  #> -0.3583404443  0.1034008492 -3.4655464348  0.0005544491 hdmax2_step2$effects$her2_status$ote #>   Estimate Std. Error    t value   Pr(>|t|)  #> 0.23037881 0.10591360 2.17515784 0.02987798"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_tutorial.html","id":"vizualisation-of-results-1","dir":"Articles","previous_headings":"METHOD Use Case : Breast cancer","what":"Vizualisation of results","title":"hdmax2 application","text":"Estimates indirect effect (ACME) B proportions mediated effect (PM) top 10 mediators. effect estimate represented dot 95% CI bar. Symbols correspond significance cut 5% (square p-value ≥0.05\\geq 0.05, circle p-value <0.05< 0.05). Colors correspond sign effect (green estimated effect ≤0\\leq 0 , red estimated effect >0> 0). C Effect sizes Overall Direct Effect (ODE), Overall Indirect Effect (OIE) Overall Total Effect (OTE). Error bars correspond standard deviation (ODE OTE) confidence interval (OIE). D Indirect effect sizes selected mediators. Black corresponds ACME, violet effect exposure XX mediator M, blue corresponds effect mediator M outcome YY. plot_hdmax2 function possible produce 4-plots set individual plot plot_type argument.","code":"hdmax2::plot_hdmax2(hdmax2_step2, plot_type= \"all_plot\") #> [1] \"hdmax2 plot for univariate exposome\" #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout]"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_tutorial.html","id":"method-use-case-multiple-sclerosis","dir":"Articles","previous_headings":"","what":"METHOD Use Case : Multiple sclerosis","title":"hdmax2 application","text":"ms_GSE137143 downloaded processed GEO repository (. 2024 version data.) list 3 matrices : X (exposure), M (potential mediators), Y (outcome) : X : exposure variable, matrix 104 rows (samples) 1 column (gender : female = 1 male = 0) M : potential mediators, matrix 17283 rows (gene expression) 104 columns (samples) Y : outcome variable, matrix 104 rows (samples) 1 column (subtype : RR = 1, CIS = 0)","code":"if (!(file.exists(\"ms_GSE137143.RData\"))) {   print(\"Downloading Multiple Sclerosis dataset from zenodo 10.5281/zenodo.14716548\")   zen4R::download_zenodo( doi = \"10.5281/zenodo.14716548\",                          files = \"ms_GSE137143.RData\",                         timeout = 3600) }   #> [1] \"Downloading Multiple Sclerosis dataset from zenodo 10.5281/zenodo.14716548\" #> ℹ Successfully fetched list of published records - page 1 #> ✔ Successfully fetched list of published records! #> ✔ Successfully fetched record for DOI '10.5281/zenodo.14716548'! #> ℹ Download in sequential mode #> [zen4R][INFO] ZenodoRecord - Download in sequential mode #> ℹ Will download 1 file from record '14716548' (doi: '10.5281/zenodo.14716548') - total size: 6.7 MiB #> [zen4R][INFO] ZenodoRecord - Will download 1 file from record '14716548' (doi: '10.5281/zenodo.14716548') - total size: 6.7 MiB #> ℹ Downloading file 'ms_GSE137143.RData' - size: 6.7 MiB #> [zen4R][INFO] Downloading file 'ms_GSE137143.RData' - size: 6.7 MiB #> ℹ File downloaded at '/home/runner/work/hdmax2/hdmax2/vignettes'. #> [zen4R][INFO] File downloaded at '/home/runner/work/hdmax2/hdmax2/vignettes'. #> ℹ Verifying file integrity... #> [zen4R][INFO] ZenodoRecord - Verifying file integrity... #> ℹ File 'ms_GSE137143.RData': integrity verified (md5sum: 00ac6279dd63bfd6a87cc7d1b70b48b7) #> [zen4R][INFO] File 'ms_GSE137143.RData': integrity verified (md5sum: 00ac6279dd63bfd6a87cc7d1b70b48b7) #> ✔ End of download #> [zen4R][INFO] ZenodoRecord - End of download load(\"ms_GSE137143.RData\") ## Number of Latent factore estimation pc <- prcomp(ms_GSE137143$M) plot((pc$sdev^2/sum(pc$sdev^2))[1:10],      type = \"b\",      xlab = 'Principal Component',      ylab = \"Explained variance\") K = 2 #The screeplot indicates around 2 main components in the data."},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_tutorial.html","id":"step-1-run-association-studies-2","dir":"Articles","previous_headings":"METHOD Use Case : Multiple sclerosis","what":"STEP 1: Run association studies","title":"hdmax2 application","text":"run_AS function applied estimate effects exposure XX matrix MM potential mediators, effect potential mediators outcome YY .also add age known counfouding factor CFCF. max-squared test PP-values results.","code":"hdmax2_step1 = hdmax2::run_AS(exposure = data.frame(ms_GSE137143$X),                               outcome = as.vector(ms_GSE137143$Y),                               M = t(ms_GSE137143$M),                                K = K) head(hdmax2_step1$max2_pvalues) #>     TSPAN6       DPM1      SCYL3   C1orf112        FGR        CFH  #> 0.14357011 0.09555062 0.96163358 0.88820760 0.09920302 0.39221000  data_hdmax2_step1 <- data.frame(pvalues = hdmax2_step1$max2_pvalues)  hist(data_hdmax2_step1$pvalues,        breaks = 200,                      main = \"Max2 test pvalues distribution\",       xlab = \"pvalues\",                 col = \"gray\",                     border = \"black\")"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_tutorial.html","id":"selection-of-a-subset-of-mediators-2","dir":"Articles","previous_headings":"METHOD Use Case : Multiple sclerosis","what":"Selection of a subset of mediators","title":"hdmax2 application","text":"selected top 10 mediators.","code":"## Selecting top 10 mediators top10_max2 = sort(hdmax2_step1$max2_pvalues)[1:10] top10_max2 #>       MVB12B         NT5E        TMTC2        CD209       PFKFB2      TMEM86A  #> 2.035825e-06 4.526574e-06 4.500873e-05 6.090668e-05 7.095797e-05 1.199468e-04  #>        HEMGN         POP5       HECTD1         PAK6  #> 1.426972e-04 1.534255e-04 2.295288e-04 2.510077e-04 mediators_top10 = (t(ms_GSE137143$M))[,names(sort(hdmax2_step1$max2_pvalues)[1:10])]"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_tutorial.html","id":"step-2-2","dir":"Articles","previous_headings":"METHOD Use Case : Multiple sclerosis","what":"STEP 2","title":"hdmax2 application","text":"function estimate_effect estimate individual indirect effect mediators, also overall effects selected mediators. function estimate_effect takes inputs, step 1 object selected mediators matrix MSM^S chosen selection method apply max-squared test PP-values. function estimate_effect use mediation::mediate function obtain several effects estimation uncertainty: ACME Average Causal Mediation Effect: corresponding indirect effect PM Proportion Mediate: corresponding proportion total effect mediated mediator TE total effect: equal sum direct indirect effect ADE Average Direct Effect: represents unmediated effect step also compute Overall effects : OIE (Indirect effect): corresponding sum indirect effect associated mediators. ODE (Direct Effect): corresponding effect exposure variables outcome variable. OTE (Total Effect): corresponding effect exposure variables outcome variable mediators MSM^S included model.","code":"hdmax2_step2 = hdmax2::estimate_effect(object = hdmax2_step1,                                        m = mediators_top10) head(hdmax2_step2$effects$gender$ACME) #>           est      CI_2.5     CI_97.5  pval    feat #> 1 -0.09077507 -0.18840144 -0.01922880 0.008  MVB12B #> 2  0.06707219  0.01431824  0.15316016 0.004    NT5E #> 3  0.07056658  0.01531698  0.15605630 0.008   TMTC2 #> 4 -0.06991397 -0.15769496 -0.01525150 0.002   CD209 #> 5 -0.07118542 -0.16409292 -0.01031814 0.016  PFKFB2 #> 6  0.05980062  0.01578039  0.13478566 0.000 TMEM86A head(hdmax2_step2$effects$gender$PM) #>          est      CI_2.5     CI_97.5  pval    feat #> 1  0.2889819  0.05283715  1.16352534 0.010  MVB12B #> 2 -0.2017068 -1.22826625 -0.03548262 0.004    NT5E #> 3 -0.1987571 -0.87569344 -0.03932224 0.012   TMTC2 #> 4  0.2084197  0.03948217  0.84273234 0.008   CD209 #> 5  0.2101325  0.02968379  0.85149969 0.018  PFKFB2 #> 6 -0.1787964 -0.98591733 -0.04177735 0.000 TMEM86A head(hdmax2_step2$effects$gender$TE) #>          est     CI_2.5    CI_97.5  pval    feat #> 1 -0.2959140 -0.4642874 -0.1066426 0.002  MVB12B #> 2 -0.3038123 -0.4661981 -0.1013277 0.000    NT5E #> 3 -0.3151221 -0.4729717 -0.1367908 0.004   TMTC2 #> 4 -0.3039390 -0.4631509 -0.1154835 0.006   CD209 #> 5 -0.3117857 -0.4703669 -0.1309963 0.002  PFKFB2 #> 6 -0.3027430 -0.4549222 -0.1107366 0.000 TMEM86A head(hdmax2_step2$effects$gender$ADE) #>          est     CI_2.5     CI_97.5  pval    feat #> 1 -0.1706299 -0.3470438  0.01529790 0.080  MVB12B #> 2 -0.4403246 -0.6012640 -0.23313726 0.000    NT5E #> 3 -0.4710404 -0.6331761 -0.25663369 0.000   TMTC2 #> 4 -0.2014184 -0.3751362 -0.01818126 0.036   CD209 #> 5 -0.2065437 -0.3843393 -0.01560094 0.040  PFKFB2 #> 6 -0.4204543 -0.5731202 -0.23953984 0.000 TMEM86A hdmax2_step2$effects$gender$oie_med # OIE median for first exposure variable #> [1] -0.6212699 hdmax2_step2$effects$gender$ode #>    Estimate  Std. Error     z value    Pr(>|z|)  #> -2.32450147  1.23743400 -1.87848521  0.06031482 hdmax2_step2$effects$gender$ote #>     Estimate   Std. Error      z value     Pr(>|z|)  #> -1.604244218  0.548823596 -2.923059847  0.003466099"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_tutorial.html","id":"vizualisation-of-results-2","dir":"Articles","previous_headings":"METHOD Use Case : Multiple sclerosis","what":"Vizualisation of results","title":"hdmax2 application","text":"propose set plots including: Mediators ACME Forest plot Mediators PM Forest plot Comparison ODE, OIE OTE Mediators effect size representation  Estimates indirect effect (ACME) B proportions mediated effect (PM) top 10 mediators. effect estimate represented dot 95% CI bar. Symbols correspond significance cut 5% (square p-value ≥0.05\\geq 0.05, circle p-value <0.05< 0.05). Colors correspond sign effect (green estimated effect ≤0\\leq 0 , red estimated effect >0> 0). C Effect sizes Overall Direct Effect (ODE), Overall Indirect Effect (OIE) Overall Total Effect (OTE). Error bars correspond standard deviation (ODE OTE) confidence interval (OIE). D Indirect effect sizes selected mediators. Black corresponds ACME, violet effect exposure XX mediator M, blue corresponds effect mediator M outcome YY. plot_hdmax2 function possible produce 4-plots set individual plot plot_type argument.","code":"hdmax2::plot_hdmax2(hdmax2_step2, plot_type= \"all_plot\") #> [1] \"hdmax2 plot for univariate exposome\" #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout]"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_tutorial.html","id":"helper-functions","dir":"Articles","previous_headings":"","what":"Helper Functions","title":"hdmax2 application","text":"vignette, also provide series helper function process data.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_tutorial.html","id":"how-to-analyse-agregated-methylated-regions","dir":"Articles","previous_headings":"Helper Functions","what":"How to analyse agregated methylated regions ?","title":"hdmax2 application","text":"simulated 100 samples 200 potential DNA methylation mediators, various binary exposure (smoking status mothers) continuous outcomes (birth weight).","code":""},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_tutorial.html","id":"identifying-aggregated-mediator-regions-amr","dir":"Articles","previous_headings":"Helper Functions > How to analyse agregated methylated regions ?","what":"Identifying aggregated mediator regions (AMR)","title":"hdmax2 application","text":"Identify Aggregated Methylated Regions (AMR) AMR_search function uses PP-values max-squared test compute run_AS function using adapted comb-p method (comb-p tool manipulates BED files possibly irregularly spaced PP-values calculates auto-correlation, combines adjacent PP-values, performs false discovery adjustment, finds regions enrichment assigns significance regions). AMR identification useful Epigenomic Wide Association Studies (EWAS) single CpG mediation unsuccessful, complementary analysis.","code":"helper_ex = hdmax2::helper_ex  pc <- prcomp(helper_ex$methylation) plot((pc$sdev^2/sum(pc$sdev^2))[1:15],      xlab = 'Principal Component',      ylab = \"Explained variance\",      col = c(rep(1, 3), 2, rep(1, 16))) # chosen number of dimension K=5  ## run hdmax2 step1 hdmax2_step1 = hdmax2::run_AS(exposure = helper_ex$exposure,                               outcome = helper_ex$phenotype,                               M = helper_ex$methylation,                                K = K)  ##Detecting AMR seed = 0.7 #Careful to change this parameter when working with real data res.amr_search = hdmax2::AMR_search(chr = helper_ex$annotation$chr,                                     start = helper_ex$annotation$start,                                     end = helper_ex$annotation$end,                                     pval = hdmax2_step1$max2_pvalues,                                     cpg = helper_ex$annotation$cpg,                                     seed = seed,                                      nCores = 2)  res.amr_search$res #>   chr  start    end          p        fdr #> 3   1 864893 865027 0.03604853 0.05184658 #> 2   1 858380 858381 0.03901609 0.05184658 #> 4   1 886431 886553 0.04077365 0.05184658 #> 5   1 896773 896774 0.05000351 0.05184658 #> 1   1 854778 855056 0.05184658 0.05184658  res.arm_build = hdmax2::AMR_build(res.amr_search,                                    methylation = helper_ex$methylation,                                    nb_cpg = 2)  #List of DMR selected head(res.arm_build$res) #>    DMR chr  start    end          p        fdr nb #> 1 DMR1   1 886431 886553 0.04077365 0.05184658  3 #> 2 DMR2   1 854778 855056 0.05184658 0.05184658  6  ##CpG in the DMR res.arm_build$CpG_for_each_AMR #> $DMR1 #> [1] \"cg20322444\" \"cg07983659\" \"cg11733071\" #>  #> $DMR2 #> [1] \"cg08029603\" \"cg16347928\" \"cg22699361\" \"cg03890988\" \"cg21786289\" #> [6] \"cg13897241\""},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_tutorial.html","id":"quantifying-indirect-effects","dir":"Articles","previous_headings":"Helper Functions > How to analyse agregated methylated regions ?","what":"Quantifying indirect effects","title":"hdmax2 application","text":"Like single mediators analysis esimate_effect function use estimate different effects AMR. Also plot_hdmax2 can applied step2 results.","code":"## run hdmax2 step2 object = hdmax2_step1 m = as.matrix(res.arm_build$AMR_mean)  ## selected mediators effects estimation  hdmax2_step2 = hdmax2::estimate_effect(object = hdmax2_step1,                                        m = m) library(ggplot2) hdmax2::plot_hdmax2(hdmax2_step2, plot_type= \"all_plot\") #> [1] \"hdmax2 plot for univariate exposome\" #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout]"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_tutorial.html","id":"how-to-select-potential-mediators-using-q-values-and-fdr-control","dir":"Articles","previous_headings":"Helper Functions","what":"How to select potential mediators using q-values and FDR control ?","title":"hdmax2 application","text":"Several methods can use select potential mediators step1 results method, main use cases simply select top 10 mediators simplify narrative. Among available methods select mediators mediation test PP-values, can use FDR (False Discovery Rate) control. QQ-value obtained max-squared test PP-values step 1 hdmax2::hdmax2_qvalue function bounded chosen threshold.","code":"## run hdmax2 step1 hdmax2_step1 = hdmax2::run_AS(exposure = simu_data$X_binary,                  outcome = simu_data$Y_continuous,                  M = simu_data$M1,                   K = K)  ## Select candidate mediator   q_values = hdmax2::hdmax2_qvalue(hdmax2_step1$max2_pvalues) candidate_mediator <- q_values$qv[q_values$qv<= 0.2] # In this example, we will consider FDR levels <20%. candidate_mediator #>   cg00026919   cg00035636   cg00049102   cg00049616   cg00050792   cg00055679  #> 1.434951e-01 1.748547e-03 2.445138e-03 6.103922e-02 3.891147e-05 6.756850e-02  #>   cg00056767   cg00066729   cg00071026   cg00071658   cg00071727   cg00075768  #> 5.357341e-02 4.286252e-11 9.843811e-09 1.073321e-04 3.527028e-03 3.897026e-05  #>   cg00076854   cg00084432   cg00089444   cg00092518   cg00093478   cg00098553  #> 1.909772e-06 4.403319e-06 6.582410e-12 1.581844e-01 2.279497e-05 3.023057e-07  #>   cg00102591   cg00119011   cg00121843   cg00124836   cg00126948   cg00127894  #> 4.846930e-22 1.376804e-14 3.505372e-03 5.728461e-10 1.650267e-09 1.299045e-05  #>   cg01165817  #> 6.346643e-02"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_tutorial.html","id":"how-to-transform-a-categorial-variable-into-an-ordered-factor","dir":"Articles","previous_headings":"Helper Functions","what":"How to transform a categorial variable into an ordered factor?","title":"hdmax2 application","text":"categorical variables used exposure variables, hdmax2 uses first category reference (intercept) calculate effects associated variable’s categories. functions HDMAX2::run_AS HDMAX2::estimate_effect transform character vector used () factor, arbitrary ordering categories. order important , ’s simple way turn character vector factor order categories wish. can use variable input hdmax2 functions.","code":"# inverse alphabetical order for example X = simu_data$X_categorial X = factor(X, ordered = TRUE, levels = c(\"D\",\"C\",\"B\",\"A\"))"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_tutorial.html","id":"how-to-handle-adding-an-additional-set-of-covariates-to-the-second-association-study","dir":"Articles","previous_headings":"Helper Functions","what":"How to handle adding an additional set of covariates to the second association study?","title":"hdmax2 application","text":"possible add second adjustment factors set association study potential mediators outcome makes sense biological standpoint. Nevertheless, additional set adjustment factors second association study must include adjustment factors first association study design run_AS function.","code":"# First adjustment factors set covar = as.data.frame(helper_ex$covariables[,1:2]) # Second adjustment factors set suppl_covar = as.data.frame(helper_ex$covariables[,3:4])  hdmax2_step1 = hdmax2::run_AS(exposure = helper_ex$exposure,                               outcome = helper_ex$phenotype,                               M = helper_ex$methylation,                               K = K,                               covar = covar,                               suppl_covar = suppl_covar) sessionInfo()"},{"path":"https://bcm-uga.github.io/hdmax2/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Florence Pittion. Author, maintainer. Magali Richard. Author, thesis advisor. Olivier Francois. Author, thesis advisor. Basile Jumentier. Author.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Pittion F, Richard M, Francois O, Jumentier B (2025). hdmax2: R package hdmax2 performs high dimension mediation analysis. R package version 2.0.0.9000, https://bcm-uga.github.io/hdmax2/.","code":"@Manual{,   title = {hdmax2: R package hdmax2 performs high dimension mediation analysis},   author = {Florence Pittion and Magali Richard and Olivier Francois and Basile Jumentier},   year = {2025},   note = {R package version 2.0.0.9000},   url = {https://bcm-uga.github.io/hdmax2/}, }"},{"path":"https://bcm-uga.github.io/hdmax2/index.html","id":"hdmax2","dir":"","previous_headings":"","what":"R package hdmax2 performs high dimension mediation analysis","title":"R package hdmax2 performs high dimension mediation analysis","text":"R package hdmax2 offers powerful tools conducting high-dimensional mediation analysis. method investigates causal pathways linking exposure variables outcome variables intermediary factors known mediators. mediators often stem biological metrics like transcriptomes methylomes, present data high dimensions. package capable detecting individual mediators, accurately estimating indirect effects exposure variables associated mediator, determining overall indirect effect encompassing detected mediators. Utilizing latent factor mixed model methodology, method effectively mitigates unobserved confounding factors. accommodates exposures diverse types allows analysis continuous binary outcomes.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"R package hdmax2 performs high dimension mediation analysis","text":"","code":"conda create --name hdmax2  conda activate hdmax2 conda install -c conda-forge r-base conda install conda-forge::r-devtools conda install conda-forge::r-rcppeigen conda install conda-forge::r-lme4  R > install.packages(\"ggplot2\") > install.packages(\"prettydoc\") > install.packages(\"fdrtool\") > install.packages(\"mediation\")  > devtools::install_github(\"bcm-uga/hdmax2\")  # Installing R packages from GitHub may require that users remove older versions and restart their R session # The package might have been installed in your computer (even though it does not work). Remove it using remove.packages() #  rs.restartR() if in RStudio"},{"path":"https://bcm-uga.github.io/hdmax2/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"R package hdmax2 performs high dimension mediation analysis","text":"","code":"library(hdmax2) library(ggplot2)  # Loading some simulated data attach(simu_data)  # Exposure variables   X = X_binary  # Outcome variable   Y = Y_continuous  # Intermediate variables including mediators   M = simu_data$M1  # Choose K (latent factors number) from pca analysis (for example) on potential mediators   K = 5  detach(simu_data)  # Computing significance values for intermediate variables # This step uses LFMMs and max-squared tests   hdmax2_step1 = run_AS(X = X,                         Y = Y,                         M = M,                         K = K)  # Selecting mediators (ten variables having the lowest p-values)   mediators_top10 = order(hdmax2_step1$max2_pvalues)[1:10]   M_10 = M[,mediators_top10]  # Ids of selected mediators   colnames(M_10)  # Estimating indirect and direct effects of exposure on outcome   hdmax2_step2 = estimate_effect(object = hdmax2_step1,                                  m = M_10)  # Showing some results   plot_hdmax2(hdmax2_step2, plot_type = \"all_plot\")"},{"path":"https://bcm-uga.github.io/hdmax2/index.html","id":"bug-report--help","dir":"","previous_headings":"","what":"Bug report / Help","title":"R package hdmax2 performs high dimension mediation analysis","text":"encounter problem, please open GitHub issue contact program developers.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"R package hdmax2 performs high dimension mediation analysis","text":"Jumentier B, CC Barrot, M Estavoyer, J Tost, B Heude, O Francois, J Lepeule (2023). High-Dimensional Mediation Analysis: New Method Applied Maternal Smoking, Placental DNA Methylation, Birth Outcomes. Environmental Health Perspectives 131. Publisher: Environmental Health Perspectives, 047011. https://doi.org/10.1289/EHP11559.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_build.html","id":null,"dir":"Reference","previous_headings":"","what":"Build AMR vector — AMR_build","title":"Build AMR vector — AMR_build","text":"Build AMR result function AMR_search","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_build.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build AMR vector — AMR_build","text":"","code":"AMR_build(res, methylation, nb_cpg = 2)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_build.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build AMR vector — AMR_build","text":"res result object function AMR_search methylation matrix methylation profile. nb_cpg threshold minimal number CpG AMR","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_build.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build AMR vector — AMR_build","text":"set build AMRs. res, selected AMR CpG_for_each_AMR, list markers present AMR. AMR_acp, first components PCA DMR AMR_mean, mean value CpG AMR","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_build.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Build AMR vector — AMR_build","text":"use series pValues (one pValue per CpGs) obtained mEWAS regression method combination pValue max2. determine potential AMRs used combp method present ENmix package (Xu et al. 2016). method uses Fisher method combine pValues also base pair distance (bP) CpGs (1000 bP maximum nb_cpg CpGs AMR). information AMR summarized mean (row) CpG.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_build.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Build AMR vector — AMR_build","text":"Basile Jumentier","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_build.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Build AMR vector — AMR_build","text":"","code":"data = hdmax2::helper_ex K=5 ## run hdmax2 step1 hdmax2_step1 = hdmax2::run_AS(exposure = data$exposure,                              outcome = data$phenotype,                              M = data$methylation,                              K = K) #> Running first regression with univariate exposure variable. #> Running second regression. #> Running max-squared test.  ##Detecting AMR chr = data$annotation$chr start = data$annotation$start end = data$annotation$end pval = hdmax2_step1$max2_pvalues cpg = data$annotation$cpg  res.amr_search = hdmax2::AMR_search( chr = data$annotation$chr, start = data$annotation$start, end = data$annotation$end, pval = hdmax2_step1$max2_pvalues, cpg = data$annotation$cpg, seed = 0.7, #Careful to change this parameter when working with real data nCores = 2)  res.amr_search$res #>   chr  start    end          p        fdr #> 3   1 864893 865027 0.03604853 0.05184658 #> 2   1 858380 858381 0.03901609 0.05184658 #> 4   1 886431 886553 0.04077365 0.05184658 #> 5   1 896773 896774 0.05000351 0.05184658 #> 1   1 854778 855056 0.05184658 0.05184658  res.arm_build = hdmax2::AMR_build(res.amr_search,  methylation = data$methylation, nb_cpg = 2) #List of DMR selected head(res.arm_build$res) #>    DMR chr  start    end          p        fdr nb #> 1 DMR1   1 886431 886553 0.04077365 0.05184658  3 #> 2 DMR2   1 854778 855056 0.05184658 0.05184658  6 ## CpG in the DMR res.arm_build$CpG_for_each_AMR #> $DMR1 #> [1] \"cg20322444\" \"cg07983659\" \"cg11733071\" #>  #> $DMR2 #> [1] \"cg08029603\" \"cg16347928\" \"cg22699361\" \"cg03890988\" \"cg21786289\" #> [6] \"cg13897241\" #>"},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_search.html","id":null,"dir":"Reference","previous_headings":"","what":"Identifying aggregated mediator regions (AMR) — AMR_search","title":"Identifying aggregated mediator regions (AMR) — AMR_search","text":"Identify aggregated methylated regions (AMR) P-values function max2 using modified comb-p method. Compute P-value FDR AMR detected.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_search.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identifying aggregated mediator regions (AMR) — AMR_search","text":"","code":"AMR_search(chr, start, end, pval, cpg, ...)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_search.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identifying aggregated mediator regions (AMR) — AMR_search","text":"chr chromosomes start chromosomal position markers (start) end chromosomal position markers (end) pval P-values markers, max2 function cpg name markers ... see help combp ENmix package","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_search.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identifying aggregated mediator regions (AMR) — AMR_search","text":"res, table selected AMRs. AMR include chromosomic position, P-value, FDR data, matrix cpg, annotation provided P-values","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_search.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Identifying aggregated mediator regions (AMR) — AMR_search","text":"function uses modified comb-p method identify aggregated methylated regions (AMRs).","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_search.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Identifying aggregated mediator regions (AMR) — AMR_search","text":"Basile Jumentier","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_search.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identifying aggregated mediator regions (AMR) — AMR_search","text":"","code":"data = hdmax2::helper_ex K=5 ## run hdmax2 step1 hdmax2_step1 = hdmax2::run_AS(exposure = data$exposure,                              outcome = data$phenotype,                              M = data$methylation,                              K = K) #> Running first regression with univariate exposure variable. #> Running second regression. #> Running max-squared test.  ##Detecting AMR chr = data$annotation$chr start = data$annotation$start end = data$annotation$end pval = hdmax2_step1$max2_pvalues cpg = data$annotation$cpg  res.amr_search = hdmax2::AMR_search( chr = data$annotation$chr, start = data$annotation$start, end = data$annotation$end, pval = hdmax2_step1$max2_pvalues, cpg = data$annotation$cpg, seed = 0.7, #Careful to change this parameter when working with real data nCores = 2) res.amr_search$res #>   chr  start    end          p        fdr #> 3   1 864893 865027 0.03604853 0.05184658 #> 2   1 858380 858381 0.03901609 0.05184658 #> 4   1 886431 886553 0.04077365 0.05184658 #> 5   1 896773 896774 0.05000351 0.05184658 #> 1   1 854778 855056 0.05184658 0.05184658"},{"path":"https://bcm-uga.github.io/hdmax2/reference/combp2.html","id":null,"dir":"Reference","previous_headings":"","what":"Identification of differentially methylated regions (DMR) — combp2","title":"Identification of differentially methylated regions (DMR) — combp2","text":"Function adapt combp function() ENmix package","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/combp2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identification of differentially methylated regions (DMR) — combp2","text":"","code":"combp2(data, dist.cutoff = 1000, bin.size = 310, seed = 0.01, nCores = 10)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/combp2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identification of differentially methylated regions (DMR) — combp2","text":"data data frame bed format file colname name \"V1\",\"V2\", \"V3\",\"V4\",\"V5\",V1 indicate chromosome (1,2,3,...,X,Y), V2 chromosome position, V4 P value V5 name CpGs. dist.cutoff Maximum distance base pair combine adjacent DMRs. bin.size bin size autocorrelation calculation. seed FDR significance threshold initial selection DMR region. nCores Number computer cores used calculation","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/combp2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identification of differentially methylated regions (DMR) — combp2","text":"Results DMRs analysis. result.fdr, table selected AMRs. AMR include chromosomic position, P-value, FDR","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/combp2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Identification of differentially methylated regions (DMR) — combp2","text":"input data frame column name V1-V5, indicating chromosome, start position,end position, pValues probe names. function use modified comb-p method identify differentially methylated regions.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/combp2.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Identification of differentially methylated regions (DMR) — combp2","text":"Basile Jumentier","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/estimate_effect.html","id":null,"dir":"Reference","previous_headings":"","what":"The function hdmax2::estimate_effect() takes as input an object hdmax2_step1 and a list of potential mediators MS to be analyzed in subsequent steps. — estimate_effect","title":"The function hdmax2::estimate_effect() takes as input an object hdmax2_step1 and a list of potential mediators MS to be analyzed in subsequent steps. — estimate_effect","text":"univariate exposure variable subset mediators MS, hdmax2::estimate_effect() function computes several estimates evaluate indirect effects path exposure variables outcome variable. Initially, function assesses mediator variable MS_j individually computes causal measures interest () Average Causal Mediated Effect (ACME, corresponding indirect effect) (ii) Proportion Mediated (PM). ACME differs Average Direct Effect (ADE), represents unmediated effect, Total Effect (TE) equal sum direct indirect effect. PM corresponds proportion total effect mediated mediator (ratio indirect effect total effect). ACME PM computed mediation::mediate() function package mediation, automatically detects type statistical model used mediation analysis (Tingley et al. 2014). function mediation::mediate() calculates uncertainty estimates quasi-Bayesian Monte Carlo approach described (Imai et al. 2010). addition, estimates intermediary effect sizes  a_j b_j standard deviations. Eventually, hdmax2 calculates Overall Indirect Effect (OIE) single model includes mediators MS simultaneously. OIE corresponds sum indirect effect associated mediators. confidence interval (CI) OIE estimated bootstrap approach. Along OIE, hdmax2 estimates Overall Total Effect (OTE) corresponding effect exposure variables outcome variable, well Overall Direct Effect (ODE) corresponding effect exposure variables outcome variable mediators MS included model.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/estimate_effect.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The function hdmax2::estimate_effect() takes as input an object hdmax2_step1 and a list of potential mediators MS to be analyzed in subsequent steps. — estimate_effect","text":"","code":"estimate_effect(object, m, boots = 1000, ...)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/estimate_effect.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The function hdmax2::estimate_effect() takes as input an object hdmax2_step1 and a list of potential mediators MS to be analyzed in subsequent steps. — estimate_effect","text":"object results hdmax2 step 2 m response variable matrix n rows p columns corresponding mediators selected step1. Response variables must encoded numeric. NAs allowed. boots number bootstrap ... arguments inner functions","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/estimate_effect.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The function hdmax2::estimate_effect() takes as input an object hdmax2_step1 and a list of potential mediators MS to be analyzed in subsequent steps. — estimate_effect","text":"hdmax2_step2 object ACME, estimation average causal mediation effect (indirect effect) ADE, estimation average direct effect PM, estimation proportion mediated TE, estimation total effect Regressions: xm, regression X M , regression M Y Overall effect oie, overall indirect effect oie_med , oie median oie_sd , oie standard deviation ote, overall total effect ode, overall direct effect","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/estimate_effect.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The function hdmax2::estimate_effect() takes as input an object hdmax2_step1 and a list of potential mediators MS to be analyzed in subsequent steps. — estimate_effect","text":"use mediate function mediation package set markers Q-value lower FDR threshold. estimates indirect effects tests significance.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/estimate_effect.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"The function hdmax2::estimate_effect() takes as input an object hdmax2_step1 and a list of potential mediators MS to be analyzed in subsequent steps. — estimate_effect","text":"Florence Pittion, Magali Richard, Olivier Francois, Basile Jumentier","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/estimate_effect.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The function hdmax2::estimate_effect() takes as input an object hdmax2_step1 and a list of potential mediators MS to be analyzed in subsequent steps. — estimate_effect","text":"","code":"# Load example dataset attach(simu_data) K = 5 # Run {hdmax2} step 1 hdmax2_step1 = hdmax2::run_AS(   exposure = simu_data$X_binary,   outcome =  simu_data$Y_continuous,   M =  simu_data$M1,   K = K ) #> Running first regression with univariate exposure variable. #> Running second regression. #> Running max-squared test. # Select mediators mediators_subset = names(sort(hdmax2_step1$max2_pvalues)[1:10]) mediators_top10 = simu_data$M1[, mediators_subset] # Run {hdmax2} step 2 hdmax2_step2 = hdmax2::estimate_effect(object = hdmax2_step1,                                         m = mediators_top10) #> Estimating indirect effect for univariate exposome. #> The input exposome is continuous or binary #> Generate regression 1 for continuous or binary exposure and mediator 1 #> Generate regression 2 for continuous outcome and mediator 1 #> Generate regression 1 for continuous or binary exposure and mediator 2 #> Generate regression 2 for continuous outcome and mediator 2 #> Generate regression 1 for continuous or binary exposure and mediator 3 #> Generate regression 2 for continuous outcome and mediator 3 #> Generate regression 1 for continuous or binary exposure and mediator 4 #> Generate regression 2 for continuous outcome and mediator 4 #> Generate regression 1 for continuous or binary exposure and mediator 5 #> Generate regression 2 for continuous outcome and mediator 5 #> Generate regression 1 for continuous or binary exposure and mediator 6 #> Generate regression 2 for continuous outcome and mediator 6 #> Generate regression 1 for continuous or binary exposure and mediator 7 #> Generate regression 2 for continuous outcome and mediator 7 #> Generate regression 1 for continuous or binary exposure and mediator 8 #> Generate regression 2 for continuous outcome and mediator 8 #> Generate regression 1 for continuous or binary exposure and mediator 9 #> Generate regression 2 for continuous outcome and mediator 9 #> Generate regression 1 for continuous or binary exposure and mediator 10 #> Generate regression 2 for continuous outcome and mediator 10 #> Computing ODE and OTE for continuous outcome."},{"path":"https://bcm-uga.github.io/hdmax2/reference/hdmax2_qvalue.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute q-values from p-values — hdmax2_qvalue","title":"Compute q-values from p-values — hdmax2_qvalue","text":"Compute q-values provided p-values Estimate proportion H0 relies defined interquartile range","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/hdmax2_qvalue.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute q-values from p-values — hdmax2_qvalue","text":"","code":"hdmax2_qvalue(pvalues, theta = 0.25)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/hdmax2_qvalue.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute q-values from p-values — hdmax2_qvalue","text":"pvalues result max squared test theta constant defines interquartile range","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/hdmax2_qvalue.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute q-values from p-values — hdmax2_qvalue","text":"qvalues, pi0 =  H0_proportion","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/hdmax2_qvalue.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Compute q-values from p-values — hdmax2_qvalue","text":"Olivier Francois","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/hdmax2_qvalue.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute q-values from p-values — hdmax2_qvalue","text":"","code":"data = hdmax2::simu_data K = 5 hdmax2_step1 = hdmax2::run_AS(exposure = simu_data$X_binary,                               outcome = simu_data$Y_continuous,                               M = simu_data$M1,                                K = K) #> Running first regression with univariate exposure variable. #> Running second regression. #> Running max-squared test.   #Select candidate mediator   qv = hdmax2::hdmax2_qvalue(hdmax2_step1$max2_pvalues)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/helper_ex.html","id":null,"dir":"Reference","previous_headings":"","what":"Dataset for helper function example — helper_ex","title":"Dataset for helper function example — helper_ex","text":"dataset containing blabla","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/helper_ex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dataset for helper function example — helper_ex","text":"","code":"helper_ex  helper_ex"},{"path":"https://bcm-uga.github.io/hdmax2/reference/helper_ex.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Dataset for helper function example — helper_ex","text":"list 5 objects methylationmethylation matrix, 100 individuals 200 probes exposureExposure 100 individuals phenotypeOuctome 100 individuals annotationAnnotation 200 probes covariablesCovariables 100 individuals : sex, bmi, age, treatment ....","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med.html","id":null,"dir":"Reference","previous_headings":"","what":"Fitting Latent Factor Mixed Models (Least squares algorithm) — lfmm2_med","title":"Fitting Latent Factor Mixed Models (Least squares algorithm) — lfmm2_med","text":"Latent Factor Mixed Models (LFMMs) factor regression models. lfmm2 function estimates latent factors based exact least-squares approach.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fitting Latent Factor Mixed Models (Least squares algorithm) — lfmm2_med","text":"","code":"lfmm2_med(input, env, K, lambda = 1e-05, effect.sizes = FALSE)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fitting Latent Factor Mixed Models (Least squares algorithm) — lfmm2_med","text":"input Continuous intermediary variables matrix  encompassing potential mediators n rows p columns. env explanatory variable matrix n rows d columns. K latent factor number lambda ridge penalization parameter effect.sizes true false obtain effect sizes","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fitting Latent Factor Mixed Models (Least squares algorithm) — lfmm2_med","text":"object following attributes U V","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Fitting Latent Factor Mixed Models (Least squares algorithm) — lfmm2_med","text":"Florence Pittion, Magali Richard, Olivier Francois","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fitting Latent Factor Mixed Models (Least squares algorithm) — lfmm2_med","text":"","code":"data(simu_data) K = 5 mod.lfmm1 = lfmm2_med(input = simu_data$M1,  env = simu_data$X_binary,  K = K, effect.sizes = FALSE)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med_test.html","id":null,"dir":"Reference","previous_headings":"","what":"P-values adjusted for latent factors computed by lfmm2 — lfmm2_med_test","title":"P-values adjusted for latent factors computed by lfmm2 — lfmm2_med_test","text":"function returns vector p-values association potential mediators exposure/outcome variables adjusted latent factors computed lfmm2. input, takes object class lfmm2Class data used adjust LFMM. full set FALSE, function computes significance values (p-values) exposure variable, otherwise returns p-values full set exposure variables.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"P-values adjusted for latent factors computed by lfmm2 — lfmm2_med_test","text":"","code":"lfmm2_med_test(   object,   input,   env,   covar,   full = FALSE,   genomic.control = TRUE,   linear = TRUE,   family = binomial(link = \"logit\") )"},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"P-values adjusted for latent factors computed by lfmm2 — lfmm2_med_test","text":"object lfmm2Class object input response variable matrix n rows p columns env explanatory variable matrix n rows d columns. covar covariables full compute partial regression FALSE/TRUE genomic.control correct pvalue genomic inflation factor linear true false (else logistic) family logistic reg","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"P-values adjusted for latent factors computed by lfmm2 — lfmm2_med_test","text":"object following attributes P-values, fscores, zscores, adj.squared, gif","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med_test.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"P-values adjusted for latent factors computed by lfmm2 — lfmm2_med_test","text":"Florence Pittion, Magali Richard, Olivier Francois","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med_test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"P-values adjusted for latent factors computed by lfmm2 — lfmm2_med_test","text":"","code":"attach(simu_data) #> The following objects are masked from simu_data (pos = 3): #>  #>     M, M1, M2, X_binary, X_categorial, X_continuous, X_continuous_2, #>     Y_binary, Y_continuous, age, gender K = 5 mod.lfmm1 = lfmm2_med(input = simu_data$M1,  env = simu_data$X_binary,  K = K, effect.sizes = FALSE)  res_reg1 = lfmm2_med_test(mod.lfmm1,  input = simu_data$M1,  env = simu_data$X_binary, covar = cbind(simu_data$age, simu_data$gender), genomic.control = TRUE)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_hdmax2.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary plot for HDMAX2 — plot_hdmax2","title":"Summary plot for HDMAX2 — plot_hdmax2","text":"function draw summary plot hdmax2 method results","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_hdmax2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary plot for HDMAX2 — plot_hdmax2","text":"","code":"plot_hdmax2(object, plot_type = \"all_plot\")"},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_hdmax2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary plot for HDMAX2 — plot_hdmax2","text":"object results hdmax2 step 2 plot_type \"all_plot\" default generate proposed plots , elsewhere choose one individual plot among : \"plot_ACME\", \"plot_Prop_Med\", \"plot_overall_effects\", \"plot_effect_size\"","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_hdmax2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary plot for HDMAX2 — plot_hdmax2","text":"Summary plot ACME, PM, OIE, effects interpretation","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_hdmax2.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Summary plot for HDMAX2 — plot_hdmax2","text":"Florence Pittion, Magali Richard","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_hdmax2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary plot for HDMAX2 — plot_hdmax2","text":"","code":"# Load example dataset simu_data = hdmax2::simu_data K = 5 # Run {hdmax2} step 1 hdmax2_step1 = hdmax2::run_AS(   exposure = simu_data$X_continuous ,   outcome =  simu_data$Y_continuous,   M =  simu_data$M,   K = K ) #> Running first regression with univariate exposure variable. #> Running second regression. #> Running max-squared test. # Select mediators mediators_subset = names(sort(hdmax2_step1$max2_pvalues)[1:10]) mediators_top10 = simu_data$M[, mediators_subset] # Run {hdmax2} step 2 hdmax2_step2 = hdmax2::estimate_effect(object = hdmax2_step1,                                         m = mediators_top10) #> Estimating indirect effect for univariate exposome. #> The input exposome is continuous or binary #> Generate regression 1 for continuous or binary exposure and mediator 1 #> Generate regression 2 for continuous outcome and mediator 1 #> Generate regression 1 for continuous or binary exposure and mediator 2 #> Generate regression 2 for continuous outcome and mediator 2 #> Generate regression 1 for continuous or binary exposure and mediator 3 #> Generate regression 2 for continuous outcome and mediator 3 #> Generate regression 1 for continuous or binary exposure and mediator 4 #> Generate regression 2 for continuous outcome and mediator 4 #> Generate regression 1 for continuous or binary exposure and mediator 5 #> Generate regression 2 for continuous outcome and mediator 5 #> Generate regression 1 for continuous or binary exposure and mediator 6 #> Generate regression 2 for continuous outcome and mediator 6 #> Generate regression 1 for continuous or binary exposure and mediator 7 #> Generate regression 2 for continuous outcome and mediator 7 #> Generate regression 1 for continuous or binary exposure and mediator 8 #> Generate regression 2 for continuous outcome and mediator 8 #> Generate regression 1 for continuous or binary exposure and mediator 9 #> Generate regression 2 for continuous outcome and mediator 9 #> Generate regression 1 for continuous or binary exposure and mediator 10 #> Generate regression 2 for continuous outcome and mediator 10 #> Computing ODE and OTE for continuous outcome. # Generate plot hdmax2::plot_hdmax2(hdmax2_step2, plot_type = \"all_plot\") #> [1] \"hdmax2 plot for univariate exposome\"  #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout]"},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_multivariate.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary plot for multivariate exposure variables — plot_multivariate","title":"Summary plot for multivariate exposure variables — plot_multivariate","text":"function draw summary plot hdmax2 method results","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_multivariate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary plot for multivariate exposure variables — plot_multivariate","text":"","code":"plot_multivariate(object, plot_type = \"all_plot\")"},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_multivariate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary plot for multivariate exposure variables — plot_multivariate","text":"object results hdmax2 step 2 plot_type \"all_plot\" default generate proposed plots , elsewhere choose one individual plot among : \"plot_ACME\", \"plot_Prop_Med\", \"plot_overall_effects\", \"plot_effect_size\"","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_multivariate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary plot for multivariate exposure variables — plot_multivariate","text":"Summary plot ACME, PM, OIE, effects interpretation","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_multivariate.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Summary plot for multivariate exposure variables — plot_multivariate","text":"Florence Pittion, Magali Richard","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_multivariate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary plot for multivariate exposure variables — plot_multivariate","text":"","code":"# Load example dataset simu_data = hdmax2::simu_data exposure = data.frame(X1 = simu_data$X_continuous, X2 = simu_data$X_binary) covar = cbind(simu_data$age, simu_data$gender) covar = as.data.frame(covar) K = 5  hdmax2_step1 = hdmax2::run_AS(exposure = exposure ,                               outcome = simu_data$Y_continuous,                               M = simu_data$M2,                               K = K,                               covar = covar) #> Running first regression with multivariate exposure variables. #> Running second regression. #> Running max-squared test. # Select mediators mediators_subset = names(sort(hdmax2_step1$max2_pvalues)[1:10]) mediators_top10 = simu_data$M2[, mediators_subset] # Run {hdmax2} step 2 hdmax2_step2 = hdmax2::estimate_effect(object = hdmax2_step1,                                         m = mediators_top10) #> Estimating indirect effect for multivariate exposome. #> Column  1  is Continuous or Binary in covariable data frame #> The input exposome is continuous or binary #> Generate regression 1 for continuous or binary exposure and mediator 1 #> Generate regression 2 for continuous outcome and mediator 1 #> Generate regression 1 for continuous or binary exposure and mediator 2 #> Generate regression 2 for continuous outcome and mediator 2 #> Generate regression 1 for continuous or binary exposure and mediator 3 #> Generate regression 2 for continuous outcome and mediator 3 #> Generate regression 1 for continuous or binary exposure and mediator 4 #> Generate regression 2 for continuous outcome and mediator 4 #> Generate regression 1 for continuous or binary exposure and mediator 5 #> Generate regression 2 for continuous outcome and mediator 5 #> Generate regression 1 for continuous or binary exposure and mediator 6 #> Generate regression 2 for continuous outcome and mediator 6 #> Generate regression 1 for continuous or binary exposure and mediator 7 #> Generate regression 2 for continuous outcome and mediator 7 #> Generate regression 1 for continuous or binary exposure and mediator 8 #> Generate regression 2 for continuous outcome and mediator 8 #> Generate regression 1 for continuous or binary exposure and mediator 9 #> Generate regression 2 for continuous outcome and mediator 9 #> Generate regression 1 for continuous or binary exposure and mediator 10 #> Generate regression 2 for continuous outcome and mediator 10 #> Computing ODE and OTE for continuous outcome. #> Estimating indirect effect for multivariate exposome. #> Column  1  is Continuous or Binary in covariable data frame #> The input exposome is continuous or binary #> Generate regression 1 for continuous or binary exposure and mediator 1 #> Generate regression 2 for continuous outcome and mediator 1 #> Generate regression 1 for continuous or binary exposure and mediator 2 #> Generate regression 2 for continuous outcome and mediator 2 #> Generate regression 1 for continuous or binary exposure and mediator 3 #> Generate regression 2 for continuous outcome and mediator 3 #> Generate regression 1 for continuous or binary exposure and mediator 4 #> Generate regression 2 for continuous outcome and mediator 4 #> Generate regression 1 for continuous or binary exposure and mediator 5 #> Generate regression 2 for continuous outcome and mediator 5 #> Generate regression 1 for continuous or binary exposure and mediator 6 #> Generate regression 2 for continuous outcome and mediator 6 #> Generate regression 1 for continuous or binary exposure and mediator 7 #> Generate regression 2 for continuous outcome and mediator 7 #> Generate regression 1 for continuous or binary exposure and mediator 8 #> Generate regression 2 for continuous outcome and mediator 8 #> Generate regression 1 for continuous or binary exposure and mediator 9 #> Generate regression 2 for continuous outcome and mediator 9 #> Generate regression 1 for continuous or binary exposure and mediator 10 #> Generate regression 2 for continuous outcome and mediator 10 #> Computing ODE and OTE for continuous outcome. # Generate plot hdmax2::plot_multivariate(hdmax2_step2,  plot_type= \"all_plot\")   #> $X1 #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] #>  #> $X2 #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] #>"},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary plot for univariate exposure variables — plot_univariate","title":"Summary plot for univariate exposure variables — plot_univariate","text":"function draw summary plot hdmax2 method results","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary plot for univariate exposure variables — plot_univariate","text":"","code":"plot_univariate(object, plot_type = \"all_plot\")"},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary plot for univariate exposure variables — plot_univariate","text":"object results hdmax2 step 2 plot_type \"all_plot\" default generate proposed plots , elsewhere choose one individual plot among : \"plot_ACME\", \"plot_Prop_Med\", \"plot_overall_effects\", \"plot_effect_size\"","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary plot for univariate exposure variables — plot_univariate","text":"Summary plot ACME, PM, OIE, effects interpretation","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Summary plot for univariate exposure variables — plot_univariate","text":"Florence Pittion, Magali Richard","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary plot for univariate exposure variables — plot_univariate","text":"","code":"# Load example dataset simu_data = hdmax2::simu_data K = 5 # Run {hdmax2} step 1 hdmax2_step1 = hdmax2::run_AS(   exposure = simu_data$X_binary,   outcome = simu_data$Y_continuous,   M = simu_data$M1,   K = K ) #> Running first regression with univariate exposure variable. #> Running second regression. #> Running max-squared test. # Select mediators mediators_subset = names(sort(hdmax2_step1$max2_pvalues)[1:10]) mediators_top10 = simu_data$M1[, mediators_subset] # Run {hdmax2} step 2 hdmax2_step2 = hdmax2::estimate_effect(object = hdmax2_step1,                                         m = mediators_top10) #> Estimating indirect effect for univariate exposome. #> The input exposome is continuous or binary #> Generate regression 1 for continuous or binary exposure and mediator 1 #> Generate regression 2 for continuous outcome and mediator 1 #> Generate regression 1 for continuous or binary exposure and mediator 2 #> Generate regression 2 for continuous outcome and mediator 2 #> Generate regression 1 for continuous or binary exposure and mediator 3 #> Generate regression 2 for continuous outcome and mediator 3 #> Generate regression 1 for continuous or binary exposure and mediator 4 #> Generate regression 2 for continuous outcome and mediator 4 #> Generate regression 1 for continuous or binary exposure and mediator 5 #> Generate regression 2 for continuous outcome and mediator 5 #> Generate regression 1 for continuous or binary exposure and mediator 6 #> Generate regression 2 for continuous outcome and mediator 6 #> Generate regression 1 for continuous or binary exposure and mediator 7 #> Generate regression 2 for continuous outcome and mediator 7 #> Generate regression 1 for continuous or binary exposure and mediator 8 #> Generate regression 2 for continuous outcome and mediator 8 #> Generate regression 1 for continuous or binary exposure and mediator 9 #> Generate regression 2 for continuous outcome and mediator 9 #> Generate regression 1 for continuous or binary exposure and mediator 10 #> Generate regression 2 for continuous outcome and mediator 10 #> Computing ODE and OTE for continuous outcome. # Generate plot hdmax2::plot_univariate(hdmax2_step2,  plot_type= \"all_plot\")  #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout]"},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate_cat.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary plot for categorical exposure variables — plot_univariate_cat","title":"Summary plot for categorical exposure variables — plot_univariate_cat","text":"function draw summary plot hdmax2 method results","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate_cat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary plot for categorical exposure variables — plot_univariate_cat","text":"","code":"plot_univariate_cat(object, plot_type = \"all_plot\")"},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate_cat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary plot for categorical exposure variables — plot_univariate_cat","text":"object results hdmax2 step 2 plot_type \"all_plot\" default generate proposed plots , elsewhere choose one individual plot among : \"plot_ACME\", \"plot_Prop_Med\", \"plot_overall_effects\", \"plot_effect_size\"","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate_cat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary plot for categorical exposure variables — plot_univariate_cat","text":"Summary plot ACME, PM, OIE, effects interpretation","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate_cat.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Summary plot for categorical exposure variables — plot_univariate_cat","text":"Florence Pittion, Magali Richard","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate_cat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary plot for categorical exposure variables — plot_univariate_cat","text":"","code":"# Load example dataset simu_data = hdmax2::simu_data K = 5 # Run {hdmax2} step 1 hdmax2_step1 = hdmax2::run_AS(   exposure = simu_data$X_categorial,   outcome = simu_data$Y_continuous,   M = simu_data$M,   K = K ) #> Running first regression with univariate exposure variable. #> Running second regression. #> Running max-squared test. # Select mediators mediators_subset = names(sort(hdmax2_step1$max2_pvalues)[1:10]) mediators_top10 = simu_data$M[, mediators_subset] # Run {hdmax2} step 2 hdmax2_step2 = hdmax2::estimate_effect(object = hdmax2_step1,                                         m = mediators_top10) #> Estimating indirect effect for univariate exposome. #> The input exposome is categorial #> categorial exposome design matrix transformation #> Generate regression 1 for categorial exposure and mediator 1 #> Generate regression 2 for continuous outcome and mediator 1 #> Generate regression 1 for categorial exposure and mediator 2 #> Generate regression 2 for continuous outcome and mediator 2 #> Generate regression 1 for categorial exposure and mediator 3 #> Generate regression 2 for continuous outcome and mediator 3 #> Generate regression 1 for categorial exposure and mediator 4 #> Generate regression 2 for continuous outcome and mediator 4 #> Generate regression 1 for categorial exposure and mediator 5 #> Generate regression 2 for continuous outcome and mediator 5 #> Generate regression 1 for categorial exposure and mediator 6 #> Generate regression 2 for continuous outcome and mediator 6 #> Generate regression 1 for categorial exposure and mediator 7 #> Generate regression 2 for continuous outcome and mediator 7 #> Generate regression 1 for categorial exposure and mediator 8 #> Generate regression 2 for continuous outcome and mediator 8 #> Generate regression 1 for categorial exposure and mediator 9 #> Generate regression 2 for continuous outcome and mediator 9 #> Generate regression 1 for categorial exposure and mediator 10 #> Generate regression 2 for continuous outcome and mediator 10 #> Computing ODE and OTE for continuous outcome. #> Generate regression 1 for categorial exposure and mediator 1 #> Generate regression 2 for continuous outcome and mediator 1 #> Generate regression 1 for categorial exposure and mediator 2 #> Generate regression 2 for continuous outcome and mediator 2 #> Generate regression 1 for categorial exposure and mediator 3 #> Generate regression 2 for continuous outcome and mediator 3 #> Generate regression 1 for categorial exposure and mediator 4 #> Generate regression 2 for continuous outcome and mediator 4 #> Generate regression 1 for categorial exposure and mediator 5 #> Generate regression 2 for continuous outcome and mediator 5 #> Generate regression 1 for categorial exposure and mediator 6 #> Generate regression 2 for continuous outcome and mediator 6 #> Generate regression 1 for categorial exposure and mediator 7 #> Generate regression 2 for continuous outcome and mediator 7 #> Generate regression 1 for categorial exposure and mediator 8 #> Generate regression 2 for continuous outcome and mediator 8 #> Generate regression 1 for categorial exposure and mediator 9 #> Generate regression 2 for continuous outcome and mediator 9 #> Generate regression 1 for categorial exposure and mediator 10 #> Generate regression 2 for continuous outcome and mediator 10 #> Computing ODE and OTE for continuous outcome. #> Generate regression 1 for categorial exposure and mediator 1 #> Generate regression 2 for continuous outcome and mediator 1 #> Generate regression 1 for categorial exposure and mediator 2 #> Generate regression 2 for continuous outcome and mediator 2 #> Generate regression 1 for categorial exposure and mediator 3 #> Generate regression 2 for continuous outcome and mediator 3 #> Generate regression 1 for categorial exposure and mediator 4 #> Generate regression 2 for continuous outcome and mediator 4 #> Generate regression 1 for categorial exposure and mediator 5 #> Generate regression 2 for continuous outcome and mediator 5 #> Generate regression 1 for categorial exposure and mediator 6 #> Generate regression 2 for continuous outcome and mediator 6 #> Generate regression 1 for categorial exposure and mediator 7 #> Generate regression 2 for continuous outcome and mediator 7 #> Generate regression 1 for categorial exposure and mediator 8 #> Generate regression 2 for continuous outcome and mediator 8 #> Generate regression 1 for categorial exposure and mediator 9 #> Generate regression 2 for continuous outcome and mediator 9 #> Generate regression 1 for categorial exposure and mediator 10 #> Generate regression 2 for continuous outcome and mediator 10 #> Computing ODE and OTE for continuous outcome. # Generate plot hdmax2::plot_univariate_cat(hdmax2_step2,  plot_type= \"all_plot\")    #> [[1]] #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] #>  #> [[2]] #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] #>  #> [[3]] #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] #>"},{"path":"https://bcm-uga.github.io/hdmax2/reference/run_AS.html","id":null,"dir":"Reference","previous_headings":"","what":"The function hdmax2::run_AS() evaluates the association between exposure variables, intermediary variables and the outcome variable using a latent factor mixed model (LFMM Caye et al. 2019) to estimate K unobserved latent factors U. — run_AS","title":"The function hdmax2::run_AS() evaluates the association between exposure variables, intermediary variables and the outcome variable using a latent factor mixed model (LFMM Caye et al. 2019) to estimate K unobserved latent factors U. — run_AS","text":"function run_AS() evaluates association exposure variables X , intermediary variables M outcome variable Y, using latent factor mixed model (LFMM Caye et al. 2019) estimate K unobserved latent factors  U. First function tests significance association exposure variables potential mediator variables. tests association potential mediator variables outcome variable. Finally evaluates significance indirect effects computing squared maximum two series P-values max2 test. rejects null-hypothesis either effect X M, effect M Y null. Optional covariates Z, can included observed adjustment factors model.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/run_AS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The function hdmax2::run_AS() evaluates the association between exposure variables, intermediary variables and the outcome variable using a latent factor mixed model (LFMM Caye et al. 2019) to estimate K unobserved latent factors U. — run_AS","text":"","code":"run_AS(   exposure,   outcome,   M,   K,   covar = NULL,   suppl_covar = NULL,   each_var_pval = FALSE )"},{"path":"https://bcm-uga.github.io/hdmax2/reference/run_AS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The function hdmax2::run_AS() evaluates the association between exposure variables, intermediary variables and the outcome variable using a latent factor mixed model (LFMM Caye et al. 2019) to estimate K unobserved latent factors U. — run_AS","text":"exposure explanatory variable data frame n rows d columns. column corresponds distinct explanatory variable (exposure). Continuous binary variables must encoded numeric format. categorical variables factor objects. user can use .factor function encode categorical variables,  levels() ordered() functions define modal order categorical variables. outcome explanatory variable matrix n rows 1 columns, corresponds vector, supports continuous binary formats. M Continuous intermediary variables matrix  encompassing potential mediators n rows p columns. Must encoded numeric. NAs allowed. K integer number latent factors regression model. covar set adjustment factors, must numeric. NAs allowed suppl_covar possible supplementary adjustment factors second association study (must nested within first set adjustment factors ) each_var_pval logical indicate p-values must estimated exposure variables (each_var_pval = TRUE) addition pvalue global model (each_var_pval = FALSE, default) Useful visually check fit estimated proportion null p-values.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/run_AS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The function hdmax2::run_AS() evaluates the association between exposure variables, intermediary variables and the outcome variable using a latent factor mixed model (LFMM Caye et al. 2019) to estimate K unobserved latent factors U. — run_AS","text":"object following attributes first association study (mod1): pValue, estimation effects exposure X outcome matrix M. U, scores matrix K latent factors computed first regression zscore, score matrix exposure X outcome Y. fscore, score matrix exposure X outcome Y. adj_rsquared gif, Genomic inflation factor X Y, expressing deviation distribution observed test statistic compared distribution expected test statistic second association study (mod2): pValue, zscore, fscore,  adj_rsquared, gif results max2 test: pval, results max2 test input element: exposition , outcome covariates","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/run_AS.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The function hdmax2::run_AS() evaluates the association between exposure variables, intermediary variables and the outcome variable using a latent factor mixed model (LFMM Caye et al. 2019) to estimate K unobserved latent factors U. — run_AS","text":"argument, missing values must imputed: NA allowed. K (number latent factors) can estimated eigenvalues PCA. Max2 test P-value computed markers following formula $$pV = max(pVal1, pVal2)^2$$","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/run_AS.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"The function hdmax2::run_AS() evaluates the association between exposure variables, intermediary variables and the outcome variable using a latent factor mixed model (LFMM Caye et al. 2019) to estimate K unobserved latent factors U. — run_AS","text":"Florence Pittion, Magali Richard, Olivier Francois, Basile Jumentier","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/run_AS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The function hdmax2::run_AS() evaluates the association between exposure variables, intermediary variables and the outcome variable using a latent factor mixed model (LFMM Caye et al. 2019) to estimate K unobserved latent factors U. — run_AS","text":"","code":"# Load example dataset attach(simu_data) #> The following objects are masked from simu_data (pos = 3): #>  #>     M, M1, M2, X_binary, X_categorial, X_continuous, X_continuous_2, #>     Y_binary, Y_continuous, age, gender #> The following objects are masked from simu_data (pos = 4): #>  #>     M, M1, M2, X_binary, X_categorial, X_continuous, X_continuous_2, #>     Y_binary, Y_continuous, age, gender  K = 5 # Run {hdmax2} step 1 hdmax2_step1 = run_AS(exposure = simu_data$X_continuous ,                       outcome = simu_data$Y_continuous,                       M = simu_data$M1,                       K = K) #> Running first regression with univariate exposure variable. #> Running second regression. #> Running max-squared test.  head(hdmax2_step1$max2_pvalues) #> cg00005740 cg00006787 cg00007032 cg00008612 cg00009871 cg00009922  #> 0.47695977 0.50457875 0.68833562 0.01359132 0.44231790 0.66302923"},{"path":"https://bcm-uga.github.io/hdmax2/reference/simu_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Dataset for example — simu_data","title":"Dataset for example — simu_data","text":"dataset containing blabla. variables follows:","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/simu_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dataset for example — simu_data","text":"","code":"simu_data  simu_data"},{"path":"https://bcm-uga.github.io/hdmax2/reference/simu_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Dataset for example — simu_data","text":"list  objects M methylation matrix, 100 samples 200 potential mediators M1 methylation matrix, 100 samples 200 potential mediators M2 methylation matrix, 100 samples 200 potential mediators X_continuous Continuous Exposure 100 samples X_continuous2 Continuous Exposure 100 samples X_binary Binary Exposure 100 samples X_categorial Categorial Exposure 100 samples Y_continuous Continuous Outcome 100 samples Y_binary Binary Outcome 100 samples age age covariable gender gender covariable list ... ... rows ... variables","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/simu_data.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Dataset for example — simu_data","text":"X_continuous X_binary, blabla blabla","code":""}]
