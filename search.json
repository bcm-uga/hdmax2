[{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_multivariate.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"hdmax2 application for multivariate exposome","text":"hdmax2 package designed accept exposure \\(X\\) consisting univariate data, can continuous, binary, well multivariate exposomes (includes categorical variables). vignette, treat two example multivariate exposomes: first example, categorial explanatory variables second example two continuous variables exposure install latest version hdmax2, use github repository","code":"#devtools::install_github(\"bcm-uga/hdmax2\")"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_multivariate.html","id":"simulated-dataset","dir":"Articles","previous_headings":"","what":"Simulated dataset","title":"hdmax2 application for multivariate exposome","text":"simulated 100 samples 500 potential mediators, various type exposures (continuous, binary categorial) outcomes(continuous binary). two example use continuous outcome two covariates (age gender). define K number estimeted latent factors PCA elbow procedure apply screeplot.","code":"simu_data = hdmax2::simu_data  ## Outcomes Y_matrix = simu_data$Y_continuous  ## High dimension mediators M_matrix = simu_data$M  ## Covariates age = simu_data$age gender = simu_data$gender ## Number of Latent factor estimation  pc <- prcomp(M_matrix) plot(pc$sdev^2/sum(pc$sdev)[1:10],      xlab = 'Principal Component',      ylab = \"Explained variance\") K=5 #pca conclusion : it is better to select too many factors that too few"},{"path":[]},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_multivariate.html","id":"step-1-run-association-studies","dir":"Articles","previous_headings":"First use case categorial exposure and continuous outcome","what":"STEP 1: Run association studies","title":"hdmax2 application for multivariate exposome","text":"run_AS function applied estimate effects exposure \\(X\\) matrix \\(M\\) potential mediators, effect potential mediators outcome \\(Y\\). Covariables can included , example decided include two covariates defined . Exposure categorial , example kept vector character type transformed factor inside function, users can apply transformation factor needed (order categories).","code":"## Exposures is categorial, character vector X_matrix = simu_data$X_categorial   detailed = FALSE covar = cbind(age, gender)  hdmax2_step1 = hdmax2::run_AS(X = X_matrix,                               Y = Y_matrix,                               M = M_matrix,                               K = K,                               detailed = detailed,  # indicates the exposure is multivariate                               covar = covar) #> [1] \"The exposure argument is a vector.\" #> [1] \"The outcome argument is a vector.\" #> [1] \"The outcome argument is numeric\" #> [1] \"Potential mediators matrix is actually a matrix\" #> [1] \"provided K = 5\" #> [1] \"K value has been transformed as integer\" #> [1] \"The input exposome is categorial\" #> [1] \"The outcome vector is numeric and DON'T contains only 0s and 1s, it is assimilated as continous variable.\" #> [1] \"Running first regression with univariate explanatory variable.\" #> [1] \"Running second regression.\" #> [1] \"Running max-squared test.\" #> [1] \"Not generating max2 pvalues for each explanatory variable.\"    # # max2 test results head(hdmax2_step1$max2_pvalues) #> cg00005740 cg00006787 cg00007032 cg00008612 cg00009871 cg00009922  #> 0.82893397 0.50640597 0.29700712 0.14826915 0.04588014 0.25074249"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_multivariate.html","id":"selection-of-a-subset-of-mediators","dir":"Articles","previous_headings":"First use case categorial exposure and continuous outcome","what":"Selection of a subset of mediators","title":"hdmax2 application for multivariate exposome","text":"Step 1 provides object contains results two regression (pvalues, fscores, zscores), latent factor estimation first regression, function inputs, important max-squared test pvalues results. last result allow select mediators user’s choosen method. example selected top ten significant pvalues max-squared test.","code":"## Selecting top 10 mediators mediators_top10 = M_matrix[,names(sort(hdmax2_step1$max2_pvalues)[1:10])] head(mediators_top10) #>            cg00252121 cg00691940 cg00059662 cg00098070 cg00513564 cg00014667 #> GSM1051525  0.5620420  0.9064152  0.7545270  0.8573723  0.7201085  0.7992167 #> GSM1051526  0.6064044  0.9188040  0.8121716  0.8703182  0.7281696  0.8012565 #> GSM1051527  0.6017017  0.9024226  0.7836924  0.8830974  0.6729922  0.7892398 #> GSM1051528  0.5274345  0.9058532  0.7707619  0.8851317  0.6729783  0.8031898 #> GSM1051529  0.5988807  0.8880237  0.7623236  0.8968052  0.7004180  0.8005460 #> GSM1051530  0.5487950  0.9401958  0.8106844  0.8746982  0.7261984  0.8190546 #>            cg00887508 cg00897799 cg00804468 cg00947032 #> GSM1051525  0.7019675  0.8750781  0.7683129  0.1816857 #> GSM1051526  0.7144023  0.8886705  0.7551020  0.1530785 #> GSM1051527  0.7498290  0.8661710  0.7293058  0.1182946 #> GSM1051528  0.7390065  0.9447288  0.7423337  0.1412759 #> GSM1051529  0.7254738  0.8864371  0.7724008  0.1290809 #> GSM1051530  0.7491193  0.8775554  0.8422745  0.1373850"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_multivariate.html","id":"step-2-estimation-of-the-indirect-effect","dir":"Articles","previous_headings":"First use case categorial exposure and continuous outcome","what":"STEP 2 : estimation of the indirect effect","title":"hdmax2 application for multivariate exposome","text":"function estimate_effect estimate individual indirect effect mediators also overall effects selected mediators..","code":"object = hdmax2_step1 m = mediators_top10 hdmax2_step2 = hdmax2::estimate_effect(object = object,                                        m = m) #> [1] \"Estimating indirect effect for univariate exposome.\" #> [1] \"The input exposome is categorial\" #> [1] \"categorial exposome design matrix transformation\" #> [1] \"Generate regression 1 for categorial exposure and mediator 1\" #> [1] \"Generate regression 2 for continuous outcome and mediator 1\" #> [1] \"Generate regression 1 for categorial exposure and mediator 2\" #> [1] \"Generate regression 2 for continuous outcome and mediator 2\" #> [1] \"Generate regression 1 for categorial exposure and mediator 3\" #> [1] \"Generate regression 2 for continuous outcome and mediator 3\" #> [1] \"Generate regression 1 for categorial exposure and mediator 4\" #> [1] \"Generate regression 2 for continuous outcome and mediator 4\" #> [1] \"Generate regression 1 for categorial exposure and mediator 5\" #> [1] \"Generate regression 2 for continuous outcome and mediator 5\" #> [1] \"Generate regression 1 for categorial exposure and mediator 6\" #> [1] \"Generate regression 2 for continuous outcome and mediator 6\" #> [1] \"Generate regression 1 for categorial exposure and mediator 7\" #> [1] \"Generate regression 2 for continuous outcome and mediator 7\" #> [1] \"Generate regression 1 for categorial exposure and mediator 8\" #> [1] \"Generate regression 2 for continuous outcome and mediator 8\" #> [1] \"Generate regression 1 for categorial exposure and mediator 9\" #> [1] \"Generate regression 2 for continuous outcome and mediator 9\" #> [1] \"Generate regression 1 for categorial exposure and mediator 10\" #> [1] \"Generate regression 2 for continuous outcome and mediator 10\" #> [1] \"Computing ODE and OTE for continuous outcome.\" #> [1] \"Generate regression 1 for categorial exposure and mediator 1\" #> [1] \"Generate regression 2 for continuous outcome and mediator 1\" #> [1] \"Generate regression 1 for categorial exposure and mediator 2\" #> [1] \"Generate regression 2 for continuous outcome and mediator 2\" #> [1] \"Generate regression 1 for categorial exposure and mediator 3\" #> [1] \"Generate regression 2 for continuous outcome and mediator 3\" #> [1] \"Generate regression 1 for categorial exposure and mediator 4\" #> [1] \"Generate regression 2 for continuous outcome and mediator 4\" #> [1] \"Generate regression 1 for categorial exposure and mediator 5\" #> [1] \"Generate regression 2 for continuous outcome and mediator 5\" #> [1] \"Generate regression 1 for categorial exposure and mediator 6\" #> [1] \"Generate regression 2 for continuous outcome and mediator 6\" #> [1] \"Generate regression 1 for categorial exposure and mediator 7\" #> [1] \"Generate regression 2 for continuous outcome and mediator 7\" #> [1] \"Generate regression 1 for categorial exposure and mediator 8\" #> [1] \"Generate regression 2 for continuous outcome and mediator 8\" #> [1] \"Generate regression 1 for categorial exposure and mediator 9\" #> [1] \"Generate regression 2 for continuous outcome and mediator 9\" #> [1] \"Generate regression 1 for categorial exposure and mediator 10\" #> [1] \"Generate regression 2 for continuous outcome and mediator 10\" #> [1] \"Computing ODE and OTE for continuous outcome.\" #> [1] \"Generate regression 1 for categorial exposure and mediator 1\" #> [1] \"Generate regression 2 for continuous outcome and mediator 1\" #> [1] \"Generate regression 1 for categorial exposure and mediator 2\" #> [1] \"Generate regression 2 for continuous outcome and mediator 2\" #> [1] \"Generate regression 1 for categorial exposure and mediator 3\" #> [1] \"Generate regression 2 for continuous outcome and mediator 3\" #> [1] \"Generate regression 1 for categorial exposure and mediator 4\" #> [1] \"Generate regression 2 for continuous outcome and mediator 4\" #> [1] \"Generate regression 1 for categorial exposure and mediator 5\" #> [1] \"Generate regression 2 for continuous outcome and mediator 5\" #> [1] \"Generate regression 1 for categorial exposure and mediator 6\" #> [1] \"Generate regression 2 for continuous outcome and mediator 6\" #> [1] \"Generate regression 1 for categorial exposure and mediator 7\" #> [1] \"Generate regression 2 for continuous outcome and mediator 7\" #> [1] \"Generate regression 1 for categorial exposure and mediator 8\" #> [1] \"Generate regression 2 for continuous outcome and mediator 8\" #> [1] \"Generate regression 1 for categorial exposure and mediator 9\" #> [1] \"Generate regression 2 for continuous outcome and mediator 9\" #> [1] \"Generate regression 1 for categorial exposure and mediator 10\" #> [1] \"Generate regression 2 for continuous outcome and mediator 10\" #> [1] \"Computing ODE and OTE for continuous outcome.\""},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_multivariate.html","id":"plot","dir":"Articles","previous_headings":"First use case categorial exposure and continuous outcome","what":"Plot","title":"hdmax2 application for multivariate exposome","text":"propose set plots include: Forest plot mediators ACME Forest plot mediators PM Comparison ODE, OIE OTE Mediators effect size representation  obtained three set, category categorial exposure (minus reference category), 4 plots: Estimates indirect effect (ACME) B proportions mediated effect (PM) top 10 mediators. effect estimate represented dot 95% CI bar. Symbols correspond significance cut 5% (square p-value \\(\\geq 0.05\\), circle p-value \\(< 0.05\\)). Colors correspond sign effect (green estimated effect \\(\\leq 0\\) , red estimated effect \\(> 0\\)). C Effect sizes Overall Direct Effect (ODE), Overall Indirect Effect (OIE) Overall Total Effect (OTE). Error bars correspond standard deviation (ODE OTE) confidence interval (OIE). D Indirect effect sizes selected mediators. Black corresponds ACME, violet effect exposure X mediator M model \\(X \\sim M\\), blue corresponds effect mediator M outcome Y model \\(Y \\sim M + X\\).","code":"library(ggplot2) hdmax2::plot_hdmax2(hdmax2_step2) #> [1] \"hdmax2 plot for univariate categorial exposome\" #> [[1]] #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] #>  #> [[2]] #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] #>  #> [[3]] #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout]"},{"path":[]},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_multivariate.html","id":"step-1-run-association-studies-1","dir":"Articles","previous_headings":"Second use case multivariate exposure and continuous outcome","what":"STEP 1: Run association studies","title":"hdmax2 application for multivariate exposome","text":"run_AS function applied estimate effects exposure \\(X\\) matrix \\(M\\) potential mediators, effect potential mediators outcome \\(Y\\). Covariables can included.","code":"## multivariate Exposures (continuous + binary) X_matrix = data.frame(X1 = simu_data$X_continuous, X2 = simu_data$X_binary) detailed = FALSE covar = cbind(age, gender)  hdmax2_step1 = hdmax2::run_AS(X = X_matrix ,                               Y = Y_matrix,                               M = M_matrix,                               K = K,                               detailed = detailed,  # indicates the exposure is multivariate                               covar = covar) #> [1] \"The exposure argument is a data frame\" #> [1] \"The exposure argument is a data frame with more than one column.\" #> [1] \"The outcome argument is a vector.\" #> [1] \"The outcome argument is numeric\" #> [1] \"Potential mediators matrix is actually a matrix\" #> [1] \"provided K = 5\" #> [1] \"K value has been transformed as integer\" #> [1] \"The input exposome no  1 is continuous or binary\" #> [1] \"The input exposome no  2 is continuous or binary\" #> [1] \"The outcome vector is numeric and DON'T contains only 0s and 1s, it is assimilated as continous variable.\" #> [1] \"Running first regression with multivariate explanatory variables.\" #> [1] \"Running second regression.\" #> [1] \"Running max-squared test.\" #> [1] \"Not generating max2 pvalues for each explanatory variable.\"  # # max2 test results head(hdmax2_step1$max2_pvalues) #>   cg00005740   cg00006787   cg00007032   cg00008612   cg00009871   cg00009922  #> 0.8913217179 0.0009502066 0.5330831116 0.1354334088 0.0277864018 0.1189691936"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_multivariate.html","id":"selection-of-a-subset-of-mediators-1","dir":"Articles","previous_headings":"Second use case multivariate exposure and continuous outcome","what":"Selection of a subset of mediators","title":"hdmax2 application for multivariate exposome","text":"example, consider 10 first selected mediators.","code":"## Selecting top 10 mediators mediators_top10 = M_matrix[,names(sort(hdmax2_step1$max2_pvalues)[1:10])] head(mediators_top10) #>            cg00053507 cg00893424 cg00525681 cg00268831 cg00571178 cg00760872 #> GSM1051525 0.11462689  0.8074170  0.5209005  0.7346605  0.8717074  0.3227306 #> GSM1051526 0.10378216  0.8748504  0.4523429  0.7512120  0.8665613  0.3210372 #> GSM1051527 0.11544693  0.8414972  0.5276243  0.7924549  0.8635078  0.2049477 #> GSM1051528 0.10025345  0.8452302  0.5465737  0.7556221  0.8913680  0.2997467 #> GSM1051529 0.09323191  0.7807442  0.5868464  0.7436953  0.8370478  0.3456068 #> GSM1051530 0.10028912  0.8400227  0.6374064  0.8478274  0.8124240  0.2390846 #>            cg00006787  cg00671161 cg00861695 cg00822277 #> GSM1051525  0.7611450 0.009053900  0.8430159  0.9110697 #> GSM1051526  0.7439679 0.010239081  0.7835410  0.8732949 #> GSM1051527  0.7724723 0.009787643  0.7480722  0.8942126 #> GSM1051528  0.7359192 0.008753840  0.7837780  0.9019002 #> GSM1051529  0.7725952 0.010138064  0.7832606  0.9057895 #> GSM1051530  0.8459956 0.011262872  0.8759320  0.9437861"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_multivariate.html","id":"step-2-estimation-of-the-indirect-effect-1","dir":"Articles","previous_headings":"Second use case multivariate exposure and continuous outcome","what":"STEP 2 : estimation of the indirect effect","title":"hdmax2 application for multivariate exposome","text":"function estimate_effect estimate individual indirect effect mediators.","code":"object = hdmax2_step1 m = mediators_top10 hdmax2_step2 = hdmax2::estimate_effect(object = hdmax2_step1,                                        m = mediators_top10) #> [1] \"Estimating indirect effect for multivariate exposome.\" #> [1] \"Column  1  is Continuous or Binary in covariable data frame\" #> [1] \"The input exposome is continuous or binary\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 1\" #> [1] \"Generate regression 2 for continuous outcome and mediator 1\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 2\" #> [1] \"Generate regression 2 for continuous outcome and mediator 2\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 3\" #> [1] \"Generate regression 2 for continuous outcome and mediator 3\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 4\" #> [1] \"Generate regression 2 for continuous outcome and mediator 4\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 5\" #> [1] \"Generate regression 2 for continuous outcome and mediator 5\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 6\" #> [1] \"Generate regression 2 for continuous outcome and mediator 6\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 7\" #> [1] \"Generate regression 2 for continuous outcome and mediator 7\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 8\" #> [1] \"Generate regression 2 for continuous outcome and mediator 8\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 9\" #> [1] \"Generate regression 2 for continuous outcome and mediator 9\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 10\" #> [1] \"Generate regression 2 for continuous outcome and mediator 10\" #> [1] \"Computing ODE and OTE for continuous outcome.\" #> [1] \"Estimating indirect effect for multivariate exposome.\" #> [1] \"Column  1  is Continuous or Binary in covariable data frame\" #> [1] \"The input exposome is continuous or binary\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 1\" #> [1] \"Generate regression 2 for continuous outcome and mediator 1\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 2\" #> [1] \"Generate regression 2 for continuous outcome and mediator 2\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 3\" #> [1] \"Generate regression 2 for continuous outcome and mediator 3\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 4\" #> [1] \"Generate regression 2 for continuous outcome and mediator 4\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 5\" #> [1] \"Generate regression 2 for continuous outcome and mediator 5\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 6\" #> [1] \"Generate regression 2 for continuous outcome and mediator 6\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 7\" #> [1] \"Generate regression 2 for continuous outcome and mediator 7\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 8\" #> [1] \"Generate regression 2 for continuous outcome and mediator 8\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 9\" #> [1] \"Generate regression 2 for continuous outcome and mediator 9\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 10\" #> [1] \"Generate regression 2 for continuous outcome and mediator 10\" #> [1] \"Computing ODE and OTE for continuous outcome.\""},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_multivariate.html","id":"plot-1","dir":"Articles","previous_headings":"Second use case multivariate exposure and continuous outcome","what":"Plot","title":"hdmax2 application for multivariate exposome","text":"propose set plots include: Forest plot mediators ACME Forest plot mediators PM Comparison ODE, OIE OTE Mediators effect size representation  obtained two set, variables multivariate exposure, 4 plots: Estimates indirect effect (ACME) B proportions mediated effect (PM) top 10 mediators. effect estimate represented dot 95% CI bar. Symbols correspond significance cut 5% (square p-value \\(\\geq 0.05\\), circle p-value \\(< 0.05\\)). Colors correspond sign effect (green estimated effect \\(\\leq 0\\) , red estimated effect \\(> 0\\)). C Effect sizes Overall Direct Effect (ODE), Overall Indirect Effect (OIE) Overall Total Effect (OTE). Error bars correspond standard deviation (ODE OTE) confidence interval (OIE). D Indirect effect sizes selected mediators. Black corresponds ACME, violet effect exposure X mediator M model \\(X \\sim M\\), blue corresponds effect mediator M outcome Y model \\(Y \\sim M + X\\).","code":"library(ggplot2) hdmax2::plot_hdmax2(hdmax2_step2) #> [1] \"hdmax2 plot for multivariate exposome\" #> $X1 #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] #>  #> $X2 #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] sessionInfo() #> R version 4.3.3 (2024-02-29) #> Platform: x86_64-pc-linux-gnu (64-bit) #> Running under: Ubuntu 22.04.4 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] ggplot2_3.5.0 #>  #> loaded via a namespace (and not attached): #>  [1] gtable_0.3.4      xfun_0.42         bslib_0.6.1       htmlwidgets_1.6.4 #>  [5] lattice_0.22-5    vctrs_0.6.5       tools_4.3.3       generics_0.1.3    #>  [9] sandwich_3.1-0    tibble_3.2.1      fansi_1.0.6       highr_0.10        #> [13] cluster_2.1.6     pkgconfig_2.0.3   Matrix_1.6-5      data.table_1.15.2 #> [17] checkmate_2.3.1   desc_1.4.3        lifecycle_1.0.4   farver_2.1.1      #> [21] compiler_4.3.3    stringr_1.5.1     hdmax2_2.0.0.9000 textshaping_0.3.7 #> [25] prettydoc_0.4.1   munsell_0.5.0     mediation_4.5.0   htmltools_0.5.7   #> [29] sass_0.4.9        yaml_2.3.8        htmlTable_2.4.2   Formula_1.2-5     #> [33] pillar_1.9.0      pkgdown_2.0.7     nloptr_2.0.3      jquerylib_0.1.4   #> [37] MASS_7.3-60.0.1   cachem_1.0.8      Hmisc_5.1-2       rpart_4.1.23      #> [41] boot_1.3-29       nlme_3.1-164      tidyselect_1.2.1  digest_0.6.35     #> [45] mvtnorm_1.2-4     stringi_1.8.3     dplyr_1.1.4       purrr_1.0.2       #> [49] labeling_0.4.3    splines_4.3.3     fastmap_1.1.1     grid_4.3.3        #> [53] colorspace_2.1-0  cli_3.6.2         magrittr_2.0.3    base64enc_0.1-3   #> [57] utf8_1.2.4        withr_3.0.0       foreign_0.8-86    scales_1.3.0      #> [61] backports_1.4.1   rmarkdown_2.26    nnet_7.3-19       lme4_1.1-35.1     #> [65] gridExtra_2.3     zoo_1.8-12        ragg_1.3.0        memoise_2.0.1     #> [69] evaluate_0.23     lpSolve_5.6.20    knitr_1.45        rlang_1.1.3       #> [73] Rcpp_1.0.12       glue_1.7.0        rstudioapi_0.15.0 minqa_1.2.6       #> [77] jsonlite_1.8.8    R6_2.5.1          systemfonts_1.0.6 fs_1.6.3"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_univariate.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"hdmax2 application for univariate exposome","text":"{} package designed accept exposure \\(X\\) consisting univariate data, can continuous, binary, well multivariate exposomes (includes categorical variables). vignette, treat univariate example. install latest version hdmax2, use github repository","code":"#devtools::install_github(\"bcm-uga/hdmax2\")"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_univariate.html","id":"simulated-dataset","dir":"Articles","previous_headings":"","what":"Simulated dataset","title":"hdmax2 application for univariate exposome","text":"simulated 100 samples 500 potential mediators, various type exposures (continuous binary) outcomes (continuous binary). example use binary exposure, continuous outcome two covariates (age gender). define K number estimeted latent factors PCA elbow procedure apply screeplot.","code":"simu_data = hdmax2::simu_data  ## High dimension mediators M_matrix = simu_data$M  ## Exposures X_matrix = simu_data$X_binary  ## Outcomes Y_matrix = simu_data$Y_continuous   ## Covariates age = simu_data$age gender = simu_data$gender covar = cbind(age, gender) ## Number of Latent factore estimation pc <- prcomp(M_matrix) plot((pc$sdev^2/sum(pc$sdev))[1:10],      type = \"b\",      xlab = 'Principal Component',      ylab = \"Explained variance\") K=5 #pca conclusion : it is better to select too many factors that too few"},{"path":[]},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_univariate.html","id":"step-1-run-association-studies","dir":"Articles","previous_headings":"First use case binary exposure and continuous outcome","what":"STEP 1: Run association studies","title":"hdmax2 application for univariate exposome","text":"run_AS function applied estimate effects exposure \\(X\\) matrix \\(M\\) potential mediators, effect potential mediators outcome \\(Y\\). Covariables can included.","code":"hdmax2_step1 = hdmax2::run_AS(X = X_matrix ,                 Y = Y_matrix,                  M = M_matrix,                   K = K,                  covar = covar) #> [1] \"The exposure argument is a vector.\" #> [1] \"The outcome argument is a vector.\" #> [1] \"The outcome argument is numeric\" #> [1] \"Potential mediators matrix is actually a matrix\" #> [1] \"provided K = 5\" #> [1] \"K value has been transformed as integer\" #> [1] \"The input exposome is continuous or binary\" #> [1] \"The outcome vector is numeric and DON'T contains only 0s and 1s, it is assimilated as continous variable.\" #> [1] \"Running first regression with univariate explanatory variable.\" #> [1] \"Running second regression.\" #> [1] \"Running max-squared test.\" #> [1] \"Not generating max2 pvalues for each explanatory variable.\""},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_univariate.html","id":"selection-of-a-subset-of-mediators","dir":"Articles","previous_headings":"First use case binary exposure and continuous outcome","what":"Selection of a subset of mediators","title":"hdmax2 application for univariate exposome","text":"Step 1 provides object contains results two regression (pvalues, fscores, zscores), latent factor estimation first regression, function inputs, important max-squared test pvalues results. last result allow select mediators user’s choosen method. example selected top ten significant pvalues max-squared test.","code":"## Selecting top 10 mediators ## top 10 selecting mediators mediators_top10 = M_matrix[,names(sort(hdmax2_step1$max2_pvalues)[1:10])] head(mediators_top10) #>            cg00401429 cg00025981 cg00827893 cg00275626 cg00381829 cg00373763 #> GSM1051525  0.7951180 0.05260918  0.7893376  0.8825254  0.8600816  0.7179983 #> GSM1051526  0.9063903 0.04054604  0.8024538  0.8929263  0.8951136  0.7129662 #> GSM1051527  0.8334925 0.05176339  0.8211777  0.8881366  0.8925196  0.7030927 #> GSM1051528  0.8725825 0.05689405  0.8078479  0.8740031  0.9029140  0.7402126 #> GSM1051529  0.8400158 0.05310491  0.8118859  0.8851656  0.8902038  0.7365306 #> GSM1051530  0.8880954 0.02300723  0.8532763  0.8975370  0.8936008  0.7475968 #>            cg00859193 cg00598009 cg00520188 cg00006787 #> GSM1051525 0.05687721  0.7906143  0.6668338  0.7611450 #> GSM1051526 0.06305496  0.7852755  0.5652531  0.7439679 #> GSM1051527 0.06095380  0.7729195  0.6743901  0.7724723 #> GSM1051528 0.05349454  0.7429481  0.6778167  0.7359192 #> GSM1051529 0.06107702  0.7201939  0.6794481  0.7725952 #> GSM1051530 0.03154556  0.8882096  0.6829760  0.8459956"},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_univariate.html","id":"step-2","dir":"Articles","previous_headings":"First use case binary exposure and continuous outcome","what":"STEP 2","title":"hdmax2 application for univariate exposome","text":"function estimate_effect estimate individual indirect effect mediators, also overall effects selected mediators.","code":"object = hdmax2_step1 m = mediators_top10  hdmax2_step2 = hdmax2::estimate_effect(object = object,                                     m = m) #> [1] \"Estimating indirect effect for univariate exposome.\" #> [1] \"The input exposome is continuous or binary\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 1\" #> [1] \"Generate regression 2 for continuous outcome and mediator 1\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 2\" #> [1] \"Generate regression 2 for continuous outcome and mediator 2\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 3\" #> [1] \"Generate regression 2 for continuous outcome and mediator 3\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 4\" #> [1] \"Generate regression 2 for continuous outcome and mediator 4\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 5\" #> [1] \"Generate regression 2 for continuous outcome and mediator 5\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 6\" #> [1] \"Generate regression 2 for continuous outcome and mediator 6\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 7\" #> [1] \"Generate regression 2 for continuous outcome and mediator 7\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 8\" #> [1] \"Generate regression 2 for continuous outcome and mediator 8\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 9\" #> [1] \"Generate regression 2 for continuous outcome and mediator 9\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 10\" #> [1] \"Generate regression 2 for continuous outcome and mediator 10\" #> [1] \"Computing ODE and OTE for continuous outcome.\""},{"path":"https://bcm-uga.github.io/hdmax2/articles/hdmax2_univariate.html","id":"plot","dir":"Articles","previous_headings":"First use case binary exposure and continuous outcome","what":"Plot","title":"hdmax2 application for univariate exposome","text":"propose set plots include: Forest plot mediators ACME Forest plot mediators PM Comparison ODE, OIE OTE Mediators effect size representation  obtained one set 4 plots: Estimates indirect effect (ACME) B proportions mediated effect (PM) top 10 mediators. effect estimate represented dot 95% CI bar. Symbols correspond significance cut 5% (square p-value \\(\\geq 0.05\\), circle p-value \\(< 0.05\\)). Colors correspond sign effect (green estimated effect \\(\\leq 0\\) , red estimated effect \\(> 0\\)). C Effect sizes Overall Direct Effect (ODE), Overall Indirect Effect (OIE) Overall Total Effect (OTE). Error bars correspond standard deviation (ODE OTE) confidence interval (OIE). D Indirect effect sizes selected mediators. Black corresponds ACME, violet effect exposure X mediator M model \\(X \\sim M\\), blue corresponds effect mediator M outcome Y model \\(Y \\sim M + X\\). ##TODO comments plots","code":"library(ggplot2) hdmax2::plot_hdmax2(hdmax2_step2) #> [1] \"hdmax2 plot for univariate exposome\" #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] sessionInfo() #> R version 4.3.3 (2024-02-29) #> Platform: x86_64-pc-linux-gnu (64-bit) #> Running under: Ubuntu 22.04.4 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] ggplot2_3.5.0 #>  #> loaded via a namespace (and not attached): #>  [1] gtable_0.3.4      xfun_0.42         bslib_0.6.1       htmlwidgets_1.6.4 #>  [5] lattice_0.22-5    vctrs_0.6.5       tools_4.3.3       generics_0.1.3    #>  [9] sandwich_3.1-0    tibble_3.2.1      fansi_1.0.6       highr_0.10        #> [13] cluster_2.1.6     pkgconfig_2.0.3   Matrix_1.6-5      data.table_1.15.2 #> [17] checkmate_2.3.1   desc_1.4.3        lifecycle_1.0.4   farver_2.1.1      #> [21] compiler_4.3.3    stringr_1.5.1     hdmax2_2.0.0.9000 textshaping_0.3.7 #> [25] prettydoc_0.4.1   munsell_0.5.0     mediation_4.5.0   htmltools_0.5.7   #> [29] sass_0.4.9        yaml_2.3.8        htmlTable_2.4.2   Formula_1.2-5     #> [33] pillar_1.9.0      pkgdown_2.0.7     nloptr_2.0.3      jquerylib_0.1.4   #> [37] MASS_7.3-60.0.1   cachem_1.0.8      Hmisc_5.1-2       rpart_4.1.23      #> [41] boot_1.3-29       nlme_3.1-164      tidyselect_1.2.1  digest_0.6.35     #> [45] mvtnorm_1.2-4     stringi_1.8.3     dplyr_1.1.4       purrr_1.0.2       #> [49] labeling_0.4.3    splines_4.3.3     fastmap_1.1.1     grid_4.3.3        #> [53] colorspace_2.1-0  cli_3.6.2         magrittr_2.0.3    base64enc_0.1-3   #> [57] utf8_1.2.4        withr_3.0.0       foreign_0.8-86    scales_1.3.0      #> [61] backports_1.4.1   rmarkdown_2.26    nnet_7.3-19       lme4_1.1-35.1     #> [65] gridExtra_2.3     zoo_1.8-12        ragg_1.3.0        memoise_2.0.1     #> [69] evaluate_0.23     lpSolve_5.6.20    knitr_1.45        rlang_1.1.3       #> [73] Rcpp_1.0.12       glue_1.7.0        rstudioapi_0.15.0 minqa_1.2.6       #> [77] jsonlite_1.8.8    R6_2.5.1          systemfonts_1.0.6 fs_1.6.3"},{"path":"https://bcm-uga.github.io/hdmax2/articles/helper_functions.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"hdmax2 helper functions","text":"{} package designed accept exposure \\(X\\) consisting univariate data, can continuous, binary, categorical, well multivariate exposomes. Binary variables converted 0s 1s treated univariate variables. vignette, provide series helper function process data. install latest version hdmax2, use github repository","code":"#devtools::install_github(\"bcm-uga/hdmax2\")"},{"path":"https://bcm-uga.github.io/hdmax2/articles/helper_functions.html","id":"how-to-analyse-agregated-methylated-regions","dir":"Articles","previous_headings":"","what":"How to analyse agregated methylated regions ?","title":"hdmax2 helper functions","text":"simulated 500 samples 1000 potential DNA methylation mediators, various binary exposure (smoking status mothers) continuous outcomes (birth weight).","code":""},{"path":"https://bcm-uga.github.io/hdmax2/articles/helper_functions.html","id":"identifying-aggregated-mediator-regions-amr","dir":"Articles","previous_headings":"How to analyse agregated methylated regions ?","what":"Identifying aggregated mediator regions (AMR)","title":"hdmax2 helper functions","text":"Identify Aggregated Methylated regions (AMR) AMR_search function uses P-values function max2 using adapted comb-p method (comb-p tool manipulates BED files possibly irregularly spaced P-values calculates auto-correlation, combines adjacent P-values, performs false discovery adjustment, finds regions enrichment assigns significance regions).","code":"data = hdmax2::helper_ex  #Artificial reduction of dataset size to pass the github action check when building hdmax2 website data$methylation = data$methylation[ , 800:1000] data$annotation = data$annotation[800:1000, ]   pc <- prcomp(data$methylation) plot((pc$sdev^2/sum(pc$sdev))[1:15],      xlab = 'Principal Component',      ylab = \"Explained variance\",      col = c(rep(1, 3), 2, rep(1, 16))) # choosen number of dimension K=5  ## run hdmax2 step1 hdmax2_step1 = hdmax2::run_AS(X = data$exposure,                               Y = data$phenotype,                               M = data$methylation,                                K = K) #> [1] \"The exposure argument is a vector.\" #> [1] \"The outcome argument is a vector.\" #> [1] \"The outcome argument is numeric\" #> [1] \"Potential mediators matrix is actually a matrix\" #> [1] \"provided K = 5\" #> [1] \"K value has been transformed as integer\" #> [1] \"The input exposome is continuous or binary\" #> [1] \"The outcome vector is numeric and DON'T contains only 0s and 1s, it is assimilated as continous variable.\" #> [1] \"Running first regression with univariate explanatory variable.\" #> [1] \"Running second regression.\" #> [1] \"Running max-squared test.\" #> [1] \"Not generating max2 pvalues for each explanatory variable.\"  ##Detecting AMR chr = data$annotation$chr start = data$annotation$start end = data$annotation$end pval = hdmax2_step1$max2_pvalues cpg = data$annotation$cpg seed = 0.6 #Careful to change this parameter when working with real data res.amr_search = hdmax2::AMR_search(chr = data$annotation$chr,                                     start = data$annotation$start,                                     end = data$annotation$end,                                     pval = hdmax2_step1$max2_pvalues,                                     cpg = data$annotation$cpg,                                     seed = seed,                                      nCores = 2)  res.amr_search$res #>   chr   start     end           p        fdr #> 2   1 1326166 1326221 0.005626678 0.01688003 #> 1   1 1310734 1310988 0.019799860 0.02138751 #> 3   1 1406862 1407016 0.021387509 0.02138751  res.arm_build = hdmax2::AMR_build(res.amr_search,                                    methylation = data$methylation,                                    nb_cpg = 2)  #List of DMR selected head(res.arm_build$res) #>    DMR chr   start     end          p        fdr nb #> 1 DMR1   1 1310734 1310988 0.01979986 0.02138751  2 #> 2 DMR2   1 1406862 1407016 0.02138751 0.02138751  2  ##CpG in the DMR res.arm_build$CpG_for_each_AMR #> $DMR1 #> [1] \"cg11518257\" \"cg15617543\" #>  #> $DMR2 #> [1] \"cg10228629\" \"cg06377929\""},{"path":"https://bcm-uga.github.io/hdmax2/articles/helper_functions.html","id":"quantifying-indirect-effects","dir":"Articles","previous_headings":"How to analyse agregated methylated regions ?","what":"Quantifying indirect effects","title":"hdmax2 helper functions","text":"Like single mediators analysis esimate_effect function use estimate different effects AMR.","code":"## run hdmax2 step2  object = hdmax2_step1 mediators_top10 = data$methylation[,names(sort(hdmax2_step1$max2_pvalues)[1:10])] m = as.matrix(res.arm_build$AMR_mean) boots = 100 sims = 100 ## selected mediators effects estimation  hdmax2_step2 = hdmax2::estimate_effect(object = hdmax2_step1,                                        m = m,                                        boots = 100) #> [1] \"Estimating indirect effect for univariate exposome.\" #> [1] \"The input exposome is continuous or binary\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 1\" #> [1] \"Generate regression 2 for continuous outcome and mediator 1\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 2\" #> [1] \"Generate regression 2 for continuous outcome and mediator 2\" #> [1] \"Computing ODE and OTE for continuous outcome.\"   library(ggplot2) hdmax2::plot_hdmax2(hdmax2_step2) #> [1] \"hdmax2 plot for univariate exposome\" #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout]"},{"path":"https://bcm-uga.github.io/hdmax2/articles/helper_functions.html","id":"how-to-select-potential-mediators-using-qvalues-and-fdr-control","dir":"Articles","previous_headings":"","what":"How to select potential mediators using q=values and FDR control ?","title":"hdmax2 helper functions","text":"Several methods can use select potential mediators step1 results methods, main use case simply select top 10 mediators can use multiple test adapted threshold like FDR control (False Discovery Rate)","code":"data = hdmax2::simu_data ## run hdmax2 step1 hdmax2_step1 = hdmax2::run_AS(X = data$X_continuous,                  Y = data$Y_continuous,                  M = data$M,                   K = K) #> [1] \"The exposure argument is a vector.\" #> [1] \"The outcome argument is a vector.\" #> [1] \"The outcome argument is numeric\" #> [1] \"Potential mediators matrix is actually a matrix\" #> [1] \"provided K = 5\" #> [1] \"K value has been transformed as integer\" #> [1] \"The input exposome is continuous or binary\" #> [1] \"The outcome vector is numeric and DON'T contains only 0s and 1s, it is assimilated as continous variable.\" #> [1] \"Running first regression with univariate explanatory variable.\" #> [1] \"Running second regression.\" #> [1] \"Running max-squared test.\" #> [1] \"Not generating max2 pvalues for each explanatory variable.\"  ## Select candidate mediator   qval <- fdrtool::fdrtool(hdmax2_step1$max2_pvalues, statistic = \"pvalue\", plot = F, verbose = F)$qval candidate_mediator <- qval[qval<= 0.8] # In this example, we will consider FDR levels <80%. candidate_mediator #> cg00019196 cg00024247 cg00035636 cg00044871 cg00054572 cg00055462 cg00071026  #>  0.7637137  0.7637137  0.7974308  0.7637137  0.7637137  0.7772144  0.7637137  #> cg00071658 cg00094319 cg00098070 cg00108349 cg00133204 cg00165067 cg00181327  #>  0.7637137  0.7848042  0.7637137  0.7921075  0.7993508  0.7939973  0.7637137  #> cg00187692 cg00208734 cg00221494 cg00242786 cg00245856 cg00252121 cg00274440  #>  0.7637137  0.7637137  0.7637137  0.7637137  0.7984185  0.7637137  0.7637137  #> cg00278131 cg00348891 cg00390259 cg00448720 cg00458564 cg00476054 cg00557354  #>  0.7637137  0.7637137  0.7637137  0.7743671  0.7637137  0.7637137  0.7637137  #> cg00587941 cg00615217 cg00627998 cg00636982 cg00644416 cg00644922 cg00663972  #>  0.7637137  0.7637137  0.7637137  0.7637137  0.7637137  0.7637137  0.7950435  #> cg00674995 cg00682015 cg00697358 cg00717219 cg00722493 cg00732810 cg00781839  #>  0.7637137  0.7637137  0.7637137  0.7637137  0.7820714  0.7637137  0.7637137  #> cg00792968 cg00823993 cg00825130 cg00841725 cg00880018 cg00894344 cg00898013  #>  0.7637137  0.7637137  0.7637137  0.7942501  0.7637137  0.7637137  0.7637137  #> cg00944193 cg00968267 cg00986957 cg00994984 cg01010012  #>  0.7637137  0.7637137  0.7679389  0.7758579  0.7965575"},{"path":"https://bcm-uga.github.io/hdmax2/articles/helper_functions.html","id":"how-to-transform-a-categorial-variable-using-one-hot-encoding","dir":"Articles","previous_headings":"","what":"How to transform a categorial variable using one-hot encoding ?","title":"hdmax2 helper functions","text":"categorial variables used models, must go design matrices, , one-hot encoding function needed.","code":"simu_data = hdmax2::simu_data  X_matrix = simu_data$X_categorial X_matrix = as.factor(X_matrix) X_matrix = droplevels(X_matrix) X_matrix = mltools::one_hot(data.table::as.data.table(X_matrix)) X_matrix = as.matrix(X_matrix) sessionInfo() #> R version 4.3.3 (2024-02-29) #> Platform: x86_64-pc-linux-gnu (64-bit) #> Running under: Ubuntu 22.04.4 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] ggplot2_3.5.0 #>  #> loaded via a namespace (and not attached): #>  [1] tidyselect_1.2.1        dplyr_1.1.4             farver_2.1.1            #>  [4] Biostrings_2.70.3       fastmap_1.1.1           digest_0.6.35           #>  [7] rpart_4.1.23            lifecycle_1.0.4         cluster_2.1.6           #> [10] magrittr_2.0.3          compiler_4.3.3          rlang_1.1.3             #> [13] Hmisc_5.1-2             sass_0.4.9              tools_4.3.3             #> [16] utf8_1.2.4              yaml_2.3.8              data.table_1.15.2       #> [19] knitr_1.45              labeling_0.4.3          htmlwidgets_1.6.4       #> [22] mediation_4.5.0         mltools_0.3.5           foreign_0.8-86          #> [25] withr_3.0.0             purrr_1.0.2             BiocGenerics_0.48.1     #> [28] desc_1.4.3              nnet_7.3-19             grid_4.3.3              #> [31] stats4_4.3.3            fansi_1.0.6             colorspace_2.1-0        #> [34] scales_1.3.0            MASS_7.3-60.0.1         cli_3.6.2               #> [37] mvtnorm_1.2-4           rmarkdown_2.26          crayon_1.5.2            #> [40] ragg_1.3.0              generics_0.1.3          rstudioapi_0.15.0       #> [43] minqa_1.2.6             cachem_1.0.8            stringr_1.5.1           #> [46] zlibbioc_1.48.2         splines_4.3.3           parallel_4.3.3          #> [49] XVector_0.42.0          base64enc_0.1-3         vctrs_0.6.5             #> [52] boot_1.3-29             Matrix_1.6-5            sandwich_3.1-0          #> [55] jsonlite_1.8.8          IRanges_2.36.0          S4Vectors_0.40.2        #> [58] Formula_1.2-5           htmlTable_2.4.2         systemfonts_1.0.6       #> [61] jquerylib_0.1.4         glue_1.7.0              pkgdown_2.0.7           #> [64] nloptr_2.0.3            stringi_1.8.3           gtable_0.3.4            #> [67] GenomeInfoDb_1.38.7     hdmax2_2.0.0.9000       lme4_1.1-35.1           #> [70] munsell_0.5.0           tibble_3.2.1            pillar_1.9.0            #> [73] htmltools_0.5.7         GenomeInfoDbData_1.2.11 R6_2.5.1                #> [76] textshaping_0.3.7       evaluate_0.23           lpSolve_5.6.20          #> [79] lattice_0.22-5          highr_0.10              backports_1.4.1         #> [82] memoise_2.0.1           bslib_0.6.1             fdrtool_1.2.17          #> [85] Rcpp_1.0.12             gridExtra_2.3           nlme_3.1-164            #> [88] checkmate_2.3.1         xfun_0.42               fs_1.6.3                #> [91] zoo_1.8-12              prettydoc_0.4.1         pkgconfig_2.0.3"},{"path":"https://bcm-uga.github.io/hdmax2/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Florence Pittion. Author, maintainer. Magali Richard. Author, thesis advisor. Olivier Francois. Author, thesis advisor. Basile Jumentier. Author.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Pittion F, Richard M, Francois O, Jumentier B (2024). hdmax2: R package hdmax2 performs high dimension mediation analysis. R package version 2.0.0.9000, https://bcm-uga.github.io/hdmax2/.","code":"@Manual{,   title = {hdmax2: R package hdmax2 performs high dimension mediation analysis},   author = {Florence Pittion and Magali Richard and Olivier Francois and Basile Jumentier},   year = {2024},   note = {R package version 2.0.0.9000},   url = {https://bcm-uga.github.io/hdmax2/}, }"},{"path":"https://bcm-uga.github.io/hdmax2/index.html","id":"hdmax2","dir":"","previous_headings":"","what":"R package hdmax2 performs high dimension mediation analysis","title":"R package hdmax2 performs high dimension mediation analysis","text":"R package {hdmax2} performs high dimension mediation analysis. package allows users estimate indirect effects mediators, calculate overall indirect effect mediators, facilitates execution high-dimensional mediation analysis. HDMAX2 method includes unobserved confounding factors latent factor mixed model approach. supports use exposures various types consideration continuous binary outcomes.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"R package hdmax2 performs high dimension mediation analysis","text":"","code":"conda create --name hdmax2    conda activate hdmax2 conda install -c conda-forge r-base conda install conda-forge::r-devtools conda install conda-forge::r-rcppeigen conda install conda-forge::r-lme4  R > install.packages(\"ggplot2\") > install.packages(\"prettydoc\") > install.packages(\"fdrtool\") > install.packages(\"mediation\") > devtools::install_github(\"bcm-uga/LEA\")  > devtools::install_github(\"bcm-uga/hdmax2\")"},{"path":"https://bcm-uga.github.io/hdmax2/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"R package hdmax2 performs high dimension mediation analysis","text":"","code":"# load data simu_data = hdmax2::simu_data X_matrix = as.matrix(simu_data$X_continuous) Y_matrix = as.matrix(simu_data$Y_continuous) M_matrix = as.matrix(simu_data$M)  # Run step 1 hdmax2_step1 = hdmax2::run_AS(X_matrix = X_matrix ,                 Y_matrix = Y_matrix,                  M_matrix = M_matrix)  # Select mediators mediators_top10 = M_matrix[,names(sort(hdmax2_step1$max2_pvalues)[1:10])] head(mediators_top10)  # Run step 2 hdmax2_step2 = hdmax2::estimate_effect(object =hdmax2_step1,                                     m = mediators_top10)  # Plot results library(ggplot2) hdmax2::plot_hdmax2(hdmax2_step2, N_med = 10)"},{"path":"https://bcm-uga.github.io/hdmax2/index.html","id":"bug-report--help","dir":"","previous_headings":"","what":"Bug report / Help","title":"R package hdmax2 performs high dimension mediation analysis","text":"Please open issue find bug.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/index.html","id":"jumentier-et-al-2023-release-access","dir":"","previous_headings":"","what":"Jumentier et al. 2023 release access","title":"R package hdmax2 performs high dimension mediation analysis","text":"access code choose V1.0.0.0 tags tab. install version:","code":"devtools::install_github(\"bcm-uga/hdmax2\", ref=\"v1.0.0.0\")"},{"path":"https://bcm-uga.github.io/hdmax2/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"R package hdmax2 performs high dimension mediation analysis","text":"Jumentier B, CC Barrot, M Estavoyer, J Tost, B Heude, çO Fran, J Lepeule (2023). High-Dimensional Medi- 220 ation Analysis: New Method Applied Maternal Smoking, Placental DNA Methylation, Birth - 221 comes. Environmental Health Perspectives 131 (). Publisher: Environmental Health Perspectives, 047011. 222 https://doi.org/10.1289/EHP11559.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_build.html","id":null,"dir":"Reference","previous_headings":"","what":"Build AMR vector — AMR_build","title":"Build AMR vector — AMR_build","text":"Build AMR result function AMR_search","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_build.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build AMR vector — AMR_build","text":"","code":"AMR_build(res, methylation, nb_cpg = 2)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_build.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build AMR vector — AMR_build","text":"res result object function AMR_search methylation matrix methylation profile. nb_cpg threshold minimal number CpG AMR","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_build.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build AMR vector — AMR_build","text":"set build AMRs. res, selected AMR CpG_for_each_AMR, list markers present AMR. AMR_acp, first components PCA DMR AMR_mean, mean value CpG AMR","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_build.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Build AMR vector — AMR_build","text":"use series pValues (one pValue per CpGs) obtained mEWAS regression method combination pValue max2. determine potential AMRs used combp method present ENmix package (Xu et al. 2016). method uses Fisher method combine pValues also base pair distance (bP) CpGs (1000 bP maximum nb_cpg CpGs AMR). information AMR summarized mean (row) CpG.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_build.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Build AMR vector — AMR_build","text":"Basile Jumentier","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_build.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Build AMR vector — AMR_build","text":"","code":"data = hdmax2::helper_ex #Artificial reduction of dataset size to pass the github action check when building hdmax2 website data$methylation = data$methylation[ , 800:1000] data$annotation = data$annotation[800:1000, ] K=5 ## run hdmax2 step1 hdmax2_step1 = hdmax2::run_AS(X = data$exposure,                              Y = data$phenotype,                              M = data$methylation,                              K = K) #> [1] \"The exposure argument is a vector.\" #> [1] \"The outcome argument is a vector.\" #> [1] \"The outcome argument is numeric\" #> [1] \"Potential mediators matrix is actually a matrix\" #> [1] \"provided K = 5\" #> [1] \"K value has been transformed as integer\" #> [1] \"The input exposome is continuous or binary\" #> [1] \"The outcome vector is numeric and DON'T contains only 0s and 1s, it is assimilated as continous variable.\" #> [1] \"Running first regression with univariate explanatory variable.\" #> [1] \"Running second regression.\" #> [1] \"Running max-squared test.\" #> [1] \"Not generating max2 pvalues for each explanatory variable.\"  ##Detecting AMR chr = data$annotation$chr start = data$annotation$start end = data$annotation$end pval = hdmax2_step1$max2_pvalues cpg = data$annotation$cpg  res.amr_search = hdmax2::AMR_search( chr = data$annotation$chr, start = data$annotation$start, end = data$annotation$end, pval = hdmax2_step1$max2_pvalues, cpg = data$annotation$cpg, seed = 0.6, #Careful to change this parameter when working with real data nCores = 2)  res.amr_search$res #>   chr   start     end           p        fdr #> 2   1 1326166 1326221 0.005626678 0.01688003 #> 1   1 1310734 1310988 0.019799860 0.02138751 #> 3   1 1406862 1407016 0.021387509 0.02138751  res.arm_build = hdmax2::AMR_build(res.amr_search,  methylation = data$methylation, nb_cpg = 2) #List of DMR selected head(res.arm_build$res) #>    DMR chr   start     end          p        fdr nb #> 1 DMR1   1 1310734 1310988 0.01979986 0.02138751  2 #> 2 DMR2   1 1406862 1407016 0.02138751 0.02138751  2 ## CpG in the DMR res.arm_build$CpG_for_each_AMR #> $DMR1 #> [1] \"cg11518257\" \"cg15617543\" #>  #> $DMR2 #> [1] \"cg10228629\" \"cg06377929\" #>"},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_search.html","id":null,"dir":"Reference","previous_headings":"","what":"Identifying aggregated mediator regions (AMR) — AMR_search","title":"Identifying aggregated mediator regions (AMR) — AMR_search","text":"Identify aggregated methylated regions (AMR) P-values function max2 using modified comb-p method. Compute P-value FDR AMR detected.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_search.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identifying aggregated mediator regions (AMR) — AMR_search","text":"","code":"AMR_search(chr, start, end, pval, cpg, ...)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_search.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identifying aggregated mediator regions (AMR) — AMR_search","text":"chr chromosomes start chromosomal position markers (start) end chromosomal position markers (end) pval P-values markers, max2 function cpg name markers ... see help combp ENmix package","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_search.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identifying aggregated mediator regions (AMR) — AMR_search","text":"res, table selected AMRs. AMR include chromosomic position, P-value, FDR data, matrix cpg, annotation provided P-values","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_search.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Identifying aggregated mediator regions (AMR) — AMR_search","text":"function uses modified comb-p method identify aggregated methylated regions (AMRs).","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_search.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Identifying aggregated mediator regions (AMR) — AMR_search","text":"Basile Jumentier","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/AMR_search.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identifying aggregated mediator regions (AMR) — AMR_search","text":"","code":"data = hdmax2::helper_ex #Artificial reduction of dataset size to pass the github action check when building hdmax2 website data$methylation = data$methylation[ , 800:1000] data$annotation = data$annotation[800:1000, ] K=5 ## run hdmax2 step1 hdmax2_step1 = hdmax2::run_AS(X = data$exposure,                              Y = data$phenotype,                              M = data$methylation,                              K = K) #> [1] \"The exposure argument is a vector.\" #> [1] \"The outcome argument is a vector.\" #> [1] \"The outcome argument is numeric\" #> [1] \"Potential mediators matrix is actually a matrix\" #> [1] \"provided K = 5\" #> [1] \"K value has been transformed as integer\" #> [1] \"The input exposome is continuous or binary\" #> [1] \"The outcome vector is numeric and DON'T contains only 0s and 1s, it is assimilated as continous variable.\" #> [1] \"Running first regression with univariate explanatory variable.\" #> [1] \"Running second regression.\" #> [1] \"Running max-squared test.\" #> [1] \"Not generating max2 pvalues for each explanatory variable.\"  ##Detecting AMR chr = data$annotation$chr start = data$annotation$start end = data$annotation$end pval = hdmax2_step1$max2_pvalues cpg = data$annotation$cpg  res.amr_search = hdmax2::AMR_search( chr = data$annotation$chr, start = data$annotation$start, end = data$annotation$end, pval = hdmax2_step1$max2_pvalues, cpg = data$annotation$cpg, seed = 0.6, #Careful to change this parameter when working with real data nCores = 2) res.amr_search$res #>   chr   start     end           p        fdr #> 2   1 1326166 1326221 0.005626678 0.01688003 #> 1   1 1310734 1310988 0.019799860 0.02138751 #> 3   1 1406862 1407016 0.021387509 0.02138751 ##'"},{"path":"https://bcm-uga.github.io/hdmax2/reference/combp2.html","id":null,"dir":"Reference","previous_headings":"","what":"Run mediation analysis for a set of markers\nFunction adapt from the combp function() of the ENmix package — combp2","title":"Run mediation analysis for a set of markers\nFunction adapt from the combp function() of the ENmix package — combp2","text":"Run mediation analysis set markers Function adapt combp function() ENmix package","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/combp2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run mediation analysis for a set of markers\nFunction adapt from the combp function() of the ENmix package — combp2","text":"","code":"combp2(data, dist.cutoff = 1000, bin.size = 310, seed = 0.01, nCores = 10)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/combp2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run mediation analysis for a set of markers\nFunction adapt from the combp function() of the ENmix package — combp2","text":"data data frame bed format file colname name \"V1\",\"V2\", \"V3\",\"V4\",\"V5\",V1 indicate chromosome (1,2,3,...,X,Y), V2 chromosome position, V4 P value V5 name CpGs. dist.cutoff Maximum distance base pair combine adjacent DMRs. bin.size bin size autocorrelation calculation. seed FDR significance threshold initial selection DMR region. nCores Number computer cores used calculation","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/combp2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run mediation analysis for a set of markers\nFunction adapt from the combp function() of the ENmix package — combp2","text":"Results DMRs analysis. result.fdr, table selected AMRs. AMR include chromosomic position, P-value, FDR","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/combp2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run mediation analysis for a set of markers\nFunction adapt from the combp function() of the ENmix package — combp2","text":"input data frame column name V1-V5, indicating chromosome, start position,end position, pValues probe names. function use modified comb-p method identify differentially methylated regions.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/combp2.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Run mediation analysis for a set of markers\nFunction adapt from the combp function() of the ENmix package — combp2","text":"Basile Jumentier","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/estimate_effect.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate effects for a set of mediation markers\nV2 this version allow to integrate covariates in mediation function — estimate_effect","title":"Estimate effects for a set of mediation markers\nV2 this version allow to integrate covariates in mediation function — estimate_effect","text":"Estimate various quantities causal mediation analysis set markers, including average causal mediation effects (indirect effect), average direct effects, proportions mediated, total effect.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/estimate_effect.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate effects for a set of mediation markers\nV2 this version allow to integrate covariates in mediation function — estimate_effect","text":"","code":"estimate_effect(object, m, boots = 100)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/estimate_effect.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate effects for a set of mediation markers\nV2 this version allow to integrate covariates in mediation function — estimate_effect","text":"object results hdmax2 step 2 m response variable matrix n rows p columns corresponding mediators selected step1. Response variables must encoded numeric. NAs allowed. boots number bootstrap","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/estimate_effect.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate effects for a set of mediation markers\nV2 this version allow to integrate covariates in mediation function — estimate_effect","text":"hdmax2_step2 object ACME, estimation average causal mediation effect (indirect effect) ADE, estimation average direct effect PM, estimation proportion mediated TE, estimation total effect Regressions: xm, regression X M , regression M Y Overall effect oie, overall indirect effect oie_med , oie median oie_sd , oie standard deviation ote, overall total effect ode, overall direct effect","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/estimate_effect.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate effects for a set of mediation markers\nV2 this version allow to integrate covariates in mediation function — estimate_effect","text":"use mediate function mediation package set markers Q-value lower FDR threshold. estimates indirect effects tests significance.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/estimate_effect.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Estimate effects for a set of mediation markers\nV2 this version allow to integrate covariates in mediation function — estimate_effect","text":"Florence Pittion, Magali Richard, Olivier Francois, Basile Jumentier","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/estimate_effect.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate effects for a set of mediation markers\nV2 this version allow to integrate covariates in mediation function — estimate_effect","text":"","code":"# Load example dataset simu_data = hdmax2::simu_data K = 5 # Run {hdmax2} step 1 hdmax2_step1 = hdmax2::run_AS(   X = simu_data$X_continuous,   Y =  simu_data$Y_continuous,   M =  simu_data$M,   K = K ) #> [1] \"The exposure argument is a vector.\" #> [1] \"The outcome argument is a vector.\" #> [1] \"The outcome argument is numeric\" #> [1] \"Potential mediators matrix is actually a matrix\" #> [1] \"provided K = 5\" #> [1] \"K value has been transformed as integer\" #> [1] \"The input exposome is continuous or binary\" #> [1] \"The outcome vector is numeric and DON'T contains only 0s and 1s, it is assimilated as continous variable.\" #> [1] \"Running first regression with univariate explanatory variable.\" #> [1] \"Running second regression.\" #> [1] \"Running max-squared test.\" #> [1] \"Not generating max2 pvalues for each explanatory variable.\" # Select mediators mediators_subset = names(sort(hdmax2_step1$max2_pvalues)[1:10]) mediators_top10 = simu_data$M[, mediators_subset] # Run {hdmax2} step 2 hdmax2_step2 = hdmax2::estimate_effect(object = hdmax2_step1,                                         m = mediators_top10) #> [1] \"Estimating indirect effect for univariate exposome.\" #> [1] \"The input exposome is continuous or binary\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 1\" #> [1] \"Generate regression 2 for continuous outcome and mediator 1\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 2\" #> [1] \"Generate regression 2 for continuous outcome and mediator 2\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 3\" #> [1] \"Generate regression 2 for continuous outcome and mediator 3\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 4\" #> [1] \"Generate regression 2 for continuous outcome and mediator 4\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 5\" #> [1] \"Generate regression 2 for continuous outcome and mediator 5\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 6\" #> [1] \"Generate regression 2 for continuous outcome and mediator 6\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 7\" #> [1] \"Generate regression 2 for continuous outcome and mediator 7\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 8\" #> [1] \"Generate regression 2 for continuous outcome and mediator 8\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 9\" #> [1] \"Generate regression 2 for continuous outcome and mediator 9\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 10\" #> [1] \"Generate regression 2 for continuous outcome and mediator 10\" #> [1] \"Computing ODE and OTE for continuous outcome.\""},{"path":"https://bcm-uga.github.io/hdmax2/reference/helper_ex.html","id":null,"dir":"Reference","previous_headings":"","what":"Dataset for helper function example — helper_ex","title":"Dataset for helper function example — helper_ex","text":"Dataset helper function example","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/helper_ex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dataset for helper function example — helper_ex","text":"","code":"helper_ex"},{"path":"https://bcm-uga.github.io/hdmax2/reference/helper_ex.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Dataset for helper function example — helper_ex","text":"list 5 objects methylationmethylation matrix, 500 individuals 10000 probes exposureExposure 500 individuals phenotypeOuctome 500 individuals annotationAnnotation 1000 probes covariablesCovariables 500 individuals : sex, bmi, age, treatment","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med.html","id":null,"dir":"Reference","previous_headings":"","what":"lfmm2 adapted function for hdmax2 from LEA::lfmm2 — lfmm2_med","title":"lfmm2 adapted function for hdmax2 from LEA::lfmm2 — lfmm2_med","text":"lfmm2 adapted function hdmax2 LEA::lfmm2","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"lfmm2 adapted function for hdmax2 from LEA::lfmm2 — lfmm2_med","text":"","code":"lfmm2_med(input, env, K, lambda = 1e-05, effect.sizes = FALSE)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"lfmm2 adapted function for hdmax2 from LEA::lfmm2 — lfmm2_med","text":"input response variable matrix n rows p columns env explanatory variable matrix n rows d columns. K latent factor number lambda ridge penalization parameter effect.sizes true false obtain effect sizes","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"lfmm2 adapted function for hdmax2 from LEA::lfmm2 — lfmm2_med","text":"object following attributes","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"lfmm2 adapted function for hdmax2 from LEA::lfmm2 — lfmm2_med","text":"Florence Pittion, Magali Richard, Olivier Francois","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"lfmm2 adapted function for hdmax2 from LEA::lfmm2 — lfmm2_med","text":"","code":"data(simu_data) K = 5 mod.lfmm1 = lfmm2_med(input = simu_data$M,  env = simu_data$X_binary,  K = K, effect.sizes = FALSE)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med_test.html","id":null,"dir":"Reference","previous_headings":"","what":"lfmm2_test adapted function for hdmax2 from LEA::lfmm2.test — lfmm2_med_test","title":"lfmm2_test adapted function for hdmax2 from LEA::lfmm2.test — lfmm2_med_test","text":"lfmm2_test adapted function hdmax2 LEA::lfmm2.test","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"lfmm2_test adapted function for hdmax2 from LEA::lfmm2.test — lfmm2_med_test","text":"","code":"lfmm2_med_test(   object,   input,   env,   covar,   full = FALSE,   genomic.control = TRUE,   linear = TRUE,   family = binomial(link = \"logit\") )"},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"lfmm2_test adapted function for hdmax2 from LEA::lfmm2.test — lfmm2_med_test","text":"object lfmm2Class object input response variable matrix n rows p columns env explanatory variable matrix n rows d columns. covar covariables full compute partial regression FALSE/TRUE genomic.control correct pvalue genomic inflation factor linear true false (else logistic) family logistic reg","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"lfmm2_test adapted function for hdmax2 from LEA::lfmm2.test — lfmm2_med_test","text":"object following attributes","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med_test.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"lfmm2_test adapted function for hdmax2 from LEA::lfmm2.test — lfmm2_med_test","text":"Florence Pittion, Magali Richard, Olivier Francois","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/lfmm2_med_test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"lfmm2_test adapted function for hdmax2 from LEA::lfmm2.test — lfmm2_med_test","text":"","code":"data(simu_data) K = 5 mod.lfmm1 = lfmm2_med(input = simu_data$M,  env = simu_data$X_binary,  K = K, effect.sizes = FALSE)  res_reg1 = lfmm2_med_test(mod.lfmm1,  input = simu_data$M,  env = simu_data$X_binary, covar = cbind(simu_data$age, simu_data$gender), genomic.control = TRUE)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_hdmax2.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary plot for HDMAX2\nThis function draw a summary plot of hdmax2 — plot_hdmax2","title":"Summary plot for HDMAX2\nThis function draw a summary plot of hdmax2 — plot_hdmax2","text":"Summary plot HDMAX2 function draw summary plot hdmax2","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_hdmax2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary plot for HDMAX2\nThis function draw a summary plot of hdmax2 — plot_hdmax2","text":"","code":"plot_hdmax2(object)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_hdmax2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary plot for HDMAX2\nThis function draw a summary plot of hdmax2 — plot_hdmax2","text":"object results hdmax2 step 2","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_hdmax2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary plot for HDMAX2\nThis function draw a summary plot of hdmax2 — plot_hdmax2","text":"Summary plot ACME, PM, OIE, effects interpretation","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_hdmax2.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Summary plot for HDMAX2\nThis function draw a summary plot of hdmax2 — plot_hdmax2","text":"Florence Pittion, Magali Richard","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_hdmax2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary plot for HDMAX2\nThis function draw a summary plot of hdmax2 — plot_hdmax2","text":"","code":"# Load example dataset simu_data = hdmax2::simu_data K = 5 # Run {hdmax2} step 1 hdmax2_step1 = hdmax2::run_AS(   X = simu_data$X_continuous ,   Y =  simu_data$Y_continuous,   M =  simu_data$M,   K = K ) #> [1] \"The exposure argument is a vector.\" #> [1] \"The outcome argument is a vector.\" #> [1] \"The outcome argument is numeric\" #> [1] \"Potential mediators matrix is actually a matrix\" #> [1] \"provided K = 5\" #> [1] \"K value has been transformed as integer\" #> [1] \"The input exposome is continuous or binary\" #> [1] \"The outcome vector is numeric and DON'T contains only 0s and 1s, it is assimilated as continous variable.\" #> [1] \"Running first regression with univariate explanatory variable.\" #> [1] \"Running second regression.\" #> [1] \"Running max-squared test.\" #> [1] \"Not generating max2 pvalues for each explanatory variable.\" # Select mediators mediators_subset = names(sort(hdmax2_step1$max2_pvalues)[1:10]) mediators_top10 = simu_data$M[, mediators_subset] # Run {hdmax2} step 2 hdmax2_step2 = hdmax2::estimate_effect(object = hdmax2_step1,                                         m = mediators_top10) #> [1] \"Estimating indirect effect for univariate exposome.\" #> [1] \"The input exposome is continuous or binary\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 1\" #> [1] \"Generate regression 2 for continuous outcome and mediator 1\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 2\" #> [1] \"Generate regression 2 for continuous outcome and mediator 2\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 3\" #> [1] \"Generate regression 2 for continuous outcome and mediator 3\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 4\" #> [1] \"Generate regression 2 for continuous outcome and mediator 4\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 5\" #> [1] \"Generate regression 2 for continuous outcome and mediator 5\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 6\" #> [1] \"Generate regression 2 for continuous outcome and mediator 6\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 7\" #> [1] \"Generate regression 2 for continuous outcome and mediator 7\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 8\" #> [1] \"Generate regression 2 for continuous outcome and mediator 8\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 9\" #> [1] \"Generate regression 2 for continuous outcome and mediator 9\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 10\" #> [1] \"Generate regression 2 for continuous outcome and mediator 10\" #> [1] \"Computing ODE and OTE for continuous outcome.\" # Generate plot hdmax2::plot_hdmax2(hdmax2_step2) #> [1] \"hdmax2 plot for univariate exposome\"  #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout]"},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_multivariate.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary plot for multivariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_multivariate","title":"Summary plot for multivariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_multivariate","text":"Summary plot multivariate exposure variables function draw summary plot hdmax2","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_multivariate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary plot for multivariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_multivariate","text":"","code":"plot_multivariate(object)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_multivariate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary plot for multivariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_multivariate","text":"object results hdmax2 step 2","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_multivariate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary plot for multivariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_multivariate","text":"Summary plot ACME, PM, OIE, effects interpretation","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_multivariate.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Summary plot for multivariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_multivariate","text":"Florence Pittion, Magali Richard","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_multivariate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary plot for multivariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_multivariate","text":"","code":"# Load example dataset simu_data = hdmax2::simu_data X_matrix = data.frame(X1 = simu_data$X_continuous, X2 = simu_data$X_continuous_2) Y_matrix = simu_data$Y_continuous M_matrix = simu_data$M K = 5 # Run {hdmax2} step 1 hdmax2_step1 = hdmax2::run_AS(   X = X_matrix,   Y = Y_matrix,   M = M_matrix,   K = K ) #> [1] \"The exposure argument is a data frame\" #> [1] \"The exposure argument is a data frame with more than one column.\" #> [1] \"The outcome argument is a vector.\" #> [1] \"The outcome argument is numeric\" #> [1] \"Potential mediators matrix is actually a matrix\" #> [1] \"provided K = 5\" #> [1] \"K value has been transformed as integer\" #> [1] \"The input exposome no  1 is continuous or binary\" #> [1] \"The input exposome no  2 is continuous or binary\" #> [1] \"The outcome vector is numeric and DON'T contains only 0s and 1s, it is assimilated as continous variable.\" #> [1] \"Running first regression with multivariate explanatory variables.\" #> [1] \"Running second regression.\" #> [1] \"Running max-squared test.\" #> [1] \"Not generating max2 pvalues for each explanatory variable.\" # Select mediators mediators_subset = names(sort(hdmax2_step1$max2_pvalues)[1:10]) mediators_top10 = simu_data$M[, mediators_subset] # Run {hdmax2} step 2 hdmax2_step2 = hdmax2::estimate_effect(object = hdmax2_step1,                                         m = mediators_top10) #> [1] \"Estimating indirect effect for multivariate exposome.\" #> [1] \"Column  1  is Continuous or Binary in covariable data frame\" #> [1] \"The input exposome is continuous or binary\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 1\" #> [1] \"Generate regression 2 for continuous outcome and mediator 1\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 2\" #> [1] \"Generate regression 2 for continuous outcome and mediator 2\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 3\" #> [1] \"Generate regression 2 for continuous outcome and mediator 3\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 4\" #> [1] \"Generate regression 2 for continuous outcome and mediator 4\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 5\" #> [1] \"Generate regression 2 for continuous outcome and mediator 5\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 6\" #> [1] \"Generate regression 2 for continuous outcome and mediator 6\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 7\" #> [1] \"Generate regression 2 for continuous outcome and mediator 7\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 8\" #> [1] \"Generate regression 2 for continuous outcome and mediator 8\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 9\" #> [1] \"Generate regression 2 for continuous outcome and mediator 9\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 10\" #> [1] \"Generate regression 2 for continuous outcome and mediator 10\" #> [1] \"Computing ODE and OTE for continuous outcome.\" #> [1] \"Estimating indirect effect for multivariate exposome.\" #> [1] \"Column  1  is Continuous or Binary in covariable data frame\" #> [1] \"The input exposome is continuous or binary\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 1\" #> [1] \"Generate regression 2 for continuous outcome and mediator 1\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 2\" #> [1] \"Generate regression 2 for continuous outcome and mediator 2\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 3\" #> [1] \"Generate regression 2 for continuous outcome and mediator 3\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 4\" #> [1] \"Generate regression 2 for continuous outcome and mediator 4\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 5\" #> [1] \"Generate regression 2 for continuous outcome and mediator 5\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 6\" #> [1] \"Generate regression 2 for continuous outcome and mediator 6\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 7\" #> [1] \"Generate regression 2 for continuous outcome and mediator 7\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 8\" #> [1] \"Generate regression 2 for continuous outcome and mediator 8\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 9\" #> [1] \"Generate regression 2 for continuous outcome and mediator 9\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 10\" #> [1] \"Generate regression 2 for continuous outcome and mediator 10\" #> [1] \"Computing ODE and OTE for continuous outcome.\" # Generate plot hdmax2::plot_multivariate(hdmax2_step2)   #> $X1 #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] #>  #> $X2 #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] #>"},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary plot for univariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_univariate","title":"Summary plot for univariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_univariate","text":"Summary plot univariate exposure variables function draw summary plot hdmax2","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary plot for univariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_univariate","text":"","code":"plot_univariate(object)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary plot for univariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_univariate","text":"object results hdmax2 step 2","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary plot for univariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_univariate","text":"Summary plot ACME, PM, OIE, effects interpretation","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Summary plot for univariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_univariate","text":"Florence Pittion, Magali Richard","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary plot for univariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_univariate","text":"","code":"# Load example dataset simu_data = hdmax2::simu_data K = 5 # Run {hdmax2} step 1 hdmax2_step1 = hdmax2::run_AS(   X = simu_data$X_continuous,   Y = simu_data$Y_continuous,   M = simu_data$M,   K = K ) #> [1] \"The exposure argument is a vector.\" #> [1] \"The outcome argument is a vector.\" #> [1] \"The outcome argument is numeric\" #> [1] \"Potential mediators matrix is actually a matrix\" #> [1] \"provided K = 5\" #> [1] \"K value has been transformed as integer\" #> [1] \"The input exposome is continuous or binary\" #> [1] \"The outcome vector is numeric and DON'T contains only 0s and 1s, it is assimilated as continous variable.\" #> [1] \"Running first regression with univariate explanatory variable.\" #> [1] \"Running second regression.\" #> [1] \"Running max-squared test.\" #> [1] \"Not generating max2 pvalues for each explanatory variable.\" # Select mediators mediators_subset = names(sort(hdmax2_step1$max2_pvalues)[1:10]) mediators_top10 = simu_data$M[, mediators_subset] # Run {hdmax2} step 2 hdmax2_step2 = hdmax2::estimate_effect(object = hdmax2_step1,                                         m = mediators_top10) #> [1] \"Estimating indirect effect for univariate exposome.\" #> [1] \"The input exposome is continuous or binary\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 1\" #> [1] \"Generate regression 2 for continuous outcome and mediator 1\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 2\" #> [1] \"Generate regression 2 for continuous outcome and mediator 2\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 3\" #> [1] \"Generate regression 2 for continuous outcome and mediator 3\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 4\" #> [1] \"Generate regression 2 for continuous outcome and mediator 4\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 5\" #> [1] \"Generate regression 2 for continuous outcome and mediator 5\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 6\" #> [1] \"Generate regression 2 for continuous outcome and mediator 6\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 7\" #> [1] \"Generate regression 2 for continuous outcome and mediator 7\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 8\" #> [1] \"Generate regression 2 for continuous outcome and mediator 8\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 9\" #> [1] \"Generate regression 2 for continuous outcome and mediator 9\" #> [1] \"Generate regression 1 for continuous or binary exposure and mediator 10\" #> [1] \"Generate regression 2 for continuous outcome and mediator 10\" #> [1] \"Computing ODE and OTE for continuous outcome.\" # Generate plot hdmax2::plot_univariate(hdmax2_step2)  #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout]"},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate_cat.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary plot for univariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_univariate_cat","title":"Summary plot for univariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_univariate_cat","text":"Summary plot univariate exposure variables function draw summary plot hdmax2","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate_cat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary plot for univariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_univariate_cat","text":"","code":"plot_univariate_cat(object)"},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate_cat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary plot for univariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_univariate_cat","text":"object results hdmax2 step 2","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate_cat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary plot for univariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_univariate_cat","text":"Summary plot ACME, PM, OIE, effects interpretation","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate_cat.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Summary plot for univariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_univariate_cat","text":"Florence Pittion, Magali Richard","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/plot_univariate_cat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary plot for univariate exposure variables\nThis function draw a summary plot of hdmax2 — plot_univariate_cat","text":"","code":"# Load example dataset simu_data = hdmax2::simu_data K = 5 # Run {hdmax2} step 1 hdmax2_step1 = hdmax2::run_AS(   X = simu_data$X_categorial,   Y = simu_data$Y_continuous,   M = simu_data$M,   K = K ) #> [1] \"The exposure argument is a vector.\" #> [1] \"The outcome argument is a vector.\" #> [1] \"The outcome argument is numeric\" #> [1] \"Potential mediators matrix is actually a matrix\" #> [1] \"provided K = 5\" #> [1] \"K value has been transformed as integer\" #> [1] \"The input exposome is categorial\" #> [1] \"The outcome vector is numeric and DON'T contains only 0s and 1s, it is assimilated as continous variable.\" #> [1] \"Running first regression with univariate explanatory variable.\" #> [1] \"Running second regression.\" #> [1] \"Running max-squared test.\" #> [1] \"Not generating max2 pvalues for each explanatory variable.\" # Select mediators mediators_subset = names(sort(hdmax2_step1$max2_pvalues)[1:10]) mediators_top10 = simu_data$M[, mediators_subset] # Run {hdmax2} step 2 hdmax2_step2 = hdmax2::estimate_effect(object = hdmax2_step1,                                         m = mediators_top10) #> [1] \"Estimating indirect effect for univariate exposome.\" #> [1] \"The input exposome is categorial\" #> [1] \"categorial exposome design matrix transformation\" #> [1] \"Generate regression 1 for categorial exposure and mediator 1\" #> [1] \"Generate regression 2 for continuous outcome and mediator 1\" #> [1] \"Generate regression 1 for categorial exposure and mediator 2\" #> [1] \"Generate regression 2 for continuous outcome and mediator 2\" #> [1] \"Generate regression 1 for categorial exposure and mediator 3\" #> [1] \"Generate regression 2 for continuous outcome and mediator 3\" #> [1] \"Generate regression 1 for categorial exposure and mediator 4\" #> [1] \"Generate regression 2 for continuous outcome and mediator 4\" #> [1] \"Generate regression 1 for categorial exposure and mediator 5\" #> [1] \"Generate regression 2 for continuous outcome and mediator 5\" #> [1] \"Generate regression 1 for categorial exposure and mediator 6\" #> [1] \"Generate regression 2 for continuous outcome and mediator 6\" #> [1] \"Generate regression 1 for categorial exposure and mediator 7\" #> [1] \"Generate regression 2 for continuous outcome and mediator 7\" #> [1] \"Generate regression 1 for categorial exposure and mediator 8\" #> [1] \"Generate regression 2 for continuous outcome and mediator 8\" #> [1] \"Generate regression 1 for categorial exposure and mediator 9\" #> [1] \"Generate regression 2 for continuous outcome and mediator 9\" #> [1] \"Generate regression 1 for categorial exposure and mediator 10\" #> [1] \"Generate regression 2 for continuous outcome and mediator 10\" #> [1] \"Computing ODE and OTE for continuous outcome.\" #> [1] \"Generate regression 1 for categorial exposure and mediator 1\" #> [1] \"Generate regression 2 for continuous outcome and mediator 1\" #> [1] \"Generate regression 1 for categorial exposure and mediator 2\" #> [1] \"Generate regression 2 for continuous outcome and mediator 2\" #> [1] \"Generate regression 1 for categorial exposure and mediator 3\" #> [1] \"Generate regression 2 for continuous outcome and mediator 3\" #> [1] \"Generate regression 1 for categorial exposure and mediator 4\" #> [1] \"Generate regression 2 for continuous outcome and mediator 4\" #> [1] \"Generate regression 1 for categorial exposure and mediator 5\" #> [1] \"Generate regression 2 for continuous outcome and mediator 5\" #> [1] \"Generate regression 1 for categorial exposure and mediator 6\" #> [1] \"Generate regression 2 for continuous outcome and mediator 6\" #> [1] \"Generate regression 1 for categorial exposure and mediator 7\" #> [1] \"Generate regression 2 for continuous outcome and mediator 7\" #> [1] \"Generate regression 1 for categorial exposure and mediator 8\" #> [1] \"Generate regression 2 for continuous outcome and mediator 8\" #> [1] \"Generate regression 1 for categorial exposure and mediator 9\" #> [1] \"Generate regression 2 for continuous outcome and mediator 9\" #> [1] \"Generate regression 1 for categorial exposure and mediator 10\" #> [1] \"Generate regression 2 for continuous outcome and mediator 10\" #> [1] \"Computing ODE and OTE for continuous outcome.\" #> [1] \"Generate regression 1 for categorial exposure and mediator 1\" #> [1] \"Generate regression 2 for continuous outcome and mediator 1\" #> [1] \"Generate regression 1 for categorial exposure and mediator 2\" #> [1] \"Generate regression 2 for continuous outcome and mediator 2\" #> [1] \"Generate regression 1 for categorial exposure and mediator 3\" #> [1] \"Generate regression 2 for continuous outcome and mediator 3\" #> [1] \"Generate regression 1 for categorial exposure and mediator 4\" #> [1] \"Generate regression 2 for continuous outcome and mediator 4\" #> [1] \"Generate regression 1 for categorial exposure and mediator 5\" #> [1] \"Generate regression 2 for continuous outcome and mediator 5\" #> [1] \"Generate regression 1 for categorial exposure and mediator 6\" #> [1] \"Generate regression 2 for continuous outcome and mediator 6\" #> [1] \"Generate regression 1 for categorial exposure and mediator 7\" #> [1] \"Generate regression 2 for continuous outcome and mediator 7\" #> [1] \"Generate regression 1 for categorial exposure and mediator 8\" #> [1] \"Generate regression 2 for continuous outcome and mediator 8\" #> [1] \"Generate regression 1 for categorial exposure and mediator 9\" #> [1] \"Generate regression 2 for continuous outcome and mediator 9\" #> [1] \"Generate regression 1 for categorial exposure and mediator 10\" #> [1] \"Generate regression 2 for continuous outcome and mediator 10\" #> [1] \"Computing ODE and OTE for continuous outcome.\" # Generate plot hdmax2::plot_univariate_cat(hdmax2_step2)    #> [[1]] #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] #>  #> [[2]] #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] #>  #> [[3]] #> TableGrob (2 x 2) \"arrange\": 4 grobs #>   z     cells    name           grob #> 1 1 (1-1,1-1) arrange gtable[layout] #> 2 2 (1-1,2-2) arrange gtable[layout] #> 3 3 (2-2,1-1) arrange gtable[layout] #> 4 4 (2-2,2-2) arrange gtable[layout] #>"},{"path":"https://bcm-uga.github.io/hdmax2/reference/run_AS.html","id":null,"dir":"Reference","previous_headings":"","what":"Association Study with both exposure and outcome — run_AS","title":"Association Study with both exposure and outcome — run_AS","text":"function uses lfmm (latent factor mixed models) estimate effects exposures outcomes response matrix. applied estimate effects exposure $X$ matrix $M$ potential mediators, effect marker outcome $Y$. uses covariables matrix $conf$ $K$ latent factors. Test possible markers determine potential mediators exposure-outcome association. compute squared maximum two series P-values $max2$ test computes squared maximum two series P-values association studie. rejects null-hypothesis either effect X M, effect M Y null.","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/run_AS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Association Study with both exposure and outcome — run_AS","text":"","code":"run_AS(   X,   Y,   M,   K,   covar = NULL,   detailed = FALSE,   genomic.control = TRUE,   effect.sizes = FALSE )"},{"path":"https://bcm-uga.github.io/hdmax2/reference/run_AS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Association Study with both exposure and outcome — run_AS","text":"X Exposure. explanatory variable data frame n rows d columns. column corresponds distinct explanatory variable (Exposure). Continuous binary variables must encoded numeric format. categorical variables factor objects. user can use .factor function encode categorical variables,  levels() ordered() functions define modal order categorical variables. Y Outcome. explanatory variable matrix n rows 1 columns, corresponds vector, supports continuous binary formats. M response variable matrix n rows p columns. Response variables must encoded numeric. NAs allowed. K integer number latent factors regression model. covar set covariable, must numeric. NAs allowed detailed logical indicate p-values must estimated explanatory variables (detailed = TRUE) addition pvalue global model (detailed = FALSE, default) Useful visually check fit estimated proportion null p-values. genomic.control correct pvalue genomic inflation factor effect.sizes effect sizes lfmm needed","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/run_AS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Association Study with both exposure and outcome — run_AS","text":"object following attributes first association study (mod1): pValue, estimation effects X Y matrix M. U, scores matrix K latent factors computed first regression zscore, score matrix exposure X outcome Y. fscore, score matrix exposure X outcome Y. adj_rsquared gif, Genomic inflation factor X Y, expressing deviation distribution observed test statistic compared distribution expected test statistic second association study (mod2): pValue, zscore, fscore,  adj_rsquared, gif results max2 test: pval, results max2 test input element: exposition , outcome, matrix  (element type) covar","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/run_AS.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Association Study with both exposure and outcome — run_AS","text":"response variable matrix Y explanatory variable centered. argument, missing values must imputed: NA allowed. K (number latent factors) can estimated eigenvalues PCA. Possibility calibrating scores pValues GIF (Genomic Inflation Factor). See LEA package information. Max2 test P-value computed markers following formula $$pV = max(pVal1, pVal2)^2$$","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/run_AS.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Association Study with both exposure and outcome — run_AS","text":"Florence Pittion, Magali Richard, Olivier Francois, Basile Jumentier","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/run_AS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Association Study with both exposure and outcome — run_AS","text":"","code":"# Load example dataset simu_data = hdmax2::simu_data  K = 5 # Run {hdmax2} step 1 hdmax2_step1 = run_AS(X = simu_data$X_continuous ,                       Y = simu_data$Y_continuous,                       M = simu_data$M,                       K = K) #> [1] \"The exposure argument is a vector.\" #> [1] \"The outcome argument is a vector.\" #> [1] \"The outcome argument is numeric\" #> [1] \"Potential mediators matrix is actually a matrix\" #> [1] \"provided K = 5\" #> [1] \"K value has been transformed as integer\" #> [1] \"The input exposome is continuous or binary\" #> [1] \"The outcome vector is numeric and DON'T contains only 0s and 1s, it is assimilated as continous variable.\" #> [1] \"Running first regression with univariate explanatory variable.\" #> [1] \"Running second regression.\" #> [1] \"Running max-squared test.\" #> [1] \"Not generating max2 pvalues for each explanatory variable.\"  head(hdmax2_step1$max2_pvalues) #> cg00005740 cg00006787 cg00007032 cg00008612 cg00009871 cg00009922  #>  0.2614245  0.4061289  0.1119728  0.9231155  0.7612041  0.8804220"},{"path":"https://bcm-uga.github.io/hdmax2/reference/simu_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Dataset for example — simu_data","title":"Dataset for example — simu_data","text":"Dataset example","code":""},{"path":"https://bcm-uga.github.io/hdmax2/reference/simu_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dataset for example — simu_data","text":"","code":"simu_data"},{"path":"https://bcm-uga.github.io/hdmax2/reference/simu_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Dataset for example — simu_data","text":"list  objects M methylation matrix, 100 samples 500 potential mediators X_continuous Continuous Exposure 100 samples X_binary Binary Exposure 100 samples X_categorial Categorial Exposure 100 samples Y_continuous Continuous Outcome 100 samples Y_binary Binary Outcome 100 samples age age covariable gender gender covariable","code":""}]
