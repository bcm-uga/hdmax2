<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function uses lfmm (latent factor mixed models) to estimate
the effects of exposures and outcomes on a response matrix.
applied to estimate the effects of exposure $X$ on a matrix $M$
of potential mediators, and the effect of each marker on outcome $Y$.
It uses the covariables matrix $conf$ and $K$ latent factors.
Test all possible markers to determine potential mediators in the exposure-outcome association.
Then compute the squared maximum of two series of P-values with $max2$ test
It computes the squared maximum of two series of P-values from the association studie.
This rejects the null-hypothesis that either the effect of X on M, or the effect of M on Y is null."><title>Association Study with both exposure and outcome — run_AS • hdmax2</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Association Study with both exposure and outcome — run_AS"><meta property="og:description" content="This function uses lfmm (latent factor mixed models) to estimate
the effects of exposures and outcomes on a response matrix.
applied to estimate the effects of exposure $X$ on a matrix $M$
of potential mediators, and the effect of each marker on outcome $Y$.
It uses the covariables matrix $conf$ and $K$ latent factors.
Test all possible markers to determine potential mediators in the exposure-outcome association.
Then compute the squared maximum of two series of P-values with $max2$ test
It computes the squared maximum of two series of P-values from the association studie.
This rejects the null-hypothesis that either the effect of X on M, or the effect of M on Y is null."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">hdmax2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/hdmax2_multivariate.html">hdmax2 application for multivariate exposome</a>
    <a class="dropdown-item" href="../articles/hdmax2_univariate.html">hdmax2 application for univariate exposome</a>
    <a class="dropdown-item" href="../articles/helper_functions.html">hdmax2 helper functions</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Association Study with both exposure and outcome</h1>
      
      <div class="d-none name"><code>run_AS.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function uses lfmm (latent factor mixed models) to estimate
the effects of exposures and outcomes on a response matrix.
applied to estimate the effects of exposure $X$ on a matrix $M$
of potential mediators, and the effect of each marker on outcome $Y$.
It uses the covariables matrix $conf$ and $K$ latent factors.
Test all possible markers to determine potential mediators in the exposure-outcome association.
Then compute the squared maximum of two series of P-values with $max2$ test
It computes the squared maximum of two series of P-values from the association studie.
This rejects the null-hypothesis that either the effect of X on M, or the effect of M on Y is null.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_AS</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">Y</span>,</span>
<span>  <span class="va">M</span>,</span>
<span>  <span class="va">K</span>,</span>
<span>  covar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  detailed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  diagnostic.plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  genomic.control <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  effect.sizes <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>X</dt>
<dd><p>Exposure. An explanatory variable data frame with n rows and d columns.
Each column corresponds to a distinct explanatory variable (Exposure).
Continuous and binary variables must be encoded in numeric format. categorical variables are factor objects. The user can use the as.factor function to encode categorical variables, and  levels() and ordered() functions to define the modal order of categorical variables.</p></dd>


<dt>Y</dt>
<dd><p>Outcome. An explanatory variable matrix with n rows and 1 columns, corresponds to a vector, which supports both continuous and binary formats.</p></dd>


<dt>M</dt>
<dd><p>a response variable matrix with n rows and p columns.
Response variables must be encoded as numeric. No NAs allowed.</p></dd>


<dt>K</dt>
<dd><p>an integer for the number of latent factors in the regression model.</p></dd>


<dt>covar</dt>
<dd><p>set of covariable, must be numeric. No NAs allowed</p></dd>


<dt>detailed</dt>
<dd><p>A logical to indicate if p-values must be estimated for each explanatory variables (detailed = TRUE) in addition to the pvalue of the global model (detailed = FALSE, by default)</p></dd>


<dt>diagnostic.plot</dt>
<dd><p>if TRUE the histogram of the p-values together
with the estimate of eta0 null line is plotted.
Useful to visually check the fit of the estimated proportion of null p-values.</p></dd>


<dt>genomic.control</dt>
<dd><p>correct pvalue with genomic inflation factor</p></dd>


<dt>effect.sizes</dt>
<dd><p>if effect sizes from lfmm are needed</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>an object with the following attributes</p>


<p>for first association study (mod1):</p><ul><li><p>pValue, estimation of the effects of X and Y on the matrix M.</p></li>
<li><p>U, scores matrix for the K latent factors computed from the for first regression</p></li>
<li><p>zscore, a score matrix for the exposure X and the outcome Y.</p></li>
<li><p>fscore, a score matrix for the exposure X and the outcome Y.</p></li>
<li><p>adj_rsquared</p></li>
<li><p>gif, Genomic inflation factor for X and Y, expressing the deviation of the distribution of the observed test statistic compared to the distribution of the expected test statistic</p></li>
</ul><p>for second association study (mod2):</p><ul><li><p>pValue, zscore, fscore,  adj_rsquared, gif</p></li>
</ul><p>results of max2 test:</p><ul><li><p>pval, results of max2 test</p></li>
</ul><p>input element:
exposition , outcome, matrix  (element and type) and covar</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The response variable matrix Y and the explanatory variable are centered.
For each argument, missing values must be imputed: no NA allowed. K (number of latent factors) can be estimated
with the eigenvalues of a PCA.
Possibility of calibrating the scores and pValues by the GIF (Genomic Inflation Factor).
See LEA package for more information.
Max2 test The P-value is computed for each markers following this formula
$$pV = max(pVal1, pVal2)^2$$</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Florence Pittion, Magali Richard</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load example dataset</span></span></span>
<span class="r-in"><span><span class="va">simu_data</span> <span class="op">=</span> <span class="fu">hdmax2</span><span class="fu">::</span><span class="va"><a href="simu_data.html">simu_data</a></span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run {hdmax2} step 1</span></span></span>
<span class="r-in"><span><span class="va">hdmax2_step1</span> <span class="op">=</span> <span class="fu">run_AS</span><span class="op">(</span>X <span class="op">=</span> <span class="va">simu_data</span><span class="op">$</span><span class="va">X_continuous</span> ,</span></span>
<span class="r-in"><span>                      Y <span class="op">=</span>  <span class="va">simu_data</span><span class="op">$</span><span class="va">Y_continuous</span>,</span></span>
<span class="r-in"><span>                      M <span class="op">=</span>  <span class="va">simu_data</span><span class="op">$</span><span class="va">M</span>,</span></span>
<span class="r-in"><span>                      K<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "The exposure argument is a vector."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "The outcome argument is a vector."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "The outcome argument is numeric"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Potential mediators matrix is actually a matrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "provided K = 5"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "K value has been transformed as integer"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "The input exposome is continuous or binary"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "The outcome vector is numeric and DON'T contains only 0s and 1s, it is assimilated as continous variable."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Running first regression with univariate explanatory variable."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Running second regression."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Running max-squared test."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Not generating max2 pvalues for each explanatory variable."</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">hdmax2_step1</span><span class="op">$</span><span class="va">max2_pvalues</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cg00005740 cg00006787 cg00007032 cg00008612 cg00009871 cg00009922 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.2614245  0.4061289  0.1119728  0.9231155  0.7612041  0.8804220 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Florence Pittion, Magali Richard, Olivier Francois, Basile Jumentier.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

