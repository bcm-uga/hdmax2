<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Build AMR vector — AMR_build • hdmax2</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Build AMR vector — AMR_build"><meta name="description" content="Build AMR from the result of function AMR_search"><meta property="og:description" content="Build AMR from the result of function AMR_search"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hdmax2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/hdmax2.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Build AMR vector</h1>

      <div class="d-none name"><code>AMR_build.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Build AMR from the result of function AMR_search</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">AMR_build</span><span class="op">(</span><span class="va">res</span>, <span class="va">methylation</span>, nb_cpg <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-res">res<a class="anchor" aria-label="anchor" href="#arg-res"></a></dt>
<dd><p>result object of function AMR_search</p></dd>


<dt id="arg-methylation">methylation<a class="anchor" aria-label="anchor" href="#arg-methylation"></a></dt>
<dd><p>a matrix of methylation profile.</p></dd>


<dt id="arg-nb-cpg">nb_cpg<a class="anchor" aria-label="anchor" href="#arg-nb-cpg"></a></dt>
<dd><p>threshold of minimal number of CpG in the AMR</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A set of build AMRs.</p><ul><li><p>res, selected AMR</p></li>
<li><p>CpG_for_each_AMR, list of markers present on each AMR.</p></li>
<li><p>AMR_acp, first components of PCA for each DMR</p></li>
<li><p>AMR_mean, mean value of CpG on the AMR</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>We use the series of pValues (one pValue per CpGs) obtained with the mEWAS
regression method and the combination of pValue max2.
To determine the potential AMRs used the combp method present in the ENmix package (Xu et al. 2016).
This method uses the Fisher method to combine the pValues and also the base pair distance (bP)
between CpGs (1000 bP maximum between nb_cpg CpGs on the same AMR).
The information for each AMR is summarized by doing the mean (by row) of each CpG.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Basile Jumentier</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">data</span> <span class="op">=</span> <span class="fu">hdmax2</span><span class="fu">::</span><span class="va"><a href="helper_ex.html">helper_ex</a></span></span></span>
<span class="r-in"><span><span class="va">K</span><span class="op">=</span><span class="fl">5</span></span></span>
<span class="r-in"><span><span class="co">## run hdmax2 step1</span></span></span>
<span class="r-in"><span><span class="va">hdmax2_step1</span> <span class="op">=</span> <span class="fu">hdmax2</span><span class="fu">::</span><span class="fu"><a href="run_AS.html">run_AS</a></span><span class="op">(</span>exposure <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">exposure</span>,</span></span>
<span class="r-in"><span>                             outcome <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">phenotype</span>,</span></span>
<span class="r-in"><span>                             M <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">methylation</span>,</span></span>
<span class="r-in"><span>                             K <span class="op">=</span> <span class="va">K</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running first regression with univariate exposure variable.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running second regression.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running max-squared test.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##Detecting AMR</span></span></span>
<span class="r-in"><span><span class="va">chr</span> <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="va">chr</span></span></span>
<span class="r-in"><span><span class="va">start</span> <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="va">start</span></span></span>
<span class="r-in"><span><span class="va">end</span> <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="va">end</span></span></span>
<span class="r-in"><span><span class="va">pval</span> <span class="op">=</span> <span class="va">hdmax2_step1</span><span class="op">$</span><span class="va">max2_pvalues</span></span></span>
<span class="r-in"><span><span class="va">cpg</span> <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="va">cpg</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res.amr_search</span> <span class="op">=</span> <span class="fu">hdmax2</span><span class="fu">::</span><span class="fu"><a href="AMR_search.html">AMR_search</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>chr <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="va">chr</span>,</span></span>
<span class="r-in"><span>start <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="va">start</span>,</span></span>
<span class="r-in"><span>end <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="va">end</span>,</span></span>
<span class="r-in"><span>pval <span class="op">=</span> <span class="va">hdmax2_step1</span><span class="op">$</span><span class="va">max2_pvalues</span>,</span></span>
<span class="r-in"><span>cpg <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="va">cpg</span>,</span></span>
<span class="r-in"><span>seed <span class="op">=</span> <span class="fl">0.7</span>, <span class="co">#Careful to change this parameter when working with real data</span></span></span>
<span class="r-in"><span>nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res.amr_search</span><span class="op">$</span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   chr  start    end          p        fdr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   1 864893 865027 0.03604853 0.05184658</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   1 858380 858381 0.03901609 0.05184658</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   1 886431 886553 0.04077365 0.05184658</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   1 896773 896774 0.05000351 0.05184658</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   1 854778 855056 0.05184658 0.05184658</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res.arm_build</span> <span class="op">=</span> <span class="fu">hdmax2</span><span class="fu">::</span><span class="fu">AMR_build</span><span class="op">(</span><span class="va">res.amr_search</span>, </span></span>
<span class="r-in"><span>methylation <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">methylation</span>, nb_cpg <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#List of DMR selected</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res.arm_build</span><span class="op">$</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    DMR chr  start    end          p        fdr nb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 DMR1   1 886431 886553 0.04077365 0.05184658  3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 DMR2   1 854778 855056 0.05184658 0.05184658  6</span>
<span class="r-in"><span><span class="co">## CpG in the DMR</span></span></span>
<span class="r-in"><span><span class="va">res.arm_build</span><span class="op">$</span><span class="va">CpG_for_each_AMR</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $DMR1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "cg20322444" "cg07983659" "cg11733071"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $DMR2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "cg08029603" "cg16347928" "cg22699361" "cg03890988" "cg21786289"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] "cg13897241"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Florence Pittion, Magali Richard, Olivier Francois, Basile Jumentier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

