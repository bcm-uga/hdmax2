<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Build AMR from the result of function AMR_search"><title>Build AMR vector — AMR_build • hdmax2</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Build AMR vector — AMR_build"><meta property="og:description" content="Build AMR from the result of function AMR_search"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">hdmax2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/hdmax2_multivariate.html">hdmax2 application for multivariate exposome</a>
    <a class="dropdown-item" href="../articles/hdmax2_univariate.html">hdmax2 application for univariate exposome</a>
    <a class="dropdown-item" href="../articles/helper_functions.html">hdmax2 helper functions</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Build AMR vector</h1>
      
      <div class="d-none name"><code>AMR_build.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Build AMR from the result of function AMR_search</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">AMR_build</span><span class="op">(</span><span class="va">res</span>, <span class="va">methylation</span>, nb_cpg <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>res</dt>
<dd><p>result object of function AMR_search</p></dd>


<dt>methylation</dt>
<dd><p>a matrix of methylation profile.</p></dd>


<dt>nb_cpg</dt>
<dd><p>threshold of minimal number of CpG in the AMR</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A set of build AMRs.</p><ul><li><p>res, selected AMR</p></li>
<li><p>CpG_for_each_AMR, list of markers present on each AMR.</p></li>
<li><p>AMR_acp, first components of PCA for each DMR</p></li>
<li><p>AMR_mean, mean value of CpG on the AMR</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>We use the series of pValues (one pValue per CpGs) obtained with the mEWAS
regression method and the combination of pValue max2.
To determine the potential AMRs used the combp method present in the ENmix package (Xu et al. 2016).
This method uses the Fisher method to combine the pValues and also the base pair distance (bP)
between CpGs (1000 bP maximum between nb_cpg CpGs on the same AMR).
The information for each AMR is summarized by doing the mean (by row) of each CpG.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Basile Jumentier</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">data</span> <span class="op">=</span> <span class="fu">hdmax2</span><span class="fu">::</span><span class="va"><a href="helper_ex.html">helper_ex</a></span></span></span>
<span class="r-in"><span><span class="co">#Artificial reduction of dataset size to pass the github action check when building hdmax2 website</span></span></span>
<span class="r-in"><span><span class="va">data</span><span class="op">$</span><span class="va">methylation</span> <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">methylation</span><span class="op">[</span> , <span class="fl">800</span><span class="op">:</span><span class="fl">1000</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">data</span><span class="op">$</span><span class="va">annotation</span> <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">[</span><span class="fl">800</span><span class="op">:</span><span class="fl">1000</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">K</span><span class="op">=</span><span class="fl">5</span></span></span>
<span class="r-in"><span><span class="co">## run hdmax2 step1</span></span></span>
<span class="r-in"><span><span class="va">hdmax2_step1</span> <span class="op">=</span> <span class="fu">hdmax2</span><span class="fu">::</span><span class="fu"><a href="run_AS.html">run_AS</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">exposure</span>,</span></span>
<span class="r-in"><span>                             Y <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">phenotype</span>,</span></span>
<span class="r-in"><span>                             M <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">methylation</span>,</span></span>
<span class="r-in"><span>                             K <span class="op">=</span> <span class="va">K</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "The exposure argument is a vector."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "The outcome argument is a vector."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "The outcome argument is numeric"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Potential mediators matrix is actually a matrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "provided K = 5"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "K value has been transformed as integer"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "The input exposome is continuous or binary"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "The outcome vector is numeric and DON'T contains only 0s and 1s, it is assimilated as continous variable."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Running first regression with univariate explanatory variable."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Running second regression."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Running max-squared test."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Not generating max2 pvalues for each explanatory variable."</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##Detecting AMR</span></span></span>
<span class="r-in"><span><span class="va">chr</span> <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="va">chr</span></span></span>
<span class="r-in"><span><span class="va">start</span> <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="va">start</span></span></span>
<span class="r-in"><span><span class="va">end</span> <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="va">end</span></span></span>
<span class="r-in"><span><span class="va">pval</span> <span class="op">=</span> <span class="va">hdmax2_step1</span><span class="op">$</span><span class="va">max2_pvalues</span></span></span>
<span class="r-in"><span><span class="va">cpg</span> <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="va">cpg</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res.amr_search</span> <span class="op">=</span> <span class="fu">hdmax2</span><span class="fu">::</span><span class="fu"><a href="AMR_search.html">AMR_search</a></span><span class="op">(</span>chr <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="va">chr</span>,</span></span>
<span class="r-in"><span>                                   start <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="va">start</span>,</span></span>
<span class="r-in"><span>                                   end <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="va">end</span>,</span></span>
<span class="r-in"><span>                                   pval <span class="op">=</span> <span class="va">hdmax2_step1</span><span class="op">$</span><span class="va">max2_pvalues</span>,</span></span>
<span class="r-in"><span>                                   cpg <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="va">cpg</span>,</span></span>
<span class="r-in"><span>                                   seed <span class="op">=</span> <span class="fl">0.6</span>, <span class="co">#Careful to change this parameter when working with real data</span></span></span>
<span class="r-in"><span>                                   nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res.amr_search</span><span class="op">$</span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   chr   start     end           p        fdr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   1 1326166 1326221 0.005626678 0.01688003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   1 1310734 1310988 0.019799860 0.02138751</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   1 1406862 1407016 0.021387509 0.02138751</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res.arm_build</span> <span class="op">=</span> <span class="fu">hdmax2</span><span class="fu">::</span><span class="fu">AMR_build</span><span class="op">(</span><span class="va">res.amr_search</span>, </span></span>
<span class="r-in"><span>methylation <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">methylation</span>, nb_cpg <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#List of DMR selected</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res.arm_build</span><span class="op">$</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    DMR chr   start     end          p        fdr nb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 DMR1   1 1310734 1310988 0.01979986 0.02138751  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 DMR2   1 1406862 1407016 0.02138751 0.02138751  2</span>
<span class="r-in"><span><span class="co">## CpG in the DMR</span></span></span>
<span class="r-in"><span><span class="va">res.arm_build</span><span class="op">$</span><span class="va">CpG_for_each_AMR</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $DMR1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "cg11518257" "cg15617543"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $DMR2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "cg10228629" "cg06377929"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Florence Pittion, Magali Richard, Olivier Francois, Basile Jumentier.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

