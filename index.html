<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="This package allows users to estimate the indirect effects of mediators, calculate the overall indirect effect of mediators, and facilitates the execution of high-dimensional mediation analysis. The HDMAX2 method includes unobserved confounding factors through a latent factor mixed model approach. It supports the use of exposures of various types and the consideration of both continuous and binary outcomes.">
<title>R package hdmax2 performs high dimension mediation analysis • hdmax2</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="R package hdmax2 performs high dimension mediation analysis">
<meta property="og:description" content="This package allows users to estimate the indirect effects of mediators, calculate the overall indirect effect of mediators, and facilitates the execution of high-dimensional mediation analysis. The HDMAX2 method includes unobserved confounding factors through a latent factor mixed model approach. It supports the use of exposures of various types and the consideration of both continuous and binary outcomes.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">hdmax2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/hdmax2_multivariate.html">hdmax2 application for multivariate exposome</a>
    <a class="dropdown-item" href="articles/hdmax2_univariate.html">hdmax2 application for univariate exposome</a>
    <a class="dropdown-item" href="articles/helper_functions.html">hdmax2 helper functions</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="hdmax2">hdmax2<a class="anchor" aria-label="anchor" href="#hdmax2"></a>
</h1></div>
<p><img src="https://raw.githubusercontent.com/bcm-uga/hdmax2/package/hdmax2_hex.png" width="130" align="right"></p>
<p>The <code>R</code> package <code>hdmax2</code> offers powerful tools for conducting high-dimensional mediation analysis. This method investigates the causal pathways linking exposure variables to outcome variables through intermediary factors known as mediators. These mediators often stem from biological metrics like transcriptomes or methylomes, which present data in high dimensions.</p>
<p>The package is capable of detecting individual mediators, accurately estimating the indirect effects of exposure variables associated with each mediator, and determining an overall indirect effect encompassing all detected mediators. Utilizing a latent factor mixed model methodology, the method effectively mitigates unobserved confounding factors. It accommodates exposures of diverse types and allows for the analysis of both continuous and binary outcomes.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<pre><code>conda create --name hdmax2  

conda activate hdmax2
conda install -c conda-forge r-base
conda install conda-forge::r-devtools
conda install conda-forge::r-rcppeigen
conda install conda-forge::r-lme4

R
&gt; install.packages("ggplot2")
&gt; install.packages("prettydoc")
&gt; install.packages("fdrtool")
&gt; install.packages("mediation")

&gt; devtools::install_github("bcm-uga/hdmax2")

# Installing R packages from GitHub may require that users remove older versions and restart their R session
# The package might have been installed in your computer (even though it does not work). Remove it using remove.packages()
#  rs.restartR() if in RStudio</code></pre>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>```{r} library(hdmax2) library(ggplot2)</p>
</div>
</div>
<div class="section level1">
<h1 id="loading-some-simulated-data">Loading some simulated data<a class="anchor" aria-label="anchor" href="#loading-some-simulated-data"></a>
</h1>
<p>attach(simu_data)</p>
</div>
<div class="section level1">
<h1 id="exposure-variables">Exposure variables<a class="anchor" aria-label="anchor" href="#exposure-variables"></a>
</h1>
<p>X = X_continuous</p>
</div>
<div class="section level1">
<h1 id="outcome-variable">Outcome variable<a class="anchor" aria-label="anchor" href="#outcome-variable"></a>
</h1>
<p>Y = Y_continuous</p>
</div>
<div class="section level1">
<h1 id="intermediate-variables-including-mediators">Intermediate variables including mediators<a class="anchor" aria-label="anchor" href="#intermediate-variables-including-mediators"></a>
</h1>
<p>M = simu_data$M</p>
</div>
<div class="section level1">
<h1 id="choose-k-latent-factors-number-from-pca-analysis-for-example-on-potential-mediators">Choose K (latent factors number) from pca analysis (for example) on potential mediators<a class="anchor" aria-label="anchor" href="#choose-k-latent-factors-number-from-pca-analysis-for-example-on-potential-mediators"></a>
</h1>
<p>K = 5</p>
<p>detach(simu_data)</p>
</div>
<div class="section level1">
<h1 id="computing-significance-values-for-intermediate-variables">Computing significance values for intermediate variables<a class="anchor" aria-label="anchor" href="#computing-significance-values-for-intermediate-variables"></a>
</h1>
</div>
<div class="section level1">
<h1 id="this-step-uses-lfmms-and-max-squared-tests">This step uses LFMMs and max-squared tests<a class="anchor" aria-label="anchor" href="#this-step-uses-lfmms-and-max-squared-tests"></a>
</h1>
<p>hdmax2_step1 = run_AS(X = X, Y = Y, M = M, K = K)</p>
</div>
<div class="section level1">
<h1 id="selecting-mediators-ten-variables-having-the-lowest-p-values">Selecting mediators (ten variables having the lowest p-values)<a class="anchor" aria-label="anchor" href="#selecting-mediators-ten-variables-having-the-lowest-p-values"></a>
</h1>
<p>mediators_top10 = order(hdmax2_step1$max2_pvalues)[1:10] M_10 = M[,mediators_top10]</p>
</div>
<div class="section level1">
<h1 id="ids-of-selected-mediators">Ids of selected mediators<a class="anchor" aria-label="anchor" href="#ids-of-selected-mediators"></a>
</h1>
<p>colnames(M_10)</p>
</div>
<div class="section level1">
<h1 id="estimating-indirect-and-direct-effects-of-exposure-on-outcome">Estimating indirect and direct effects of exposure on outcome<a class="anchor" aria-label="anchor" href="#estimating-indirect-and-direct-effects-of-exposure-on-outcome"></a>
</h1>
<p>hdmax2_step2 = estimate_effect(object = hdmax2_step1, m = M_10)</p>
</div>
<div class="section level1">
<h1 id="showing-some-results">Showing some results<a class="anchor" aria-label="anchor" href="#showing-some-results"></a>
</h1>
<p>plot_hdmax2(hdmax2_step2, plot_type = “all_plot”) ```</p>
<div class="section level2">
<h2 id="bug-report--help">Bug report / Help<a class="anchor" aria-label="anchor" href="#bug-report--help"></a>
</h2>
<p>If you encounter a problem, please open a GitHub issue or contact the program developers.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Jumentier B, CC Barrot, M Estavoyer, J Tost, B Heude, O Francois, and J Lepeule (2023). High-Dimensional Mediation Analysis: A New Method Applied to Maternal Smoking, Placental DNA Methylation, and Birth Outcomes. Environmental Health Perspectives 131. Publisher: Environmental Health Perspectives, 047011. <a href="https://doi.org/10.1289/EHP11559" class="external-link uri">https://doi.org/10.1289/EHP11559</a>.</li>
</ul>
</div>
</div>

  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing hdmax2</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Florence Pittion <br><small class="roles"> Author, maintainer </small>  </li>
<li>Magali Richard <br><small class="roles"> Author, thesis advisor </small>  </li>
<li>Olivier Francois <br><small class="roles"> Author, thesis advisor </small>  </li>
<li>Basile Jumentier <br><small class="roles"> Author </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Florence Pittion, Magali Richard, Olivier Francois, Basile Jumentier.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
