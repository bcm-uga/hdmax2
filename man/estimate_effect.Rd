% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/estimate_effect.R
\name{estimate_effect}
\alias{estimate_effect}
\title{Estimate effects for a set of mediation markers}
\usage{
estimate_effect(
  X,
  Y,
  m,
  covar,
  U,
  boots = 100,
  sims = 3,
  mod2_type = "linear",
  ...
)
}
\arguments{
\item{X}{Exposure. An explanatory variable matrix with n rows and d columns.
Each column corresponds to a distinct explanatory variable (Exposure).
Explanatory variables must be encoded as numeric variables.}

\item{Y}{Outcome. An explanatory variable matrix with n rows and d columns.
Each column corresponds to a distinct explanatory variable (Outcome).
Explanatory variables must be encoded as numeric variables.}

\item{m}{a response variable matrix with n rows and p columns corresponding to mediators selected at step1.
Response variables must be encoded as numeric. No NAs allowed.}

\item{covar}{covariables}

\item{U}{set of latent factors from runAS function (need include covariable)}

\item{boots}{number of bootstrap}

\item{sims}{number of Monte Carlo draws for nonparametric bootstrap or quasi-Bayesian approximation.
10000 is recommended.}

\item{mod2_type}{second regression type "linear", "logistic", "surv_Cox"}

\item{...}{argument of the mediate function from the mediation package}
}
\value{
Tables of results of mediation analyzes for markers with a Q-value below the FDR threshold.
Composition of tables: estimated effect, confidence interval and mediation pValue.
\itemize{
\item ACME, estimation of the average causal mediation effect (the indirect effect)
\item ADE, estimation average direct effect
\item PM, estimation of the proportion mediated
\item TE, estimation of the total effect
}

Regressions:
\itemize{
\item xm, regression X on M
\item my, regression M on Y
}
}
\description{
Estimate various quantities for causal mediation analysis for a set of
markers, including average causal mediation effects
(indirect effect), average direct effects, proportions mediated,
and total effect.
}
\details{
We use the mediate function of the mediation package on the set of markers having Q-value lower
than the FDR threshold. It estimates their indirect effects and
tests their significance.
}
\examples{
data(simu_data)
res_step1 = run_AS(X_matrix = simu_data$X_binary ,
Y_matrix = simu_data$Y_continuous,
M_matrix = simu_data$M, 
K = 5,
X_type = "binary",
Y_type = "continuous",
M_type = "methylation",
multivariate = FALSE,
covar = cbind(simu_data$age, simu_data$gender),
diagnostic.plot = F)

mediators_top10 = simu_data$M[,names(sort(res_step1$max2)[1:10])]
res_step2 = estimate_effect(X = simu_data$X_binary,
Y = simu_data$Y_continuous,
m = mediators_top10,
covar = cbind(simu_data$age, simu_data$gender),
U = res_step1$mod1$U,
sims = 100, 
mod2_type = "linear")
}
\author{
Florence Pittion
}
